<HTML><HEAD><TITLE>Core Utility Help</TITLE></HEAD><BODY>

<H1><HREF NAME="top">Core Utility Help</A></H1>

<H2><A NAME="$anon_webviewer">$anon_webviewer</A></H2>

The WebGhost Viewer (Anonymous Webviewer, $non_webviewer)  allows
<BR>anonymous web transactions to be used to browse the MOO.  This web
<BR>viewer presents the MOO's rooms much like the $standard_webviewer,
<BR>but doesn't require the transactions be authenticated.  It does not
<BR>allow users to manipulate objects, but only to examine them in ways
<BR>that don't change any of their characteristics.

<P>The reason for this restriction is related to the source of the name
<BR>"WebGhost Viewer."  When objects in the MOO change in some way, MOO
<BR>users expect it's because someone in the MOO has changed them or
<BR>because the object is somehow "active."  If objects could be
<BR>manipulated by anonymous web transactions, it would appear as if the
<BR>object were being controlled by something outside the self-contained
<BR>reality that is the MOO.  This would damage the integrity of the VR
<BR>visualization.

<P>Instead, you can consider anonymous web transactions as being
<BR>initiated by "ghosts," who are able to see into and wander the MOO
<BR>but not manipulate anything inside.  They have no "body" to
<BR>manipulate with.  Note that there is a @web-option that allows MOO
<BR>users to detect when a web ghost visits the room, and it is possible
<BR>to implement some forms of "clairvoance" to allow people inside the
<BR>MOO to communicate to those outside in a near-real time manner.  This
<BR>may be added in future version of the Biogate system.

<P>The $anon_webviewer presents an HTML page similar in format to the
<BR>$standard_webviewer.  However, it carries several verbs that have the
<BR>same name found on other BioGate System objects used for
<BR>authenticated transactions.  Some, like the web_viewer_buttons verb
<BR>(corresponding to $player:web_viewer_buttons), are used to build up
<BR>the final web page.  Others perform the equivalent of commands, like
<BR>interpret_teleport (which performs functions equivalent to the
<BR>$teleporter system).


<P>There is a $anon_webviewer.ghost_home property that you can set to
<BR>the room (OBJ) that all web ghosts originate at when they enter the
<BR>MOO.  This is different from $teleporter.central_room and
<BR>$player_start to allow you to present specialized messages (in the
<BR>room's description text) for anonymous web visitors.

<P>The $anon_webviewer.max_lag value (NUM) is the maximum lag in
<BR>seconds, as compared to $lag_meter.samples[$], beyond which the
<BR>$anon_webviewer refuses to allow anonymous transactions.

<P>&nbsp;Note that the WebGhost Viewer is provided as a useful anonymous web
<BR>viewer but that wizards may make their own child of $webapp and set
<BR>the $anon_webviewer pointer to it.  This allows MOOs to have their
<BR>own custom anonymous webviewer, with whatever features they wish.

<H2><A NAME="$biglist">$biglist</A></H2>

Generic BigList Utilities
<BR>----------------------------
<BR>$biglist is a collection of routines for maintaining huge persistent (sorted) lists in a format that is less likely to spam the server (which runs into a certain amount of trouble dealing with long ordinary lists --- btw we use `biglist' to refer to the huge data structure we're about to describe and `list' to refer to ordinary MOO lists {...}).  The biglist in question lives on a particular object, to which we will refer in the discussion below as the `home' object, and its various elements appear as leaves of a tree whose nodes are kept in properties of the home object.  It should be noted that the home object does not need to be (and in fact should *not* be) a descendant of $biglist one; $biglist merely provides utilities for manipulating the properties on the home object that are used in a particular biglist manipulation.  

<P>All of the utilities below refer to `caller' to locate the home object.  Thus verbs to manipulate a given biglist must be located on or inherited by its home object itself.  The home object needs to define the following verbs

<P>&nbsp;&nbsp;:_make(@args)     =&gt; new property on home object with value args
<BR>&nbsp;&nbsp;:_kill(prop)      delete a given property that was created by :_make
<BR>&nbsp;&nbsp;:_get(prop)       =&gt; home.prop
<BR>&nbsp;&nbsp;:_put(prop,@args) set home.prop = args
<BR>&nbsp;&nbsp;:_ord(element)    given something that is of the form of a biglist element
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return the corresponding ordinal (for sorting purposes).
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If you never intend to use :find_ord, then this can be a 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routine that always returns 0 or some other random value.

<P>See $generic_biglist_home or $big_mail_recipient for examples.

<P>Those of the following routines that take a biglist argument are expecting
<BR>either {} (empty biglist) or some biglist returned by one of the other routines

<P>&nbsp;&nbsp;:length(biglist)          =&gt; length(biglist) (i.e., number of elements)
<BR>&nbsp;&nbsp;:find_nth(biglist,n)      =&gt; biglist[n]
<BR>&nbsp;&nbsp;:find_ord(biglist,k,comp) =&gt; n where n is
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the largest such that home:(comp)(k,home:_ord(biglist[n])) is false, or
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the smallest such that home:(comp)(k,home:_ord(biglist[n+1])) is true.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Always returns a value between 0 and length(biglist) inclusive.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This assumes biglist to be sorted in order of increasing :_ord values 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with respect to home:(comp)().
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Standard situation is :_ord returns a number and comp is a &lt; verb.

<P>&nbsp;&nbsp;:start(biglist,s,e)  =&gt; {biglist[s..?],@handle} or {}
<BR>&nbsp;&nbsp;:next(@handle)       =&gt; {biglist[?+1..??],@newhandle} or {}
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;These two are used for iterating over a range of elements of a biglist
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The canonical incantation for doing
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for elt in (biglist[first..last])
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endfor
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;handle = :start(biglist,first,last);
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(handle)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for elt in (handle[1])
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endfor
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;handle = :next(@listdelete(handle,1));
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endwhile

<P>The following all destructively modify their biglist argument(s) L (and M).

<P>&nbsp;&nbsp;:set_nth(L,n,value)  =&gt;  L[n] = value
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;replaces the indicated element

<P>&nbsp;&nbsp;:insert_before(L,M,n) =&gt; {@L[1..n-1],@M,@L[n..length(L)]}
<BR>&nbsp;&nbsp;:insert_after (L,M,n) =&gt; {@L[1..n],  @M,@L[n+1..length(L)]}
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;takes two distinct biglists, inserts one into the other at the given point
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns the resulting consolidated biglist

<P>&nbsp;&nbsp;:extract_range(L,m,n) =&gt; {{@L[1..m-1],@L[n+1..]}, L[m..n]} 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;breaks the given biglist into two distinct biglists.

<P>&nbsp;&nbsp;:delete_range(L,m,n[,leafkiller]) =&gt; {@L[1..m-1],@L[n+1..]}
<BR>&nbsp;&nbsp;:keep_range  (L,m,n[,leafkiller]) =&gt; L[m..n]
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;like extract_range only we destroy what we don't want.

<P>&nbsp;&nbsp;:insertlast(L,value)  =&gt; {@L,value}
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inserts a new element at the end of biglist.  
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If find_ord is to continue to work properly, it is assumed that the 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;home:_ord(elt) is greater (comp-wise) than all of the :_ord values
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of elements currently in the biglist.

<P>&nbsp;&nbsp;:kill(L[,leafkiller]) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destroys all nodes used by biglist.  
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calls home:leafkiller on each element.

<H2><A NAME="$byte_quota_utils">$byte_quota_utils</A></H2>

This is the Byte Quota Utilities utility package.  It carries a set
<BR>of verbs used by the @quota and other MOO systems if byte quota is
<BR>enabled or if its just being routinely measured.  Byte-quota is
<BR>measuring people's MOO use by the number of bytes their objects take
<BR>up in memory.  Object-quota is measuring people's MOO usage by the
<BR>number of objects they own, regardless of size.

<P>By default, the eduCore measures people's byte usage but controls
<BR>quota through object-quota mechanisms.  However, wizards can modify
<BR>this behavior so that byte-quota is used instead.

<P>By default, the eduCore comes set to use object-based quota.  Under
<BR>this scheme, builders are granted a certain number of objects they
<BR>can build, and those objects can have any amount of text or other
<BR>customization on them.  However, many MOOs will want to use
<BR>byte-based quota, where builders can make any number of objects, but
<BR>have a limit to the total amount of bytes those objects can take up
<BR>in memory.  To change the MOO to use byte-based quota, use the
<BR>following commands:
<BR>&nbsp;&nbsp;@set #0.quota_utils to $byte_quota_utils
<BR>&nbsp;&nbsp;@set $object_quota_utils.byte_based to 1
<BR>&nbsp;&nbsp;@set $byte_quota_utils.byte_based to 1
<BR>&nbsp;&nbsp;start $byte_quota_utils
<BR>If there is already a byte measurement task running, "start
<BR>$byte_quota_utils" will issue a warning, but you can ignore it.
<BR>NOTE: Changing over from object-based to byte-based quota after the
<BR>MOO has been running a while can be quota a hassle, since you'll have
<BR>to reissue everyone quota limits by hand.  You should make this
<BR>decision before you open your MOO.

<P>To set the amount of quota builders start with, use:
<BR>&nbsp;&nbsp;@set $byte_quota_utils.default_quota to {50000, 0, 0, 1}
<BR>where in that example, new builders have 50,000 bytes of quota to
<BR>start with.

<P>Available commands:

<P>start-measuring $byte_quota_utils
<BR>&nbsp;&nbsp;This starts the periodic measurement task if such a task isn't
<BR>already scheduled.  It can be used to set a time for the task to run
<BR>different from the default one, or to start the task anew if for some
<BR>reason the task was killed.

<P>do_summary &lt;object&gt; with $byte_quota_utils

<P><B>Related Topics:</B>
<BR><A HREF="wiz_help.html#@quota">@quota</A> -- the command used to find and set use @quota levels
<BR><A HREF="builder_help.html#@measure">@measure</A> -- measures byte usage of individual objects or all a person's owned objects

<H2><A NAME="$container">$container</A></H2>

The Generic Container (for programmers)

<P>In addition to the command verbs described under `help containers'
<BR>and the _msg properties described in `help container-messages',
<BR>the following verbs and properties are available for use within programs

<P>.opened == TRUE iff the container is open
<BR>.dark   == TRUE iff the contents of the container may be seen
<BR>.opaque - describes the correlation between .open and .dark
<BR>&nbsp;&nbsp;&nbsp;== 0  container is always !dark
<BR>&nbsp;&nbsp;&nbsp;== 1  container is dark iff it is closed
<BR>&nbsp;&nbsp;&nbsp;== 2  container is always dark              

<P>:set_opaque(newvalue)   
<BR>&nbsp;&nbsp;changes the .opaque value for the container
<BR>&nbsp;&nbsp;=&gt; newvalue or E_PERM or E_INVARG

<P>:set_opened(newvalue)   
<BR>&nbsp;&nbsp;opens/closes the container (updates .open and .dark) according to newvalue
<BR>&nbsp;&nbsp;=&gt; newvalue or E_PERM

<P>:is_openable_by(who)
<BR>&nbsp;what the :open command uses to test whether the person should be able to open
<BR>&nbsp;the container.  By default this refers to .open_key  (set by
<BR>&nbsp;@(un)lock_for_open), but the object owner is free to customize this.

<P>N.B.:  There is no way to directly set .dark; .dark can be changed only by 
<BR>changing one of .opaque or .opened.  Use :set_opaque(0) and :set_opaque(2)
<BR>to have .dark change independently of the value of .opened.

<H2><A NAME="$error">$error</A></H2>

$error
<BR>======

<P>NOTE: THIS OBJECT IS ESSENTIALLY OBSOLETED BY THE raise() BUILT-IN FUNCTION IN SERVER VERSION 1.8.0, BUT IS RETAINED FOR BACKWARD COMPATABILITY.

<P>The Error Generator, $error, may be used to automatically generate errors. This is particularly useful if you are working in a !d verb but have occasion to -want- to crash with traceback. To raise a specific error, use $error:raise(error type) - for example, $error:raise(E_PERM) will produce traceback resulting from a Permission Denied error.

<P>Random notes about $error:

<P>+ The complete list of errors is stored in $error.names.
<BR>+ The seemingly useless :accept() verb on $error is so that $error:E_RECMOVE and $error:E_NACC will be guaranteed success (success meaning, of course, a termination by traceback).
<BR>+ There is, unfortunately, no way to raise the error E_NONE.

<H2><A NAME="$exit">$exit</A></H2>

Exits
<BR>-----
<BR>An exit can be renamed by either the owner of the exit or the owner of its source.

<P>The standard verbs that are called in exit movement are:

<P>:move(object)  - moves the object via this exit
<BR>:invoke()      - equivalent to :move(player)

<P>When an exit is invoked on a particular object (via exit:move(object)), the following occurs.

<P>(1) The exit may be locked against the object, in which case we print the 
<BR>&nbsp;&nbsp;&nbsp;nogo messages and quit.

<P>(2) (room=exit.dest):bless_for_entry(object) is called.  Assuming that exit is recognized by room as being a legitimate entrance (i.e., is in room.entrances), this will enable room:accept(object) to return true.

<P>(3) object:moveto(room) is called and the various messages (see `help exit-messages') are :announced/:told.  Note that this, in accordance with the way the builtin move() (and hence the default :moveto()) works, we get a call to room:accept(object) which checks for the room itself being locked against the object, and otherwise returns true if the blessing in the previous step worked.  The move is performed, here:exitfunc(object) and room:enterfunc(object) are called.  In particular, room:enterfunc clears the blessing bestowed in (2) now that it is no longer needed.

<P>In general, the move may fail, in which case we :announce the (o)nogo_msgs.

<H2><A NAME="$feature">$feature</A></H2>

Feature objects are a mechanism for adding new commands to those a person has routine access, much as if the commands were on their character object.  The $feature object is available as a generic for programmers to use, although any object with a 
<BR>.feature_ok property set true or a :feature_ok verb that returns true can function as a feature object.

<P>In order to function as feature object commads, verbs on the feature must:
<BR>&nbsp;&nbsp;1. Be executable (+x).
<BR>&nbsp;&nbsp;2. Have a argument set for which a valid command is possible (i.e. not `this none this').
<BR>&nbsp;&nbsp;3. Have a verb name that is not already used by a verb that the standard MOO server matching will find, or on any object ahead of the feature in the user's .features property (a list of features they've added).

<P>Features have an unusual `help' system, such that the help text
<BR>displayed is the contents of &lt;feature&gt;.help_msg, followed by the
<BR>header comments from each verb that has been flagged using the
<BR>$feature:@add_feature_verb command.  Feature creators do not have to
<BR>use @afv to make the commands usable as a feature, but only to flag
<BR>them for the help system.

<P>Note that verbs on $feature should not use `player' or `caller' for
<BR>security, but should use caller_perms() instead (as with all +x verbs
<BR>where the caller is not predictable).

<P>Some properties:

<P>.feature_ok
<BR>&nbsp;&nbsp;The value returned by &lt;feature&gt;:feature_ok by default.

<P>.guest_feature_ok
<BR>&nbsp;&nbsp;This feature object may be used by guests.

<P>.feature_info_byte_limit
<BR>&nbsp;&nbsp;The maximum number of bytes a feature can store on a person's
<BR>character object through the &lt;player&gt;:set_feature_info command, if
<BR>that person has added the feature object to their list of features.
<BR>Note that this restriction is only in effect if byte-based quota is
<BR>enabled for the MOO.

<P>Some verbs:
<BR>feature_ok
<BR>&nbsp;&nbsp;Called when someone tries to add a feature object, and must return true if they are to be allowed.  Returns the value of &lt;feature&gt;.feature_ok by default.

<P>:feature_add
<BR>&nbsp;&nbsp;Called after a feature has been added to someone's list of features.

<P>:feature_remove
<BR>&nbsp;&nbsp;Called when someone removes a feature object from their list.

<P>:player_connected
<BR>:player_disconnected
<BR>&nbsp;&nbsp;Called when a person connects to or disconnects from their character.

<P><B>Related Topics:</B>
<BR><A HREF="prog_help.html#features">features</A> -- help for users and some notes for programmers

<H2><A NAME="$frame_manager">$frame_manager</A></H2>

The $frame_manager is a web application ($webapp) that performs
<BR>various functions related to building frames on the user's web page
<BR>and directing the proper information to each.
<BR>It ignores the WHAT portion of the information sent by the $http_handler, but uses the REST portion to determine what action to perform.  The following are recognized:

<P>frameset

<P>This is an instruction to create a &lt;FRAMESET&gt; HTML document, defining
<BR>the frames and the URLs of the pages to be loaded into each.  For
<BR>instance, a two frame page with a web document display above and a
<BR>java telnet client below might be specified. The
<BR>$frame_manager:make_frameset verb does the actual work.

<P>javaclient

<P>This command returns the HTML document containing appropriate &lt;EMBED&gt;
<BR>tags for placing a Java telnet client in the specified frame.  The
<BR>$frame_manager determines which $jclient_handler to use with the
<BR>$frame_manager:get_jclient_html verb.

<P>preload

<P>This command retrieves the "preload" page to be displayed in the web
<BR>document frame until the full layout is complete.  Completion is
<BR>generally marked by a call from the Java telnet client to display a
<BR>new page in the "html_frame" of the display. The preload page is
<BR>defined by the particular $jclient_handler that is being included on
<BR>the page in the "interaction_frame" frame.  The
<BR>$frame_manager:preload_page verb creates the text.

<H2><A NAME="$generic_db">$generic_db</A></H2>

Generic Database
<BR>----------------
<BR>This holds a collection of {string key, datum} pairs, where datum can be anything.  At most one datum may be associated with any given string.  Data may be anything (lists, strings, numbers, objectids).  If you like, you can think of this as an array indexed by strings.
<BR>Verbs supplied include

<P>&nbsp;&nbsp;:find(string)          =&gt; datum, $ambiguous_match or $failed_match
<BR>&nbsp;&nbsp;:find_key(string)      =&gt; full string key,  $ambiguous_match or $failed_match
<BR>&nbsp;&nbsp;:find_exact(string)    =&gt; datum or $failed_match (no partial matches)
<BR>&nbsp;&nbsp;:find_all(string)      =&gt; list of all data corresponding to matching strings
<BR>&nbsp;&nbsp;:find_all_keys(string) =&gt; list of all matching strings

<P>&nbsp;&nbsp;:insert(string,datum)  
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if the string is already present in the db, 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;changes the associated datum and returns {old_datum};
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherwise enters a new {string,datum} pair and return 0.
<BR>&nbsp;&nbsp;:delete(string)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if there is a datum associated with string, 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove this association and return {datum}; otherwise return 0.
<BR>&nbsp;&nbsp;:delete2(string,datum)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if the given datum is associated with string, 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;removes that association and return {datum}, 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if some other datum is associated with string, just return {other datum}
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherwise return 0.
<BR>&nbsp;&nbsp;:clearall([4|3])
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;removes all associations from the database.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;optional argument changes the type of the database 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(4 is normal, 3 is a kludge for when the data are simply boolean flags
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.e., this is a set of strings rather than a string-indexed array;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;more on this below)

<P>&nbsp;&nbsp;count [entries|chars] in this
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;provide some vague statistics about how big this thing is.

<P>N.B.  As entries get made, properties belonging to $generic_db.owner will be created on the db object itself.  These properties will be created having flags as specified by .node_perms, which by default is "r", but can be changed to "" should you want to ensure that randoms don't have access to the raw information.

<P>Implementation notes
<BR>&nbsp;- - - - - - - - - -
<BR>The representation is as a `trie', a tree in which each internal node corresponds to a prefix shared by two or more strings in the db.
<BR>Each internal node is kept in a property named " "+&lt;prefix&gt;, where &lt;prefix&gt; is a prefix shared by all strings in the subtree under this node.
<BR>The property value is a 4 element list

<P>this.(" "+&lt;prefix&gt;)[1] = &lt;common&gt;
<BR>&nbsp;&nbsp;&nbsp;maximal continuation shared by all strings beginning with prefix
<BR>&nbsp;&nbsp;&nbsp;i.e., all these names actually begin with &lt;prefix&gt;+&lt;common&gt;

<P>this.(" "+&lt;prefix&gt;)[2] = &lt;continuations&gt;
<BR>&nbsp;&nbsp;&nbsp;string of all characters &lt;c&gt; that can follow &lt;prefix&gt;+&lt;common&gt; for which
<BR>&nbsp;&nbsp;&nbsp;there is more than one string in the db beginning with &lt;prefix&gt;+&lt;common&gt;+&lt;c&gt;

<P>this.(" "+&lt;prefix&gt;)[3] = &lt;exact_matches&gt;
<BR>&nbsp;&nbsp;&nbsp;list of all strings in this subtree for which 
<BR>&nbsp;&nbsp;&nbsp;the character (or lack thereof) following the &lt;prefix&gt;+&lt;common&gt; substring 
<BR>&nbsp;&nbsp;&nbsp;suffices to determine the string.

<P>this.(" "+&lt;prefix&gt;)[4] = &lt;data&gt;
<BR>&nbsp;&nbsp;&nbsp;list of data corresponding to the strings in [3].

<P>Child nodes are       this.(" "+&lt;prefix&gt;+&lt;common&gt;+&lt;c&gt;) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for all &lt;c&gt; in this.(" "+&lt;prefix&gt;)[2].
<BR>The root node is this.(" ").
<BR>If, e.g., there are 2 or more strings in the db beginning with a, 
<BR>there will be a node this.(" a").  
<BR>If all of these strings actually begin with "ani", then this.(" a")[1]=="ni".
<BR>The db consisting of the 5 correspondences

<P>&nbsp;&nbsp;{"animal", #1}
<BR>&nbsp;&nbsp;{"anime",  #2}
<BR>&nbsp;&nbsp;{"anil",   #3}
<BR>&nbsp;&nbsp;{"anile",  #4}
<BR>&nbsp;&nbsp;{"banal",  #5}

<P>would be represented

<P>this.(" ")    =={"",  "a",  {"banal"},         {#5}}
<BR>this.(" a")   =={"ni","lm", {},                {}}
<BR>this.(" anim")=={"",  "",   {"animal","anime"},{#1,#2}}
<BR>this.(" anil")=={"",  "",   {"anil","anile"},  {#3,#4}}

<P>In some cases one may merely wish to hold a collection of strings without trying to associate a particular datum with each string.  One may then instead set up a db without the fourth field on each of the properties.  In this case the datum is taken to be the found string itself and that is what gets returned by :find*() in the event of a successful search.   :find and :find_key are then equivalent as are :find_all and :find_all_keys.  To setup the db this way, do a :clearall(3).  :clearall(4) reverts to the above described type of db with a separately kept datum.  Note that you can't change the type without emptying the db.  3 and 4 are currently the only db types allowed.

<H2><A NAME="$generic_editor">$generic_editor</A></H2>

The Generic Editor enables a person to edit a list of strings.  While one might contrive to use it directly, it is rather intended as a parent for some actual editor.  It supplies the following commands:

<P>say         &lt;text&gt;                      w*hat       
<BR>emote       &lt;text&gt;                      abort       
<BR>lis*t       [&lt;range&gt;] [nonum]           q*uit,done,pause 
<BR>ins*ert     [&lt;ins&gt;] ["&lt;text&gt;]           
<BR>n*ext,p*rev [n] ["&lt;text&gt;]               
<BR>del*ete     [&lt;range&gt;]                   
<BR>f*ind       /&lt;str&gt;[/[c][&lt;range&gt;]]       
<BR>s*ubst      /&lt;str1&gt;/&lt;str2&gt;[/[g][c][&lt;range&gt;]]
<BR>m*ove,c*opy [&lt;range&gt;] to &lt;ins&gt;          
<BR>join*l      [&lt;range&gt;]                   
<BR>fill        [&lt;range&gt;] [@&lt;col&gt;]          
<BR>ind*ent     [&lt;range&gt;] @&lt;col&gt; [&lt;filler&gt;]

<P>$editor_help.(cmdname) descrbes cmdname
<BR>$editor_help.insert    descrbes insertion points (&lt;ins&gt;)
<BR>$editor_help.ranges    descrbes range specifications (&lt;range&gt;)

<P>You'll notice that nowhere does it say how to load in a given list of strings or how and where one may save said list away when one is done editing.  These commands are supplied by the child editor object.  The generic editor contains only the code for editing lines, though it defines additional functions for use by the children:

<P>&nbsp;&nbsp;:loaded(player)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns the index (player in this.active) if text has been loaded
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from somewhere, otherwise returns 0.

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note that, by default, there is a difference between 

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;having nothing loaded                (:text(who)==0) and 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;having loaded something with no text (:text(who)=={}).

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If you don't care about this distinction in a particular case,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just do (player in this.active) instead of this:loaded(player).  
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If you don't want your editor to make this distinction at all, do

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@stateprop texts={} for &lt;youreditor&gt;

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which changes the initial value of :text() to {} 

<P>In all functions below, 'who' is the index returned by :loaded(player) 

<P>BTW, be careful about using `player' in non-user (i.e., +x this-none-this) verbs - much better to have the user verb get the index with :loaded() and then pass that around.  

<P>Also be careful about suspend() and verbs that call suspend().  In particular, the character's index in the .active list can change during the suspend interval, so you must be sure to obtain the index (e.g., using :loaded()) again after the suspend() returns.

<P>For your non-user verbs, we have

<P>&nbsp;&nbsp;:ok(who)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns E_PERM if the caller is not an editor verb and E_RANGE
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if 'who' does not point to a valid session.

<P>which should take care of the more egregious security holes (but maybe not the less egregious ones).  For getting and loading text, we have

<P>&nbsp;&nbsp;:text(who)    
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the current text string list or 0 if nothing loaded yet.
<BR>&nbsp;&nbsp;:load(who,text)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loads the given list of strings as the text to be edited.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this also resets the 'changed' flag and pushes the insertion 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;point to the end.

<P>and various flags and properties (all of the set_* routines return E_PERM when not called from an editor verb, E_RANGE if who is out of bounds, E_INVARG if something is wrong with the 2nd arg, or the new value, which may not necessarily be the same as the 2nd arg (e.g., set_insertion(..,37) on a 5 line text buffer returns 6).

<P>&nbsp;&nbsp;:changed(who)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;has the text been altered since the last save/load?
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(the child editor gets to define what "save" means).
<BR>&nbsp;&nbsp;:set_changed(who,value)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Any child editor command that is considered to save the text should do a 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:set_changed(who,0).  
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note that if the changed flag is 0, the session will be flushed when 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the character leaves the editor, so you may also want certain commands to
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do set_changed(who,1)...

<P>&nbsp;&nbsp;:origin(who)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;room where the person came from.  
<BR>&nbsp;&nbsp;:set_origin(who,room)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can be used to change the room the person will return to when finished
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;editing.  Since origin gets set even in cases where the person teleports
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;into the editor you probably won't usually need to do this.

<P>&nbsp;&nbsp;:insertion(who)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current insertion point.
<BR>&nbsp;&nbsp;:set_insertion(who,linenumber)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linenumber needs to be a positive integer and will get 

<P>&nbsp;&nbsp;:readable(who)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether the current editing session has been made globally readable.
<BR>&nbsp;&nbsp;:set_readable(who,boolean)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;change the readability of the current editing session.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This is used by the publish/perish verbs.

<P>We also provide

<P>&nbsp;&nbsp;:invoke(...)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If the person has a previous unsaved (i.e., :changed()!=0)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session, we return to it, moving the character object to the editor.  
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If the person is already in the editor, this has no effect other
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;than to print a few nasty messages.  In any case a :changed()
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session must be aborted or set_changed(,0) before anything else 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can be started

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Otherwise, we pass the arguments (which are assumed to be the
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result of some munging of the command line) to :parse_invoke(),
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;move the character to the editor and load whatever parse_invoke()
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;specified.  The only interpretation the generic editor makes on
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the arguments is that if the boolean value of the first is true,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this indicates that the person wanted to load something as
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opposed to resume a previous session.  Usually a command calling
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:invoke will have a true (i.e., nonzero number, nonempty list or
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string) first arg iff the command line is nonempty, in which case 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'args' works fine for this purpose.

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If the command parses sucessfully (:parse_invoke() returns a list),
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we move the character to the editor if necessary and then call 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:init_session() to set things up.

<P>The child editor is assumed to provide

<P>&nbsp;&nbsp;:parse_invoke(...)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;given :invoke()'s arguments, determines what the person wants to edit.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;It either returns 0 and reports syntax errors to `player',
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or it returns some list that :init_session() will understand.

<P>&nbsp;&nbsp;:init_session(who,@spec)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where spec is something that was returned by :parse_invoke().
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Loads the text and sets the stateprops (below) to indicate that 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we are working on whatever it is we're suppose to be working on.

<P>&nbsp;&nbsp;:working_on(who)   
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns a string X as in "You are working on X."
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This is called by the 'w*hat' command, among other things.

<P>Child editors may have their own properties giving state information for the various editing sessions.  The value of each such property will be a list giving a value for each person in the editor.  For each such property, you should, once the editor object has been created, initialize the property to {} and do one of

<P>&nbsp;&nbsp;&nbsp;&nbsp;@stateprop &lt;propname&gt;                 for &lt;editor&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;@stateprop &lt;propname&gt;=&lt;default-value&gt; for &lt;editor&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(0 is the default &lt;default-value&gt;)

<P>Henceforth, adding and deleting new editing sessions will amend the list held by the given property.  The value of the property for a given session can be obtained via this.&lt;propname&gt;[player in this.active] and can be changed with a corresponding listset() call.  The usual idiom for an editor command is

<P>&nbsp;&nbsp;&nbsp;if(!(who=this:loaded(player)))
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;player:tell(nothing_loaded_msg());
<BR>&nbsp;&nbsp;&nbsp;else
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... various references to  this.&lt;propname&gt;[who] ...
<BR>&nbsp;&nbsp;&nbsp;endif

<P>To remove such a property from the list of such state properties:

<P>&nbsp;&nbsp;&nbsp;&nbsp;@rmstateprop &lt;propname&gt; from &lt;editor&gt;

<P>Note that you can only do this with properties defined on the child editor itself.  

<P>Sometimes you may wish to @stateprop a new property on an editor where active editing sessions exist.  @stateprop will fail if the property in question does not hold a list of the correct length (== length(editor.active); one value for each editing session).  You need to either give the @flush command to clear out all sessions and boot all characters currently in the editor or somehow manually initialize the property to a list of appropriate values and pray that nobody enters/exits the editor between the property initialization and the @stateprop command - this problem can be avoided by doing an eval() that does all of the initializations (beware of suspends()) and calls :set_stateprops directly.

<P>Incidentally, the @flush command may be used at any time to clean out the editor or to remove all sessions older than a given date.

<P>There are also numerous _msg properties that may be customized

<P>&nbsp;&nbsp;&nbsp;&nbsp;@depart          announced at the origin when :invoke() is called. 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;@return          announced at the origin the character is returned there.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;@nothing_loaded  printed when user attempts editing 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;before anything has been loaded.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;@no_text         response to 'list' when :text()=={}
<BR>&nbsp;&nbsp;&nbsp;&nbsp;@no_change       printed by 'what' when :changed()==0
<BR>&nbsp;&nbsp;&nbsp;&nbsp;@change          printed by 'what' when :changed()==1
<BR>&nbsp;&nbsp;&nbsp;&nbsp;@no_littering    printed upon leaving the editor with :changed()==1.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;@previous_session  printed by :invoke() when the person tries to start a 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new session without aborting or saving the old one

<P>The general procedure for creating a child editor:

<P>. @create $generic_editor named &lt;editor&gt;

<P>. define additional &lt;editor&gt; verbs/properties
<BR>&nbsp;&nbsp;&nbsp;&nbsp;At the very least you need 'edit' and 'save' commands.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Usually you can get away with just having 'edit' call :invoke();
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Presumably, you'll need at least a command to load text from somewhere
<BR>&nbsp;&nbsp;&nbsp;&nbsp;as well as a command to save it back out.

<P>. define a verb (somewhere) to invoke the editor 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;This could be just a one-liner that calls &lt;editor&gt;:invoke(args,verb).
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Either that or
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.  you have to set up an exit somewhere whose destination is &lt;editor&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.  you have to advertise the object number so that people can 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;teleport to it.
<BR>&nbsp;&nbsp;
<BR>. @stateprop x for &lt;editor&gt;

<P>. if you want the 'abort' command to boot the person from the editor do
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&lt;editor&gt;.exit_on_abort = 1;

<P>. set &lt;editor&gt;.commands to be the list of additional commands defined
<BR>&nbsp;&nbsp;&nbsp;&nbsp;by &lt;editor&gt;.  
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Each element of the list is itself a list of the form {name,args}.
<BR>&nbsp;&nbsp;set &lt;editor&gt;.commands2 to be the list of commands that should appear
<BR>&nbsp;&nbsp;&nbsp;&nbsp;in the `look' listing, and should be a list of strings appearing 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;as names in .commands on either &lt;editor&gt; or some editor ancestor.
<BR>&nbsp;&nbsp;look at $verb_editor or $note_editor for an example.

<P>. If you want to have help text for new verbs you define, create a child of 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;$generic_help and add properties to this object for each of the topics 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;that you want to provide help text.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Finally, set &lt;editor&gt;.help = {this object} so that the help system
<BR>&nbsp;&nbsp;&nbsp;&nbsp;knows to consult this object.

<H2><A NAME="$generic_help">$generic_help</A></H2>

The Help System
<BR>---------------
<BR>When a person types help, the following list of objects is consulted for .help properties:  the person's character itself, all ancestors of that character up to and including $player, and, if the current location is a room, the current location together with all ancestors of the current location back to and including $room.  Each help property should have as value either an object or a list of objects (otherwise we just ignore it).  These objects are then strung together as a list of `help databases' to be searched in order for the requested topic.

<P>When a person uses the "help" command, the system:
<BR>&nbsp;&nbsp;1. retrieves a list of help databases to search, with
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$code_utils:help_db_list();
<BR>&nbsp;&nbsp;2. queries those help database's for matching topics using
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$code_utils:help_db_search();
<BR>&nbsp;&nbsp;&nbsp;&nbsp;2.a. each database is checked in the order given
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;db&gt;:find_topics), with $help always being the final database
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checked, until one returns a non-false value;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;2.b. if $help is reached, it also checks to see if the topic name
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches any object in the person's vicinity, and returns that as
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the topic if a match is found;
<BR>&nbsp;&nbsp;3. passes the result to player.location:help_huh() (if it exists)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in case the result should be modified;
<BR>&nbsp;&nbsp;4. if no topics were identified so far, asks $help:cmd_verb_help()
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to find a match to any matching verb on the `player' or
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`player.location' that has header documentation;
<BR>&nbsp;&nbsp;5. if still no matching topic is found, let
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$wiz_utils:missed_help() know, if
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$wiz_utils.missed_help_logging_enabled is true;
<BR>&nbsp;&nbsp;6. if a match was found, then call the help database that reported
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the match (&lt;db&gt;:get_topic) and ask for the help text itself;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;6.a. If the database is $help, and the help topic matched is
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;actually a nearby object, then &lt;object&gt;:help_msg() is called
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to retrieve the help text if that verb exists;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;6.b. If &lt;object&gt;:help_msg() doesn't exist or returns false, then
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the text of &lt;object&gt;.help_msg is used.

<P>A help database (in the sense of anything that is usable by $player:help()) is any object having the following three verbs:

<P>&nbsp;&nbsp;:find_topics([string])
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where string is a supposed help topic, returns a list of strings,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.e., actual help topics that this db knows about, or some boolean 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false value in the event that this db is clueless...
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If no arguments are given, this should return a list of all topics
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in the db

<P>&nbsp;&nbsp;:get_topic(string)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;given one of the strings returned by :find_topics this either
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns a list of strings (text to be spewed to the user) or
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns 1 to indicate that it has already taken care of printing
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;information to the user.

<P>&nbsp;&nbsp;:dump_topic(string)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;like get_topic, but instead returns the raw text of a help topic
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;as a (download/upload) script

<P>In short if :find_topic reports that a particular db knows about a given topic
<BR>it returns the full topic name, so that :get_topic may be called on it later.
<BR>:dump_topic is used by maintainers (see $wiz:@gethelp) to edit help topics.

<P>$generic_help and $help
<BR>-----------------------
<BR>The Generic Help Database, $generic_help, is the parent class of a particular kind of help database of which $help is an instance.  On help databases of this type, every help topic has a corresponding property, interpreted as follows:

<P>&nbsp;&nbsp;this.(topic) = string             
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;one-line help text.

<P>&nbsp;&nbsp;this.(topic) = {"*&lt;verb&gt;*",@args}
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call this:&lt;verb&gt;(args,dblist) to get text where dblist is the list of 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help objects that would have been consulted had the topic not been found 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on this object.

<P>&nbsp;&nbsp;this.(topic) = other list of strings 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;multi-line help text

<P>For the {"*&lt;verb&gt;*",...} form, the current verbs available are

<P>&nbsp;&nbsp;{"*forward*", topic, @rest}   
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- get help text for topic and then append the lines of `rest'.  
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rest may, in turn, begin with a "*&lt;verb&gt;*"...

<P>&nbsp;&nbsp;{"*pass*", topic, @rest}   
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- get help text for topic from the first help database after this one
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that actually has help text for topic, and then append lines of `rest'.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As with "*forward*" rest may, in turn, begin with a "*&lt;verb&gt;*"...

<P>&nbsp;&nbsp;{"*subst*", @lines} 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- All occurences of %[exp] in lines are replaced with the value of exp
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which is assumed to evaluate to a string.  
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;All lines beginning with %;exp are replaced with the value of exp 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which is assumed to evaluate to a list of strings.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Evaluation is done using $no_one's permissions so exp in either case
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can only refer to public information.

<P>&nbsp;&nbsp;{*verbheader*, object:verb, @rest}
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- returns the verb header documentation lines for object:verb, with @rest appended

<P>&nbsp;&nbsp;{"*index*", title}
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- returns a list of all topics in this database, arranged in columns.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;title is used as a heading for this index.

<P>Individual help dbs are free to define additional verbs that may be used in this context.  $help itself defines the following additional such verbs:

<P>&nbsp;&nbsp;{"*index_list*"}
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- returns a list of all index topics in all databases in the search list.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An index topic is one whose actual text is {"*index*", something}.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;When creating a help db, you should be sure to make an index topic.

<P>&nbsp;&nbsp;{"*full_index*"}
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- prints indices for all help databases in the search list.

<P>It should be noted (once again) that help databases need not be children of $generic_help, so long as they have :find_topics/:get_topic/:dump_topic working as specified above.

<H2><A NAME="$generic_option">$generic_option</A></H2>

Generic Option Package
<BR>----------------------
<BR>It occasionally happens that one has a command or set of commands for which one wishes to provide several options/flags that a person can set to customize the command's behavior for him/herself.  Making each option a separate property is a bit expensive, especially when the option in question is merely a boolean flag that gets set to false in most cases.  This package provides an alternative, as well as providing a uniform set of commands for setting these flags/options and checking that the values given are of appropriate types.

<P>Instead of needing several properties, only one is required to store a list containing values for all of the options.  An "option package" (pkg, below) is then an object of this class, which provides routines for manipulating such lists.

<P>The set of option names is divided into a set of "real" options, those whose names will actually appear in a given list, and "extras" which are either synonyms for or represent combinations of real options.

<P>&nbsp;pkg:add_name(name)      adds name to .names  (remove it from .extras if there)
<BR>&nbsp;pkg:add_name(name,1)    adds name to .extras (remove it from .names if there)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1 - ok, 0 - already added, E_INVARG - illegal name, E_PERM

<P>&nbsp;pkg:remove_name(name)   remove name from either .names or .extras
<BR>&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1 - ok, 0 - not present, E_PERM

<P>(I added the commands "@addname &lt;option&gt; to &lt;pkg&gt;" and "@rmname &lt;option&gt; from &lt;pkg&gt;" to call these.  EM)

<P>Every option added should have an associated .show_foo property added to the pkg object (by hand).  For instance,
<BR>&nbsp;&nbsp;pkg.show_foo = {"Your foo setting is off.", "Your foo setting is on."}
<BR>where the first string is the -foo setting and the second the +foo setting.
<BR>Options with more complex settings (eg. @myoption complex="this is complex") should
<BR>implement a :show_foo verb as described below.

<P>For setting or retrieving values we have

<P>&nbsp;pkg:get(options,name) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;=&gt; value (or 0 if name isn't a real option)
<BR>&nbsp;pkg:set(options,name,value)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;=&gt; revised options (or string error message if something goes wrong)
<BR>&nbsp;where "options" is generally "player.display_options" or whatever option property is being processed.

<P>Note that simple boolean options can be checked using
<BR>&nbsp;&nbsp;&nbsp;&nbsp;if (foo in player.pkg_options)
<BR>However, this breaks the encapsulation of the system, and therefore using pkg:get() is preferred.
<BR>A sample usage is:  if ($mail_options:get(player.mail_options,"netmail"))
<BR>Most option packages have associated verbs on $player, that simplify this.  For instance,
<BR>&nbsp;&nbsp;if (player:mail_option("sticky"))
<BR>There are related verbs for: edit_option, display_option, list_option

<P>By default, a given option can only be a boolean flag, having one of the values 0 (absent from the list), or 1 (present in the list).  :set translates 0/""/{} to 0 and any other non-object value to 1.

<P>One may however designate a wider range of possible values for an option "foo" by either installing one of

<P>&nbsp;&nbsp;pkg.type_foo
<BR>&nbsp;&nbsp;&nbsp;&nbsp;- list of allowed types, 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.g., {NUM,STR}   =&gt; must be a number or a string
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.g., {OBJ,{OBJ}} =&gt; must be an object or a list of objects
<BR>&nbsp;&nbsp;&nbsp;&nbsp;for anything fancier use:

<P>&nbsp;&nbsp;pkg:check_foo(value)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;=&gt; string error message or {value munged as desired}

<P>In general, the only restriction on option values is that 0 is the only false value; setting an option to "" or {} sets it to 0.  Every option defaults to 0, and no matter what you install as .type_foo or :check_foo(), 0 will always be a legal value for option "foo".

<P>When presented with an option that is in .extras, :set will typecheck the value as described, however, then :actual(name, value) will be called to obtain a list of {name-of-real-option, value} pairs indicating which combination of real options should be set.

<P>Other verbs
<BR>&nbsp;&nbsp;pkg:parse(args,...)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;parses the command line arguments of a @whatever_option command
<BR>&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {optionname, value}  if the person wants to set an option
<BR>&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {optionname}         if the person wants to view an option
<BR>&nbsp;&nbsp;&nbsp;&nbsp;=&gt; string error message  otherwise

<P>&nbsp;&nbsp;one may install pkg:parse_foo to parse arguments for option "foo" 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;!foo     =&gt; {"foo",0}  (:parse_foo not called)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;foo=     =&gt; {"foo",0}  (:parse_foo not called)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;-foo     =&gt; {"foo",0}  (:parse_foo not called)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;+foo     =&gt; pkg:parse_foo("foo",1)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;foo=word =&gt; pkg:parse_foo("foo","word")
<BR>&nbsp;&nbsp;&nbsp;&nbsp;foo word1 word2    =&gt; pkg:parse_foo("foo",{"word1","word2"})
<BR>&nbsp;&nbsp;&nbsp;&nbsp;foo is word1 word2 =&gt; pkg:parse_foo("foo",{"word1","word2"})

<P>&nbsp;pkg:show(options,name|list of names)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;=&gt; list of strings describing the current value of the named option(s).
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;calls     pkg:show_foo(options,list of names) or
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refers to pkg.show_foo to describe option "foo" 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The pkg:show_foo verb (if any) should return 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {foo, string describing current setting for option foo}

<P>(I added the command "@document &lt;option&gt; on &lt;pkg&gt;" for adding and changing the documentation on simple on/off options.  EM)

<P>(see sources for details...  at some point I'll finish writing this... -Rog)

<H2><A NAME="$generic_options">$generic_options</A></H2>

<P>See: <A HREF="#$generic_option">$generic_option</A>

<H2><A NAME="$gopher">$gopher</A></H2>

An interface to Gopher internet services.
<BR>Copyright (c) 1992,1993 Grump,JoeFeedback@LambdaMOO.

<P>This object contains just the raw verbs for getting data from gopher servers and parsing the results. Look at #50122 (Generic Gopher Slate) on LambdaMOO for one example of a user interface. 

<P>:get(site, port, selection)
<BR>&nbsp;&nbsp;Get data from gopher server: returns a list of strings, or an error if it couldn't connect. Results are cached.

<P>:get_now(site, port, selection)
<BR>&nbsp;&nbsp;Used by $gopher:get. Arguments are the same: this actually gets the 
<BR>&nbsp;&nbsp;data without checking the cache. (Don't call this, since the
<BR>&nbsp;&nbsp;caching is important to reduce lag.)
<BR>&nbsp;&nbsp;
<BR>:show_text(who, start, end, site, port, selection)
<BR>&nbsp;&nbsp;Requires wiz-perms to call.
<BR>&nbsp;&nbsp;like who:notify_lines($gopher:get(..node..)[start..end])

<P>:clear_cache()
<BR>&nbsp;&nbsp;Erase the gopher cache.

<P>:parse(string)
<BR>&nbsp;&nbsp;Takes a directory line as returned by $gopher:get, and return a list
<BR>&nbsp;&nbsp;{host, port, selector, label}
<BR>&nbsp;&nbsp;&nbsp;host, port, and selector are what you send to :get.
<BR>&nbsp;&nbsp;label is a string, where the first character is the type code.

<P>:type(char)
<BR>&nbsp;&nbsp;&nbsp;returns the name of the gopher type indicated by the character, e.g.
<BR>&nbsp;&nbsp;&nbsp;$gopher:type("I") =&gt; "image"

<H2><A NAME="$help">$help</A></H2>

<P>See: <A HREF="#$generic_help">$generic_help</A>

<H2><A NAME="$help_webviewer">$help_webviewer</A></H2>

The Help Text WebViewer ($help_webviewer) is a web application that
<BR>serves help text pages from the MOO's help database system, or from
<BR>help texts on MOO objects themselves.

<P>The routine form for a URL to retrieve a help text is:
<BR>&nbsp;&nbsp;http://moo.du.org:8000/help/no_object/topic?mail
<BR>where in this example the help text for the "mail" topic is returned.

<P>The form for returning the header text for a verb is:
<BR>&nbsp;&nbsp;http://moo.du.org:8000/help/no_object/topic?$string_utils:space
<BR>The system can also return texts associated with objects:
<BR>&nbsp;&nbsp;http://moo.du.org:8000/help/20
<BR>to return the help text for object #20 (usually $string_utils).

<P>For objects that have their own help databases associated with them,
<BR>you can obtain the help text for a topic in one of those specialized
<BR>databases with:
<BR>&nbsp;&nbsp;http://moo.du.org:8000/help/50/topic?fill
<BR>where in this case the object is the Verb Editor (#50), and "fill" is
<BR>the topic name.

<P>The Help Text WebViewer also includes a search field, where people
<BR>can enter the name of a topic to display.  At this time, the
<BR>WebViewer does not do keyword searches, although this functionality
<BR>could be added.
<BR>In order to minimize the potential for lagging the MOO through high
<BR>anonymous access of the WebViewer, the object will only accept at
<BR>most a certain number of simultaneous anonymous transactions.  This
<BR>is set by $help_webviewer.max_anon_calls property (set to 4 by
<BR>default).  Note that if an anonymous transaction is interrupted due
<BR>to a traceback error, that call's record will not be cleared, and as
<BR>a result the object will not know that it isn't still processing that
<BR>transaction.  As a result, the $help_webviewer.current_anon_calls
<BR>property will no go back down to zero.  Should several of these
<BR>events occur, the Help Text Webviewer may refuse any new anonymous
<BR>transcations, even though it isn't really processing any currently.
<BR>To fix this, just "@set $help_webviewer.current_anon_calls to 0" to
<BR>reset the value.

<H2><A NAME="$housekeeper">$housekeeper</A></H2>

The housekeeper is an object that can help keep other objects where they belong.  New MOOs may want to add their own user interface for the housekeeper; here is some information that may be helpful.

<P>To indicate what objects should be cleaned:

<P>&nbsp;&nbsp;:add_cleanup(object[, requestor[, where]])
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Ask the housekeeper to clean 'object' for 'requestor' to 'where'.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Requestor defaults to `player'.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Where defaults to object.location.

<P>&nbsp;&nbsp;:remove_cleanup(what[, requestor])
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Remove 'what' from the cleanup list at 'requestor's request.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Will remove it only if 'requestor' made the original request and owns
<BR>&nbsp;&nbsp;&nbsp;&nbsp;the object or the destination.

<P>To actually get the housekeeper to clean stuff up:

<P>&nbsp;&nbsp;:cleanup([insist])
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Clean up character's objects.  Argument is 'up' or 'up!' for manually
<BR>&nbsp;&nbsp;&nbsp;&nbsp;requested cleanups.  'up!' means to clean things even if it's against
<BR>&nbsp;&nbsp;&nbsp;&nbsp;the housekeeper's better judgement.

<P>&nbsp;&nbsp;:replace(object[, insist])
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Clean up the indicated object.  'insist' is as in :cleanup.

<P>&nbsp;&nbsp;:continuous()
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Starts the housekeeper cleaning continuously, killing any previous
<BR>&nbsp;&nbsp;&nbsp;&nbsp;continuous task.  This should be called only when starting up a new MOO,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;or if something has gone wrong, as normally it will just keep going
<BR>&nbsp;&nbsp;&nbsp;&nbsp;without any help.

<P>&nbsp;&nbsp;:litterbug()
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Clean up all the places in housekeeper.public_places by getting rid of
<BR>&nbsp;&nbsp;&nbsp;&nbsp;all contents not in their .residents lists.  This is called by
<BR>&nbsp;&nbsp;&nbsp;&nbsp;:continuous, so it doesn't need to be called directly.

<P>To find out what's being cleaned to where for whom:

<P>&nbsp;&nbsp;:cleanup_list([whom])
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Show 'player' the personal cleanup list for 'whom', or the housekeeper's
<BR>&nbsp;&nbsp;&nbsp;&nbsp;complete list if no argument is given.

<P>&nbsp;&nbsp;:clean_status()
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Show 'player' a brief summary of eir personal cleanup list.

<H2><A NAME="$html_editor">$html_editor</A></H2>

&nbsp;The $html_editor is a child of the generic editor that specifically
<BR>writes to object's associated URL/HTML data(#1.url).  Instead of
<BR>having "string" and "list" modes, like the text editor, it has a
<BR>"URL" and an "HTML" mode. The URL mode writes a single string,
<BR>indicative of a URL, and the HTML mode writes a list of strings,
<BR>indicative of an HTML text.

<P>Although it doesn't yet have any HTML-specific commands, these may be
<BR>added in the future to facilitate its use in creating HTML texts.
<BR>However, you can always create the HTML text in your favorite editor,
<BR>then paste the part between the &lt;BODY and &lt;/BODY&gt; tags into the HTML
<BR>editor to attach that HTML text to an object.

<H2><A NAME="$http_handler">$http_handler</A></H2>

The $http_handler:handle_http10 is the primary mechanism for
<BR>processing web transactions, and is usually called by an $http_port.
<BR>It accepts a URI in the following forms, with the results given:

<P>1) http://HOSTNAME:PORT
<BR>2) http://HOSTNAME:PORT/?WEBPASS
<BR>3) http://HOSTNAME:PORT/xxWEBPASS
<BR>4) http://HOSTNAME:PORT/xxWEBPASS/CODE
<BR>5) http://HOSTNAME:PORT/xxWEBPASS/CODE/OBJECT
<BR>6) http://HOSTNAME:PORT/xxWEBPASS/CODE/OBJECT/REST
<BR>7) http://HOSTNAME:PORT/xxWEBPASS/CODE/OBJECT/REST?SEARCH

<P>Where HOSTNAME is currently bioinfo.weizmann.ac.il,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PORT is 8888,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx are two random characters,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WEBPASS is the user's web password and may be blank,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CODE is the web application's identity,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT is an object number (without the #),
<BR>&nbsp;&nbsp;and REST is anything else you append to the URL.

<P>When the MOO receives a web connection, it parses it as described
<BR>above, and does the following:

<P>- a URL of type 1) will simply show the MOO's gateway page, unless
<BR>&nbsp;&nbsp;&nbsp;there is a form attached (which is then evaluated for
<BR>&nbsp;&nbsp;&nbsp;authentication information).
<BR>- a URL of type 2) or 3) will check the webpass.
<BR>&nbsp;&nbsp;- if it's omitted then either web cookie or web "domain"
<BR>&nbsp;&nbsp;&nbsp;&nbsp;authentication is used.
<BR>&nbsp;&nbsp;- if it's bad, it will show the MOO's identification screen.
<BR>&nbsp;&nbsp;- if it's OK, it will show the list of web applications.
<BR>- a URL of types 4), 5), 6) or 7) will check the CODE.
<BR>&nbsp;&nbsp;- if there isn't a code of a valid web app, it will show the list
<BR>&nbsp;&nbsp;&nbsp;&nbsp;of apps.
<BR>&nbsp;&nbsp;- if it's a valid code, it will call the application's  :method_get
<BR>&nbsp;&nbsp;&nbsp;&nbsp;or :method_post giving it as parameters: (who, what, rest,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;search), which are: the user whose webpass is being used,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;the object number that was parsed, the REST, and the SEARCH
<BR>&nbsp;&nbsp;&nbsp;&nbsp;if any.
<BR>_____________________________

<P>Web transactions typically follow the pathway:

<P>$http_port
<BR>&nbsp;&nbsp;&nbsp;|
<BR>&nbsp;&nbsp;&nbsp;V
<BR>/$http_handler:handle_http10
<BR>\$http_handler:handle_http09
<BR>&nbsp;&nbsp;&nbsp;|
<BR>&nbsp;&nbsp;&nbsp;| &lt;-&gt; parse_line
<BR>&nbsp;&nbsp;&nbsp;|
<BR>&nbsp;&nbsp;&nbsp;| &lt;-&gt; /web_authenticate
<BR>&nbsp;&nbsp;&nbsp;|     \cookie_authenticate
<BR>&nbsp;&nbsp;&nbsp;|
<BR>&nbsp;&nbsp;&nbsp;| &lt;-&gt; init_taskprop
<BR>&nbsp;&nbsp;&nbsp;V
<BR>:process &lt;-&gt; /$webapp:method_get &lt;-&gt; /object:html
<BR>&nbsp;&nbsp;&nbsp;|         \$webapp:method_post   | object:do_post
<BR>&nbsp;&nbsp;&nbsp;|                                 \object:get_vrml
<BR>&nbsp;&nbsp;&nbsp;|
<BR>&nbsp;&nbsp;&nbsp;|  The `process' verb determines which $webapp to call and
<BR>&nbsp;&nbsp;&nbsp;|  processes the result into its final form.
<BR>&nbsp;&nbsp;&nbsp;|
<BR>make_headerlist
<BR>&nbsp;&nbsp;&nbsp;|
<BR>&nbsp;&nbsp;&nbsp;V
<BR>tell_quick_and_die
<BR>_____________________________

<P>These properties are defined on $http_handler

<P>task_details            
<BR>task_index              
<BR>&nbsp;&nbsp;&nbsp;&nbsp;These store information about the open web transactions
<BR>&nbsp;&nbsp;&nbsp;&nbsp;that can be retrieved with $http_handler;retrieve_taskprop.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Also, any verb called during the transaction can submit new
<BR>&nbsp;&nbsp;&nbsp;&nbsp;task properties that can then be retrieved by any other
<BR>&nbsp;&nbsp;&nbsp;&nbsp;verb when called.  Some default properties can only be
<BR>&nbsp;&nbsp;&nbsp;&nbsp;retreived by wizardly verbs.
<BR>total_webcalls          
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Total number of web transactions handled by this object
<BR>&nbsp;&nbsp;&nbsp;&nbsp;since its installation.
<BR>webpass_handler         
<BR>&nbsp;&nbsp;&nbsp;&nbsp;The object number of the webpass handler object.  The
<BR>&nbsp;&nbsp;&nbsp;&nbsp;webpass handler is not corified.
<BR>gateway_html            
<BR>&nbsp;&nbsp;&nbsp;&nbsp;The default web page displayed when someone connects to
<BR>&nbsp;&nbsp;&nbsp;&nbsp;$network.site on a port with an $http_port object
<BR>&nbsp;&nbsp;&nbsp;&nbsp;listening.  This should have a form allowing authentication
<BR>&nbsp;&nbsp;&nbsp;&nbsp;(see the default value for an example).
<BR>wizwebpass_disallowed   
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Almost obsoleted mechanism for regulating which
<BR>&nbsp;&nbsp;&nbsp;&nbsp;authentication system wizards may use to open a web window
<BR>&nbsp;&nbsp;&nbsp;&nbsp;for their wiz character.
<BR>version                 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;The currently installed version of the BioGate system.
<BR>output_timeout          
<BR>&nbsp;&nbsp;&nbsp;&nbsp;If a transaction takes longer than this number of seconds,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;it is assumed to have failed (probably due to a traceback),
<BR>&nbsp;&nbsp;&nbsp;&nbsp;and the connection is broken.
<BR>password_failed_text    
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Text returned if a web transaction is incorrectly
<BR>&nbsp;&nbsp;&nbsp;&nbsp;authenitcated.
<BR>exempt_from_pads        
<BR>&nbsp;&nbsp;&nbsp;&nbsp;By default, the $http_handler assumes transactions are
<BR>&nbsp;&nbsp;&nbsp;&nbsp;requests for HTML documents, and builds a proper header and
<BR>&nbsp;&nbsp;&nbsp;&nbsp;footer with the appropriate tags.  Some transactions, like
<BR>&nbsp;&nbsp;&nbsp;&nbsp;VRML requests, shouldn't have these and are "exempted from
<BR>&nbsp;&nbsp;&nbsp;&nbsp;pads." Although the $std_vrml10viewer and $frame_manager
<BR>&nbsp;&nbsp;&nbsp;&nbsp;are automatically exempt, any other kids of the $webapp you
<BR>&nbsp;&nbsp;&nbsp;&nbsp;want exempted should be added here.
<BR>anon_access_limits      
<BR>&nbsp;&nbsp;&nbsp;&nbsp;A list of two elements, that set usage limits beyond which
<BR>&nbsp;&nbsp;&nbsp;&nbsp;unauthenticated transactions are rejected.  The first
<BR>&nbsp;&nbsp;&nbsp;&nbsp;element is the maxiumum number of concurrent web
<BR>&nbsp;&nbsp;&nbsp;&nbsp;transactions and the second is the maximum MOO lag in
<BR>&nbsp;&nbsp;&nbsp;&nbsp;seconds.
<BR>lag_meter               
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Object that tracks and reports lag.  Found in most MOOs
<BR>&nbsp;&nbsp;&nbsp;&nbsp;though not part of LambdaCore.  If not set, lag-based
<BR>&nbsp;&nbsp;&nbsp;&nbsp;features are disabled.
<BR>too_much_load_text      
<BR>&nbsp;&nbsp;&nbsp;&nbsp;HTML doc sent when the MOO has too high a load to process
<BR>&nbsp;&nbsp;&nbsp;&nbsp;unauthenticated HTTP transactions.
<BR>java_clients            
<BR>&nbsp;&nbsp;&nbsp;&nbsp;List of Java telnet client handlers allowed to use the web
<BR>&nbsp;&nbsp;&nbsp;&nbsp;system.
<BR>javaclient_codebase     
<BR>&nbsp;&nbsp;&nbsp;&nbsp;The subdirectory at the MOO's site where java clients are
<BR>&nbsp;&nbsp;&nbsp;&nbsp;found.  Used as $network.site +
<BR>&nbsp;&nbsp;&nbsp;&nbsp;$http_handler.javaclient_codebase +
<BR>&nbsp;&nbsp;&nbsp;&nbsp;$jclient_handler.client_name
<BR>login_is_http09         
<BR>&nbsp;&nbsp;&nbsp;&nbsp;If true, treats call transactions that come through $login
<BR>&nbsp;&nbsp;&nbsp;&nbsp;as HTTP/0.9 (rarely used).
<BR>port_handlers           
<BR>&nbsp;&nbsp;&nbsp;&nbsp;List of objects permitted to call the handle_http09 and
<BR>&nbsp;&nbsp;&nbsp;&nbsp;handle_http10 verbs.  Generally kids of $http_port, and
<BR>&nbsp;&nbsp;&nbsp;&nbsp;sometimes $login.
<BR>auth_ports              
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Almost obsoleted mechanism for regulating which
<BR>&nbsp;&nbsp;&nbsp;&nbsp;authentication system wizards may use to open a web window
<BR>&nbsp;&nbsp;&nbsp;&nbsp;for their wiz character.
<BR>robots_txt              
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Sent upon requests for "/robots.txt" and tells web spiders
<BR>&nbsp;&nbsp;&nbsp;&nbsp;not to scan the MOO for web pages (which could cause CPU and
<BR>&nbsp;&nbsp;&nbsp;&nbsp;networking load problems).  Note that you can use this to
<BR>&nbsp;&nbsp;&nbsp;&nbsp;restrict web spiders and other web cataloging robots to only
<BR>&nbsp;&nbsp;&nbsp;&nbsp;portions of your MOO.  By default, everything but the gateway
<BR>&nbsp;&nbsp;&nbsp;&nbsp;page is off limits.  For details on constructing a robots.txt
<BR>&nbsp;&nbsp;&nbsp;&nbsp;entry, see:  
<BR>&nbsp;&nbsp;&nbsp;&nbsp;http://info.webcrawler.com/mak/projects/robots/robots.html

<H2><A NAME="$http_port">$http_port</A></H2>

&nbsp;&nbsp;The $http_port listens on a MOO port for incoming HTTP transactions
<BR>has a few properties and verbs that provide its listening
<BR>functionality, and it also carries some properties used by the server
<BR>that are described in detail in the LambdaMOO Programmer's Manual
<BR>(server_options, connect_timeout, timeout_msg, recycle_msg, boot_msg,
<BR>redirect_from_msg, redirect_to_msg, create_msg, connect_msg, and
<BR>server_full_msg).

<P>The $http_port:do_login_command verb is the main workhorse of the
<BR>object.  It parses the incoming transaction's first line to
<BR>determine the method (GET/POST), the URI (specifies the requested
<BR>resource), and the protocol version (generally 1.0).  Transactions
<BR>are then passed to $http_handler:handle_http09 or
<BR>$http_handler:handle_http10 depending on the HTTP version of the
<BR>incoming transaction.

<P>User commands (wizardly use only) on the $http_port are:

<P>@set-port &lt;port number&gt; on &lt;listener&gt;
<BR>&nbsp;&nbsp;&nbsp;set the port to listen on
<BR>@startlistening on &lt;listener&gt;
<BR>&nbsp;&nbsp;&nbsp;the object starts listening
<BR>@stoplistening on &lt;listener&gt;
<BR>&nbsp;&nbsp;&nbsp;the object stops listening

<P>These have executable equivalents, useful if your MOO automatically
<BR>starts listening with an $http_port upon startup.  These
<BR>are: set_port, listen, and unlisten.

<H2><A NAME="$jclient_handler">$jclient_handler</A></H2>

Child objects of the $jclient_handler carry verbs and properties that
<BR>allow the MOO to effectively communicate with their corresponding
<BR>java telnet applets.  This includes information like where the applet
<BR>may be retrieved from, and how to tell the applet to update a web

<P>Verbs on the $jclient_handler work with the Cup-O MUD client by
<BR>default, but can be overridden on child objects to give new
<BR>functionality.
<BR>page.

<P>The "client_name" property must be set for the client handler to
<BR>function.  This is actually the subdirectory and class file name to
<BR>be appended to $http_handler.java_clients when forming the URL for
<BR>retrieving the Java code.

<P>For instance:
<BR>&nbsp;&nbsp;$network.site = moo.site.org
<BR>&nbsp;&nbsp;$http_port.handles_port = 8000
<BR>&nbsp;&nbsp;$http_handler.java_clients = "/java/"
<BR>&nbsp;&nbsp;&lt;jclient_handler&gt;.client_name = "CupOmud/CupOmud"

<P>Would yield the URL:
<BR>&nbsp;&nbsp;http://moo.site.org:8000/java/CupOmud/CupOmud.class

<P>The "default_preload_page" property contains the text to be displayed
<BR>in the web page frame of the user's web browser window until the
<BR>telnet client finishes loading and issues a "display URL" command of
<BR>its own.  You can use the default value if you wish.

<P>The "client_windowname" and "html_windowname" properties give the
<BR>names of the frames that will hold the client applet and the HTML
<BR>text display, respectively.

<P>The "float_client_frame" verb returns true if the client will be set
<BR>in a floating independent frame.  Typically it just returns the value
<BR>of the "float_client_frame" property, but may also check user
<BR>preferences to determine a result.

<P>The "make_applet_html" verb is called by the $frame_manager and
<BR>returns the HTML document containing &lt;EMBED&gt; tags that will load the
<BR>Java telnet client.

<P>The "update_webframe" verb sends a command (using MCP in the case of
<BR>Cup-O MUD) to the the client that causes it to force the web browser
<BR>to load a new HTML document into a specified frame.

<P>The "user_autoconnected" verb is called when a person first connects
<BR>to the MOO through a Java telnet client, typically through the
<BR>$login:preapproved system.

<P>The "preload_page" verb returns the HTML document to be displayed in
<BR>the usual web page frame until the first "display URL" command is
<BR>issued by the Java telnet client.


<H2><A NAME="$local">$local</A></H2>

The following customizable properties are defined on $local:

<P>.default_rooms
<BR>&nbsp;&nbsp;These are rooms all users see with the @rooms command, and to which
<BR>&nbsp;&nbsp;they can @go.  Add and remove rooms with the @addroom and @rmroom
<BR>&nbsp;&nbsp;command.

<P>.guest_lines
<BR>&nbsp;&nbsp;This property is a list of texts randomly chosen among to be
<BR>&nbsp;&nbsp;displayed when a guest connects (see $limbo.con_guest).  Each new
<BR>&nbsp;&nbsp;section starts with a period, so a line without a period as the
<BR>&nbsp;&nbsp;first character indicates a continuation line.  This property can
<BR>&nbsp;&nbsp;be customized.
<BR>&nbsp;&nbsp;If your guests connect in quiet cubicles, these texts are
<BR>&nbsp;&nbsp;irrelevent.

<P>.purge_candidates
<BR>.vspo_purge_candidates
<BR>.purge_deadline
<BR>.purge_time
<BR>.purge_exceptions
<BR>.purge_notice_txt
<BR>.to_be_purged
<BR>&nbsp;&nbsp;The purge system is a still incomplete set of utilities intended to
<BR>&nbsp;&nbsp;aid in identifying and recycling outdated, unused characters and
<BR>&nbsp;&nbsp;their posessions.  The properties in this section can be ignored,
<BR>&nbsp;&nbsp;at this time.

<P>.desc_txt
<BR>.info_txt
<BR>.gend_txt
<BR>.home_txt
<BR>.wrap_txt
<BR>.msgs_txt
<BR>.no_bother_txt
<BR>.header
<BR>.presskey
<BR>&nbsp;&nbsp;This section is for an as yet incomplete system, and its
<BR>&nbsp;&nbsp;values can be ignored at this time.
<BR>&nbsp;&nbsp;This section contains various messages displayed occasionally to
<BR>&nbsp;&nbsp;characters with $player.newbie set true.  Users can set this with
<BR>&nbsp;&nbsp;"@newbie on|off" and it's intended as a gentle reminder to people
<BR>&nbsp;&nbsp;to customize their characters.  The $player:newbie_prompt scans the
<BR>&nbsp;&nbsp;user's characteristics to determine which message should be
<BR>&nbsp;&nbsp;displayed.

<P>.banish_text
<BR>&nbsp;&nbsp;The .banish_text is displayed to guests who are banished by users
<BR>&nbsp;&nbsp;with the @banish command.  This can be customized.
<BR>.tag_notify
<BR>&nbsp;&nbsp;The .tag_notify property stores character objnums to be notified
<BR>&nbsp;&nbsp;when they next connect that they have been @tag'd.
<BR>.banishing_disabled
<BR>.tagging_disabled
<BR>&nbsp;&nbsp;The .banishing_disabled and .tagging_disabled properties store
<BR>&nbsp;&nbsp;local user restrictions on banishing and tagging.  See the help
<BR>&nbsp;&nbsp;texts for the commands that modify these properties, @notag and
<BR>&nbsp;&nbsp;#nobanish.

<P>.first_time_connect_script
<BR>&nbsp;&nbsp;This is a script, which if set is displayed to people the first
<BR>&nbsp;&nbsp;time they connect.  See $guest.login_script for and example of the
<BR>&nbsp;&nbsp;format.  This system is currently under revision.

<P>.converted_msg
<BR>.oconverted_msg
<BR>&nbsp;&nbsp;The .converted_msg and .oconverted_msg texts are displayed when a
<BR>&nbsp;&nbsp;VSPO character is made into a regular character.  These can be
<BR>&nbsp;&nbsp;customized.

<P>.auto_guest_log
<BR>&nbsp;&nbsp;Guests from sites whose names match the strings in this list are
<BR>&nbsp;&nbsp;automatically logged when they connect, as if someone immediately
<BR>&nbsp;&nbsp;typed @witness right after they connected.  The logs are not
<BR>&nbsp;&nbsp;stored unless someone uses @banish on them.  The verb
<BR>&nbsp;&nbsp;$local:check_auto_guest_log checks this property.  This property
<BR>&nbsp;&nbsp;can be customized by hand (using @set).

<P>.projects
<BR>.projects_mail_recipient
<BR>&nbsp;&nbsp;These properties are part of the wizard projects system.  See "help
<BR>&nbsp;&nbsp;@projects" for more info.

<P>.out_exit_target
<BR>&nbsp;&nbsp;This is used by the @testexits command to check if rooms are
<BR>&nbsp;&nbsp;properly linked to the main MOO with exists aliases as "out."
<BR>&nbsp;&nbsp;It's only relevent if you have such a construction policy, that
<BR>&nbsp;&nbsp;people should be able to reach the room this property identifies,
<BR>&nbsp;&nbsp;by repeatedly typing "out" until they arrive.  If the MOO lacks
<BR>&nbsp;&nbsp;such a policy, both this property and the $builder:@testexits
<BR>&nbsp;&nbsp;command can be removed.

<P>.checkpoint_started_msg
<BR>.checkpoint_finished_msg
<BR>.broadcast_checkpoint_messages
<BR>&nbsp;&nbsp;This section causes every connected user to be told when
<BR>&nbsp;&nbsp;checkpoints start and end.  Some administrators may find it
<BR>&nbsp;&nbsp;appeases the users a bit if your MOO lags a lot during
<BR>&nbsp;&nbsp;checkpoints, since people will at least understand why.  If
<BR>&nbsp;&nbsp;.broadcast_checkpoint_messages is true, then the two messages are
<BR>&nbsp;&nbsp;displayed appropriately.  All three of these properties can be
<BR>&nbsp;&nbsp;customized by hand (using @set).

<P>.nope_header_txt
<BR>.nope_footer_txt
<BR>.nope_txt_substitutions
<BR>.name_nope_txt
<BR>.reason_nope_txt
<BR>.info_nope_txt
<BR>.vspo_nope_txt
<BR>&nbsp;&nbsp;These properties are used by the @rejected command system to create
<BR>&nbsp;&nbsp;an email to send (with $wiz_utils:compose_nope_txt).  They can all
<BR>&nbsp;&nbsp;be customized for the MOO, generally with @edit.  The .nope_header_txt
<BR>&nbsp;&nbsp;is always used at the top of the letter, and the .nope_footer_txt
<BR>&nbsp;&nbsp;always included at the end.  In between are any of the
<BR>&nbsp;&nbsp;&lt;reason&gt;_nope_txt properties chosen by the person rejecting the
<BR>&nbsp;&nbsp;application.  See "help $local:nope_header_txt" for details of how
<BR>&nbsp;&nbsp;to use the .nope_txt_substitutions property.

<P>.new_player_email_txt
<BR>&nbsp;&nbsp;This property holds the text of the email sent to characters newly
<BR>&nbsp;&nbsp;made with @created.  It should be customized for the MOO.

<P>.idle_check_enabled
<BR>.idle_check_interval
<BR>.idle_limits
<BR>.idle_boot_protect
<BR>.idle_warning_text
<BR>&nbsp;&nbsp;If .idle_check_enabled is true, then people idle for longer than
<BR>&nbsp;&nbsp;the values in .idle_limits are warned (with .idle_warning_text)
<BR>&nbsp;&nbsp;and then disconnected, unless their character's object number is
<BR>&nbsp;&nbsp;in the .idle_boot_protect list or they are a Wizard or Manager.
<BR>&nbsp;&nbsp;Characters are checked for idleness every .idle_check_interval
<BR>&nbsp;&nbsp;seconds.  By default, the values in .idle_limits (read by
<BR>&nbsp;&nbsp;$wiz_utils:idle_check, where there is further documentation) are a
<BR>&nbsp;&nbsp;warning after 55 minutes and booted after 60 minutes idle.

<P>.autosubscribe_lists
<BR>&nbsp;&nbsp;This is a list of oject numbers, each of which should be a child of
<BR>&nbsp;&nbsp;$mail_recipient.  All newly created characters are automatically
<BR>&nbsp;&nbsp;subscribed to the mail-folders in this list.  It should be
<BR>&nbsp;&nbsp;customized by hand (using @set).

<P>.character_lists
<BR>&nbsp;&nbsp;This is a list of property references in the form { {$pointer STR,
<BR>&nbsp;&nbsp;propname STR}, ... } referencing lists of character object numbers
<BR>&nbsp;&nbsp;that should be cleaned when a character is recycled.  It should be
<BR>&nbsp;&nbsp;customized only if the core is modified such that new lists of
<BR>&nbsp;&nbsp;character objnums are used.  Quoting from $player:recycle...
<BR>&nbsp;&nbsp;The next lines remove the character from various other places
<BR>&nbsp;&nbsp;where character references appear.  It presumes the caller
<BR>&nbsp;&nbsp;will have perms to modify these, else they're skipped.

<P>.rintintin
<BR>&nbsp;&nbsp;This property is used by $player.@locate only, to insure people
<BR>&nbsp;&nbsp;only have one such search running at a time.  The property is
<BR>&nbsp;&nbsp;unused until $player:@locate is modified to fit corification and
<BR>&nbsp;&nbsp;not routinely deleted during core extraction.

<P>.not_builder_msg
<BR>&nbsp;&nbsp;This is the message displayed when someone who is not a builder
<BR>&nbsp;&nbsp;tries to use the @dig or @create command.  It should be customized
<BR>&nbsp;&nbsp;for the MOO so that people are told how they may get builder
<BR>&nbsp;&nbsp;permissions.

<P>.last_creation_check
<BR>.mailto_creation_check
<BR>&nbsp;&nbsp;These properties are used by the object creation check system,
<BR>&nbsp;&nbsp;which sends daily mail to all characters listed in
<BR>&nbsp;&nbsp;.mailto_creation_check about what objects have been created during
<BR>&nbsp;&nbsp;the last 24 hours.  This can be useful for noting what areas of
<BR>&nbsp;&nbsp;the MOO are being build, and who is working on what.  The object
<BR>&nbsp;&nbsp;creation check system is run once per day, launched by the
<BR>&nbsp;&nbsp;$local:checkpoint_hook verb.  The .mailto_creation_check property
<BR>&nbsp;&nbsp;can by edited by hand (using @set).

<P>.scandal_mongers
<BR>.watch_mail_interval
<BR>.watched
<BR>.logs
<BR>&nbsp;&nbsp;The log mailing system is currently under development.  Unless the
<BR>&nbsp;&nbsp;$wiz_utils:period verb is running (activated by hand), it won't
<BR>&nbsp;&nbsp;function.
<BR>&nbsp;&nbsp;Every .watch_mail_interval seconds, the $wiz_utils:periodic verb
<BR>&nbsp;&nbsp;&nbsp;&nbsp;runs.  Each character listed in .watched (each of which presumably
<BR>&nbsp;&nbsp;&nbsp;&nbsp;has permanent logging activated; i.e. their $player.permanent_log
<BR>&nbsp;&nbsp;&nbsp;&nbsp;property is set) has their collected log sent to each person
<BR>&nbsp;&nbsp;&nbsp;&nbsp;listed in .scandal_mongers, and their $player.log property is
<BR>&nbsp;&nbsp;&nbsp;&nbsp;transferred to .logs and then cleared.  Note that if mailed
<BR>&nbsp;&nbsp;&nbsp;&nbsp;logging is activated, the $local.logs will grow endlessly until it
<BR>&nbsp;&nbsp;&nbsp;&nbsp;is cleared by hand (with "@set $local.logs to {}").
<BR>&nbsp;&nbsp;
<BR>.email_address_required
<BR>&nbsp;&nbsp;&nbsp;If this is set, then people with a blank email address
<BR>&nbsp;($player.email_address=="") are issued the message in
<BR>&nbsp;&nbsp;$local.email_missing_text when they connect.

<P>.trustees
<BR>&nbsp;&nbsp;This property is specific to DU MOO and is removed during the
<BR>&nbsp;&nbsp;eduCore extraction process.

<H2><A NAME="$login">$login</A></H2>

$login
<BR>------
<BR>This object manages command parsing for unconnected people and governs the initiation of an actual connection.  There are verbs pertaining to registration, controlling user character creation, and doing site-locks (see `help blacklist' on $wiz_help).

<P>COMMANDS FOR UNCONNECTED USERS

<P>Recall that for each line that an unconnected person types, the server parses that line into words (the same way normal commands are parsed into a list of words that is then assigned to `args') and then #0:do_login_command is called.

<P>&nbsp;&nbsp;:parse_command (@args) =&gt; {verb, @args}
<BR>&nbsp;&nbsp;&nbsp;&nbsp;given the sequence of arguments that were fed to #0:do_login_command
<BR>&nbsp;&nbsp;&nbsp;&nbsp;this returns the name of a verb on $login to be called together with a 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;list of arguments to be passed to it.

<P>By default this just returns args iff args[1] names an actual verb on $login that is +x and has args {"any","none","any"}.  Otherwise, it returns one of

<P>&nbsp;&nbsp;.blank_command   - verb to call if command line is empty
<BR>&nbsp;&nbsp;.bogus_command   - verb to call if command line otherwise unintelligible

<P>In both cases :parse_command returns a verbname followed by the entire args list passed to it (including the would-be verb at the beginning if any).

<P>Currently the following verbs are availabe to non-connected people

<P>&nbsp;&nbsp;h*elp @h*elp       - print .welcome_message
<BR>&nbsp;&nbsp;?                  - print a short list of available commands
<BR>&nbsp;&nbsp;w*ho @w*ho         - print a list of logged in people (excluding wizards)
<BR>&nbsp;&nbsp;co*nnect @co*nnect - connect to an existing character
<BR>&nbsp;&nbsp;cr*eate @cr*eate   - create a new character
<BR>&nbsp;&nbsp;up*time @up*time   - tell how long the server has been running
<BR>&nbsp;&nbsp;version @version   - tell which version of the server is running
<BR>&nbsp;&nbsp;q*uit @q*uit       - logoff

<P>Adding a new command is fairly straightforward; just create a verb on $login, making sure a previous verb doesn't already match the name you want to give it.  Then give it args of "any" "none "any" and make sure it is +x.  Such a verb should begin with `if (caller != #0) return E_PERM; ...' so as to prevent anyone other from a not-logged-in person from making use of it.

<P>CUSTOMIZATIONS

<P>&nbsp;&nbsp;.welcome_message 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;- the message for "help" to print.
<BR>&nbsp;&nbsp;.create_enabled 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;== 0 =&gt; `create' prints .registration_string if one tries to use it
<BR>&nbsp;&nbsp;&nbsp;&nbsp;== 1 =&gt; anyone from a non-blacklisted site (see `help blacklist')
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;may use `create' to make a new character

<P>&nbsp;&nbsp;.registration_address
<BR>&nbsp;&nbsp;&nbsp;&nbsp;- an email address for character creation requests
<BR>&nbsp;&nbsp;.registration_string  
<BR>&nbsp;&nbsp;&nbsp;&nbsp;- string to print to people to give them information about how to get 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a character created for them, .registration_address is substituted 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for %e, % for %%
<BR>&nbsp;&nbsp;.newt_registration_string
<BR>&nbsp;&nbsp;&nbsp;&nbsp;- string to print to @newted characters (see `help @newt').
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;same substitutions as for .registration_string.

<P>Other verbs
<BR>&nbsp;&nbsp;&nbsp;:registration_string()      =&gt; .registration_string with substitutions
<BR>&nbsp;&nbsp;&nbsp;:newt_registration_string() =&gt; .newt_registration_string with substitutions
<BR>&nbsp;&nbsp;&nbsp;:player_creation_enabled(connection) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decides whether someone on connection should be allowed to create 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a character.  If you decide this shouldn't depend strictly on the blacklist
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and on the value of .create_enabled, here's where the extra code can go.
<BR>&nbsp;&nbsp;&nbsp;:check_for_shutdown()
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prints a warning message to append to the login banner in the event 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that the server will be going down soon.
<BR>&nbsp;&nbsp;&nbsp;:check_player_db()
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prints a warning message to append to the login banner in the event 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that $player_db is being reloaded to warn people that their character
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;names might not be recognized.

<P>SITE LOCKS
<BR>see `help blacklist'


<H2><A NAME="$mail_agent">$mail_agent</A></H2>

$mail_agent

<P>This object contains a two distinct sets of routines:

<P>&nbsp;&nbsp;1.  utilities for performing basic mailsystem functions, e.g.,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matching on recipient names, resolving mail forwarding, 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatting messages, sending messages

<P>Recipient Matching

<P>match           - match on a $mail_recipient
<BR>match_recipient - match on either a $mail_recipient or a character object
<BR>match_failed    - print angry messages to the user for $failed/ambiguous_match

<P>look_self  - provides a list of available $mail_recipients
<BR>check_names
<BR>touch
<BR>accept

<P>Message Format

<P>make_message        - produces a message in the canonical transmission format
<BR>name                - single recipient     =&gt; string for address field
<BR>name_list           - list of recipients   =&gt; string for address field
<BR>parse_address_field - address field string =&gt; object list

<P>Sending Messages

<P>send_message  - advertised message sending routine.
<BR>raw_send      - raw message sending routine 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(only called by $mail_editor:send and this:send_message)
<BR>resolve_addr  - converts a given list recipients into a list of actual 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recipients and objects to be notified.
<BR>sends_to      - Does X forward (transitively) to Y

<P>Mail Options

<P>option         
<BR>option_verbose

<P>&nbsp;&nbsp;2.  canonical versions of mail_recipient verbs

<P>Ideally, the verbs to perform operations on a given mail recipient would be located on the recipient itself, except for the fact that these verbs also need to be located on characters, which for various reasons, shouldn't be children of $mail_recipient.  Multiple inheritance would solve our problems, but we don't have it yet.  Ergo, both $mail_recipient and $player refer to the following verbs here:

<P>display_seq_full     print entire text of messages  (@read)
<BR>display_seq_headers  print headers of messages      (@mail)
<BR>rm_message_seq       remove messages                (@rmm)
<BR>undo_rmm             undo last rm_message_seq       (@unrmm)
<BR>expunge_rmm          flush removed messages         (@unrmm expunge)
<BR>list_rmm             list removed messages          (@unrmm list)
<BR>renumber             renumber messages              (@renumber)
<BR>msg_summary_line     msg header =&gt; display_seq_headers/list_rmm summary line

<P>parse_message_seq    command line msg sequence spec =&gt; message sequence
<BR>new_message_num      =&gt; message number of next new message
<BR>length_all_msgs      =&gt; number of messages (total)
<BR>length_num_le        =&gt; number of messages numbered &lt;= some number
<BR>length_date_le       =&gt; number of messages dated &lt;= some date
<BR>exists_num_eq        =&gt; true iff there exists a messsage with the given number
<BR>from_msg_seq         =&gt; message sequence of msgs from given sender(s)
<BR>to_msg_seq           =&gt; message sequence of msgs to given recipient(s)
<BR>subject_msg_seq      =&gt; message sequence of msgs with subjects containing text
<BR>body_msg_seq         =&gt; message sequence of msgs with bodies containing text
<BR>messages_in_seq      =&gt; list of {message number, message} pairs

<P>messages             == :messages_in_seq(1,:length_all_msgs()+1)   (obsolete)

<P>The $mail_agent versions of these verbs are set_task_perms(caller_perms()) and perform their operations on caller, which in turn is assumed to have done any necessary security checks.

<H2><A NAME="$mail_browser">$mail_browser</A></H2>

&nbsp;&nbsp;The $mail_browser is a web system tool for reading MOO mail
<BR>folders.It has two customizable properties on it:

<P>&nbsp;&nbsp;&nbsp;The "headerlist_len" property is the length of the headers list
<BR>&nbsp;displayed when someone browses a folder.

<P>&nbsp;&nbsp;&nbsp;The "guest_subscribed_folders" is the list of mail folders (as a
<BR>&nbsp;LIST of OBJ numbers) that guest and anonymous web users are shown as
<BR>&nbsp;their "subscribed" folders.  They can access the others (that are
<BR>&nbsp;public) through the "list all folders" link, but this is basically

<H2><A NAME="$mail_recipient">$mail_recipient</A></H2>

Generic Mail Recipient
<BR>----------------------
<BR>A "mail recipient" is, by definition, an object that can be sent mail.
<BR>Mail recipients must either be character objects or descendants of $mail_recipient.

<P>One source of confusion is that the terms "mail recipient", "mail folder", "mailing list", and "mail collection" really all refer to the same kind of object.  It so happens that $mail_recipient serve several distinct functions and we tend to use whatever term happens to best match the application under discussion, e.g., it's a "mailing list" if we're playing with its .mail_forward property but it's also a "mail folder" if we're examining the messages that have been saved in it.

<P>Note that, by default, a freshly created recipient is accessibly only by you.  If you wish to make a publically accessible recipient, set .readers=1.  Furthermore, if you want to allow a message on your recipient to be removed by its sender without your intervention, set .rmm_own_msgs=1.  Finally, in order for other people to be able to refer to your recipient by name, the object must reside in $mail_agent.  $mail_agent will not accept the object unless it has an actual description and a name distinct from all other mail recipient names/aliases.

<P>Topics:

<P>&nbsp;&nbsp;<A HREF="core_help.html#MR-access">MR-access</A>       -- controlling read, write and send access to a recipient
<BR>&nbsp;&nbsp;<A HREF="core_help.html#MR-naming">MR-naming</A>       -- naming conventions and how to match on recipient names
<BR>&nbsp;&nbsp;<A HREF="core_help.html#MR-sequences">MR-sequences</A>    -- message sequence arguments to $mail_recipient verbs
<BR>&nbsp;&nbsp;<A HREF="core_help.html#MR-reading">MR-reading</A>      -- reading messages/headers on recipients
<BR>&nbsp;&nbsp;<A HREF="core_help.html#MR-searching">MR-searching</A>    -- searching message lists for patterns in certain fields
<BR>&nbsp;&nbsp;<A HREF="core_help.html#MR-writing">MR-writing</A>      -- removing and renumbering messages
<BR>&nbsp;&nbsp;<A HREF="core_help.html#MR-subscribing">MR-subscribing</A>  -- updating .mail_forward, .mail_notify 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and the story of .current_message
<BR>&nbsp;&nbsp;<A HREF="core_help.html#MR-setup">MR-setup</A>        -- Setting or changing the configuration for a mail recipient

<H2><A NAME="$manager">$manager</A></H2>

&nbsp;&nbsp;The $manager class confers various near-wizardly abilities and
<BR>responsibilies.  These are listed in $manager.abilities, along with
<BR>the property name on $manager that controls them.  A given Manager
<BR>may have any or none of the various abilities that can be conferred.
<BR>The primary tool for creating and managing Managers is the @manager
<BR>command.
<BR>&nbsp;&nbsp;The ability of Managers to actually function is dependent on the
<BR>system they control actually granting that ability.  Generally, the
<BR>system should check if the person has their manager property set and
<BR>if the property conferring the specific ability is also set.  This is
<BR>properly accomplished by calling
<BR>&nbsp;&nbsp;$perm_utils:manager_controls(who OBJ, activity STR)
<BR>to check if `who'  has permission for `activity' where `activity' is
<BR>actually the name of the relevent property on $manager.
<BR>&nbsp;&nbsp;Managers, like wizards, are protected from being booted if idle
<BR>longer than the $local.idle_limits values.

<P>Some Manager commands may be available to all managers, irregardless
<BR>of their assigned responsibilities.

<P><B>Related Topics:</B>
<BR><A HREF="wiz_help.html#@manager">@manager</A> -- wizardly command for managing Managers

<H2><A NAME="$map">$map</A></H2>

The $map is used to store ASCII art maps of various sites in the MOO.
<BR>Users can always type "map &lt;map name&gt;" to get a map for the &lt;map
<BR>name&gt; area, or just "map" to get a general map for the MOO.

<P>This system will eventually be adjusted to supply location-sensitive
<BR>maps, keyed to the user's location, but for now using "map" alone
<BR>returns the map in the "text" property of $map.  It will also be
<BR>integrated with the $domain system.  the MOO in general.

<P>Using "@edit map" edits the main map, which is returned when someone
<BR>just types "map" without specifying any particular one.  Other maps
<BR>are entered as properties on the $map object, with the property name
<BR>as the name of the map to the map library.  To add a new map, you
<BR>can:

<P>&nbsp;&nbsp;@addmap &lt;note&gt; to $map

<P>where &lt;note&gt; is any $note whose text is the ASCII art map that should
<BR>be added.  After entering the command, you'll be prompted for the
<BR>name of the map, which should have no spaces in it.

<H2><A NAME="$new_player_log">$new_player_log</A></H2>

A $biglist with an entry for every character created in the MOO.  You can use @mail to search the listing with the following key-expresions:

<P>from:&lt;who&gt;  -  created by &lt;who&gt;
<BR>subject:&lt;who&gt; - character created named &lt;who&gt;
<BR>body:&lt;email&gt; - posting for person with given &lt;email&gt;

<H2><A NAME="$new_prog_log">$new_prog_log</A></H2>

A $biglist with an entry for every progbit set in the MOO.  You can use @mail to search the listing with the following key-expresions:

<P>from:&lt;who&gt;  -  progbit set by &lt;who&gt;
<BR>subject:&lt;who&gt; - progbit set on character named &lt;who&gt;

<H2><A NAME="$news">$news</A></H2>

The News Article Database ($news) features a couple of verbs for
<BR>adding or removing news items to/from it.  If you want to add news to
<BR>the database, you must have added $news to your list of features
<BR>(@addfeature $news), then follow these steps:

<P>1.  @create $news_item called &lt;whatever&gt;
<BR>2.  @edit &lt;whatever&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(compose the body of the news item and save it
<BR>3.  @announcement &lt;whatever&gt; is &lt;message displayed to users at login&gt;
<BR>4.  @addnews &lt;whatever&gt;

<P>The @addnews command moves the news item to the News Article Database
<BR>($news), and announces the new news item to all connected users.

<P>Note that if you edit a news item that has previously been added to
<BR>the news database (with @addnews) and save the changes, the news item
<BR>will be considered `fresh out of the press' once again, and announced
<BR>to everyone all over again.  You can use `@contents $news' to see
<BR>what news item objects are currently published.

<P>News articles are note objects, made from the Generic News Item ($news_item).

<P>Below is a brief description of the two user-verbs associated with $news.

<P>$news:@addnews
<P><TABLE BORDER=0><TR><TD VALIGN="TOP"><B>Syntax:</B></TD><TD VALIGN="TOP">  @addnews &lt;news&gt;
<BR>Add &lt;news&gt; to the news article database ($news).
<BR>&lt;news&gt; should be a child of the $new_item (the Generic News Item)</TD></TR></TABLE>

<P>$news:@rmnews
<P><TABLE BORDER=0><TR><TD VALIGN="TOP"><B>Syntax:</B></TD><TD VALIGN="TOP">  @rmnews &lt;news-index&gt;
<BR>Remove &lt;news-index&gt; from the news article database ($news).</TD></TR></TABLE>
&lt;news-index&gt; is the news article number, from the `news' listing.

<H2><A NAME="$no_one">$no_one</A></H2>

$no_one
<BR>-------
<BR>..is a powerless character.  It owns no objects, not even itself; nor it own any verbs.  It is, however, a programmer and thus may use eval().
<BR>In fact his sole purpose is to evaluate questionable code.
<BR>`questionable' could be in either or both of the following senses

<P>(1) Its origin is sufficiently uncertain so that there is no obvious way of deciding whose permissions it should run under.
<BR>(2) The code itself is potentially malicious, i.e., to the extent that one does not want to be evaluating it using one's own permissions.

<P>set_task_perms($no_one);  is thus the canonical idiom in wizard code for rendering anything that follows mostly harmless.  For use by ordinary programmers, we have:

<P>&nbsp;&nbsp;&nbsp;&nbsp;$no_one:eval(string)

<P>which attempts to evaluate an arbitrary string using $no_one's permissions.
<BR>string is either an expression or ";" followed by one or more statements, of which the final semicolon may be omitted.  return values are what eval() would return (either {1,value} or {0,@error_messages}).

<H2><A NAME="$object_quota_utils">$object_quota_utils</A></H2>

This is the default package that interfaces to the $player/$prog
<BR>quota manipulation verbs.

<P>To set the initial amount of object quota people have, set the
<BR>following properties:
<BR>&nbsp;&nbsp;$object_quota_utils.default_player_quota
<BR>&nbsp;&nbsp;$object_quota_utils.default_builder_quota
<BR>&nbsp;&nbsp;$object_quota_utils.default_programmer_quota
<BR>using "@set $object_quota_utils.default_player_quota to 0" for
<BR>instance. To be extra cautious, you should set the same values on
<BR>each character class generic:
<BR>&nbsp;&nbsp;$player.ownership_quota
<BR>&nbsp;&nbsp;$builder.ownership_quota
<BR>&nbsp;&nbsp;$builder.ownership_quota
<BR>&nbsp;&nbsp;$prog.ownership_quota

<P>See `help $byte_quota_utils' for information about byte-based quota.

<H2><A NAME="$player_db">$player_db</A></H2>

Database of Users
<BR>-------------------
<BR>This is an instance of the Generic Database ($generic_db) that
<BR>holds the {name/alias,#objectid} pairs for every 
<BR>name and alias of every character object in the MOO.

<P>Commands availble are:

<P>look $player_db
<BR>&nbsp;&nbsp;Shows when the last check and last load were performed.

<P>@check $player_db
<BR>&nbsp;&nbsp;Checks the database for recycled or @toad'ed characters and removes
<BR>them.

<P>@reload $player_db
<BR>&nbsp;&nbsp;Completely clears and reloads the $player_db with all currently
<BR>valid character's names and aliases.

<P>Executable verbs supplied include

<P>&nbsp;&nbsp;:find(string)        =&gt; character obj or $ambiguous_match or $failed_match
<BR>&nbsp;&nbsp;:find_exact(string)  =&gt; character obj or $failed_match (does not do partial matches)
<BR>&nbsp;&nbsp;:find_all(string)    =&gt; list of all matching registered characters

<P>&nbsp;&nbsp;:insert(string, who) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;records that string is now a name or alias of &lt;who&gt;
<BR>&nbsp;&nbsp;:delete(string) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;removes string from the db
<BR>&nbsp;&nbsp;:available(string)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns 1 if string is available as a character name or alias,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;an object if string is in use, or 0 if string is otherwise unavailable.
<BR>&nbsp;&nbsp;:load()
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resets the db, inserting all current registered character names and aliases.  The time() of the last load is stored in $player_db.last_load
<BR>&nbsp;&nbsp;:check()
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checks for recycled and toaded players that managed not to get
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expunged from the db.  The time() of the last check is stored in $player_db.last_check

<P>The internal representation and all of the above verbs (except :load() and
<BR>:available()) are as described for $generic_db.

<P>It should be noted that for any application that involves resolving a character name from a command line, you should be using $string_utils:match_player() rather than $player_db:find(), since the former will deal correctly with other ways of referring to people apart from their names and aliases (e.g., literal object numbers, "me", "$no_one"...).

<P>:load() needs to be done periodically as it is possible for the $player_db 
<BR>to get out of synch with reality.  In particular, there is currently no way
<BR>to block someone writing his own character's :recycle() verb that neglects to 
<BR>remove that person's names from the $player_db.

<P>While a :load() is in progress the .frozen property is set to 1 to indicate that any results of :find*() are not to be trusted.

<H2><A NAME="$recycler">$recycler</A></H2>

$recycler
<BR>=========

<P>Rather than having the server built-in recycle() and create() functions handle the creation and destruction of objects, a recycling center has been created to simulate these actions by  changing objects that would have been recycled into children of $garbage (The Generic Garbage Object) and making them owned by Hacker, and then when they're needed again, to avoid a raw create() command, those objects are given to whoever's asking for them.

<P>Most Useful Verbs
<BR>-----------------

<P>$recycler:_recycle( object )
<BR>&nbsp;&nbsp;This will effectively recycle an object. (As a point of fact, it changes ownership of the object to Hacker and makes the object a child of $garbage.)  It handles .ownership_quota and .owned_objects properly.  Generally, use this instead of a recycle() in your verbs.

<P>$recycler:_create( parent object [ , new owner object ] )
<BR>&nbsp;&nbsp;This effectively creates an object (with the specified parent, if possible, and with the specified owner, if possible; these are the same restrictions as on the server create() builtin).  This is what should generally be used instead of create() in your programming.

<P>$recycler:valid ( object )
<BR>&nbsp;&nbsp;This is a variant of the server built-in valid() except that it handles the $garbage objects as well.  It returns a 1 if the object specified -is- valid and is -not- a $garbage object.

<P>Other Notes
<BR>-----------

<P>request &lt;object&gt; from &lt;recycler&gt;
<BR>&nbsp;&nbsp;This is not an internal verb (it's !x).  It is, however, a command-line verb that can be used to request a specific object from the recycler.  It's also useful for the creation of objects like a Magic Number Repository.  When the object is removed from the recycler, the .announce_removal_msg is announced to the room if it's set (it's piped through $string_utils for pronoun substitution).
<BR>NOTE: This verb has been disabled from the original LambdaCore version.  See $recycler:take_object instead.

<P>show-history &lt;recycler&gt;
<BR>&nbsp;&nbsp;This is a wizardly verb which allows wizards to check the `history list' of the recycler. The history maintains the latest ($recycler.nhist) entries.

<P>$recycler.orphans
<BR>&nbsp;&nbsp;This maintains a list of objects for which the recreation process got mangled. It ought to be checked every once in a while to see what's up.

<P>@clear-orphans from &lt;recycler&gt;
<BR>This command will step you through each item in &lt;recycler&gt;.orphans, providing information and making a recommendation about how to deal with that object.  It also allows you to remove the item from the list.

<H2><A NAME="$registration_db">$registration_db</A></H2>

The $registration_db stores the e-mail address for every character
<BR>ever registered in the MOO.  It provides a variety of verbs for
<BR>specialized searching of the database, as well as the usual
<BR>$generic_db search tools.  It also has a custom :add verb that allows
<BR>a comment to be associated with the address along with the character
<BR>object number.

<P>Executable verbs are:

<P>add(who OBJ, email STR, comment STR) -&gt; none
<BR>&nbsp;&nbsp;Add a new character email registration.

<P>find(email STR) -&gt; { {who OBJ [,comment STR]}, ...}
<BR>&nbsp;&nbsp;Returns a list of character object numbers (with associated
<BR>comment, if any), that have been associated with the specified
<BR>`email' address.  Note that some may correspond to characters that
<BR>have been recycled.  Returns $failed_match if no match, or
<BR>$ambiguous_match if the `email' is a prefix for more than one
<BR>registered email address..

<P>find_exact(email STR)
<BR>&nbsp;&nbsp;Like :find but returns list of characters that match or
<BR>$failed_match (nerver $ambiguous_match).

<P>find_all(email STR)
<BR>&nbsp;&nbsp;Like :find but returns all registered entries with addresses for
<BR>which `email' is a prefix.  Note that only searching by userid is
<BR>really an appropriate use for this.  Use :suspicious_address for a
<BR>method that properly examines the internet address structure.

<P>suspicious_address(email STR) -&gt; {email STR, ...}
<BR>&nbsp;&nbsp;Returns a list of email addresses that are related to the specified
<BR>one, suggesting they may belong to the same person.  For instance,
<BR>searching for "person@school.edu" will also match
<BR>"person@node.school.edu".

<P>suspicious_userid(userid STR) -&gt; BOOL
<BR>Return true if userid is root or postmaster or something like that.

<P>describe_registration(find_result LIST) -&gt; description LIST
<BR>Accepts the successful results of one of the :find verbs, and returns
<BR>a list of strings giving a plain language description of the
<BR>information.
<BR>Each line has the form:
<BR>&nbsp;&nbsp;&lt;character&gt; (&lt;objnum&gt;) current email: &lt;email&gt; [&lt;comment&gt;]

<H2><A NAME="$request_booth">$request_booth</A></H2>

&nbsp;&nbsp;Here are the 4 user-verbs of the Character Request Booth which
<BR>wizards that have $request_booth added as a feature can use to   The
<BR>$request_booth is the room where guests and VSPO's using the @request
<BR>command are taken so that they can fill out the application
<BR>undisturbed.  Wizards can change the application by adding the
<BR>$request_booth as a feature, then using the commands described below.
<BR>display and rearrange questions of the character request form.

<P>$request_booth:@addq*uestion
<P><TABLE BORDER=0><TR><TD VALIGN="TOP"><B>Syntax:</B></TD><TD VALIGN="TOP">  @addq*uestion &lt;subject&gt;</TD></TR></TABLE>

<P>Adds a question about &lt;subject&gt; to the character application for
<BR>guests or VSPOs. The verb prompts you for the exact wording of the
<BR>question and a string that will appear as an entry-prompt (the words
<BR>you see in the first half of the standard [] prompt).

<P>$request_booth:@removeq*uestion @rmq*uestion
<P><TABLE BORDER=0><TR><TD VALIGN="TOP"><B>Syntax:</B></TD><TD VALIGN="TOP">  @removeq*uestion &lt;subject&gt;</TD></TR></TABLE>

<P>Get rid of the question for &lt;subject&gt; in the character application form for guests and VSPOs. If you aren't sure what subjects there are enter  '@listq subjects' and you'll get a list of them, complete with indices.

<P>$request_booth:@moveq*uestion
<P><TABLE BORDER=0><TR><TD VALIGN="TOP"><B>Syntax:</B></TD><TD VALIGN="TOP">  @moveq*uestion &lt;index1&gt; to &lt;index2&gt;</TD></TR></TABLE>

<P>Moves the question currently at position &lt;index1&gt; in the character
<BR>application for guests and VSPOs to the position &lt;index2&gt;.

<P>$request_booth:@listq*uestions
<P><TABLE BORDER=0><TR><TD VALIGN="TOP"><B>Syntax:</B></TD><TD VALIGN="TOP">  @listq*uestions [&lt;subject&gt;|&lt;index&gt;|subjects|all]</TD></TR></TABLE>

<P>This verb allows you to view those questions contained in the
<BR>character application form for guests and VSPOs.

<P>Args: 'all'|&lt;none&gt; to see a list of subjects and corresponding questions
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;subject&gt;|&lt;index&gt; list the question and prompt for a specific subject.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'subjects' list question subjects and their indices.

<P>The following additional properties are defined on the $request_booth
<BR>and should be appropriately customized using the @edit command (e.g.
<BR>@edit $request_booth.introduction_msg):

<P>$request_booth.introduction_msg
<BR>$request_booth.vspo_introduction_msg
<BR>&nbsp;&nbsp;One of these messages is displayed to the applicant when they use
<BR>&nbsp;&nbsp;&nbsp;&nbsp;the @request command and are moved into the $request_booth.  If
<BR>&nbsp;&nbsp;&nbsp;&nbsp;they are a VSPO applying for a regular character, they see the
<BR>&nbsp;&nbsp;&nbsp;&nbsp;vspo_introduction_msg, else they see the introduction_msg.  It
<BR>&nbsp;&nbsp;&nbsp;&nbsp;should explain that they are going to be asked some questions,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;and why.

<P>$request_booth.last_words
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Displayed after the person has completed the application, just
<BR>&nbsp;&nbsp;&nbsp;&nbsp;before they are returned to the room they came from.  It should
<BR>&nbsp;&nbsp;&nbsp;&nbsp;give the person some idea when they can expect to hear from you.

<H2><A NAME="$room">$room</A></H2>

The Generic Room ($room)
<BR>----------------

<P>(1)  Announcements

<P>:announce         (@text)         =&gt; broadcasts to all except `player'
<BR>:announce_all     (@text)         =&gt; broadcasts to all
<BR>:announce_all_but (objects,@text) =&gt; broadcasts to all except those in objects

<P>say, emote


<P>(2)  Command recovery

<P>:huh            (verb,args) - server hook: last chance to make sense of verb
<BR>:here_huh       (verb,args) - room's last attempt to parse something
<BR>:here_explain_syntax (this,verb,args) - attempts to explain usage of verb


<P>(3)  Residency

<P>free_home  - true =&gt; @sethome allows anyone to set his .home to be here
<BR>residents  - objects on this list may teleport in and/or set their homes here.

<P>:accept_for_abode(player) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; true if person should be allowed to set .home to this room.

<P>@resident*s


<P>(4)  Looking

<P>dark  - true =&gt; contents are not visible
<BR>ctype - 1..4 for four different styles of .contents lists

<P>:match         (string)        =&gt; exit or object in room's .contents
<BR>:tell_contents (objects,ctype) - format objects according to ctype, tell `player'

<P>l*ook


<P>(5)  Entrance and exit.

<P>:accept (object) - Called by move() and :moveto() before an object enters a room, if false is returned, movement is prevented.  Protocol permits this verb to make noise (though this is discouraged) as this is the only place the room will learn the object's original location.

<P>:acceptable (object) - Called by verbs which wish to check whether movement will be possible.  Protocol prohibits this verb from making noise and requires it to return the same value as :accept would for the same arguments.

<P>:is_unlocked_for (object) - interface with the @lock protocol.  Returns true or false depending on the state of locks for the object with the room.  Other things may prevent entrance even if this returns true.  Protocol prohibits this verb from making noise. 

<P>:enterfunc (object) - called after entrance has succeeded.  Noise is fine.

<P>:exitfunc (object) - called after an object has successfully left.  Noisemaking is fine.

<P>(6)  Topology and Movement via Exits

<P>See `help $exit' for an explanation of how the generic $exit works.

<P>free_entry     - true  =&gt; `teleporting' in is allowed
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false =&gt; only residents may teleport in
<BR>exits          - list of invokable exits leading from this room
<BR>entrances      - list of recognized exits leading to this room
<BR>blessed_object - object currently entering via an exit
<BR>blessed_task   - task_id for entering object

<P>:match_exit      (string) =&gt; exit whose name matches string
<BR>:bless_for_entry (object) - set up room to accept object arriving from entrance
<BR>:add_exit        (exit)
<BR>:add_entrance    (exit)
<BR>:remove_exit     (exit)
<BR>:remove_entrance (exit)

<P>e/east/w/west/s/south/n/north/ne/northeast/nw/northwest/se/southeast/sw/southwest/u/up/d/down, go, @add-exit, @add-entrance, @remove-exit, @remove-entrance, @exits, @entrances 


<P>(7)  Ejection

<P>victim_ejection_msg/oejection_msg/ejection_msg
<BR>:*_msg()  messages

<P>@eject


<H2><A NAME="$section_editor">$section_editor</A></H2>

The Section Editor is basically exactly like the Text Editor (aka Note Editor) in its operation and commands, except that instead of being designed to work on note objects or object properties, it has been designed to edit more arbitrary "sections" of objects.

<P>A "section" can be defined by an object's programmer to be any bit of text associated with that object which might be appropriate for editing, such as chapters in a book or notices on a notice board, which aren't necessarily directly associated with individual properties on that object.  It is intended to be called via $player:@edit with the syntax '@edit &lt;object&gt;|&lt;section&gt;' (i.e. '@edit book|1', for chapter 1 of a book named "book").

<P>Pretty much any generic which is appropriate can be easily modified to take advantage of this editor simply by providing the following verbs:

<P>:get_section(&lt;section-name&gt; [,&lt;test&gt;]) - Retrieve the text of a section identified by the string &lt;section-name&gt;.  If no such section exists, this verb should return E_INVARG instead.  the second parameter (&lt;test&gt;), if supplied, is a boolean value indicating that the call to this verb is only to determine whether such a section exists, and the actual text need not be returned (this type of call is used by the Section Editor to determine whether a section is valid before actually invoking the editor.  Most applications can ignore any second argument.  Indication is given simply in case a particular implementation involves a lot of processing or time-consuming operations to obtain the actual text of a section)

<P>:set_section(&lt;section-name&gt;, &lt;text&gt;) - save new text for the section &lt;section-name&gt;.  Implementations should check the type of the &lt;text&gt; parameter if it is important, as the Section Editor (like the Text Editor) can operate in either "string" or "list" mode.

<P>(optional) :section_msg(&lt;section-name&gt;) - Return a string indicating the appropriate way to refer to &lt;section-name&gt;.  If this verb is not present, a string of the form "section &lt;section-name&gt;" is used.  (for example, a book's :section_msg verb might return a string of the form "chapter &lt;chapter-number&gt; (&lt;heading&gt;)" instead of the default, providing a more informative and descriptive identificaiton of what's being edited.)

<P>(Note: All calls to :get_section and :set_section are made with caller_perms() set to the player who's doing the editing.)

<H2><A NAME="$site_db">$site_db</A></H2>

Database of places
<BR>------------------
<BR>i.e., places people have connected from.

<P>&nbsp;&nbsp;:add(sitename, who)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;records the fact that character connected from sitename.
<BR>&nbsp;&nbsp;:load()
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clears the db and reloads all of the character connection info.

<P>&nbsp;&nbsp;.domain
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default domain for unqualified sitenames given to :add.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<BR>For each domain we keep a list of characters and subdomains. 
<BR>For example, :add("doc.ic.ac.uk",#666) enters #666 on the lists for "doc.ic.ac.uk", and, if we have to create an entry for "doc.ic.ac.uk", we enter "doc" on the list for "ic.ac.uk", "ic" on the list for "ac.uk", etc....  In this case, :find("ic") will return the "ic.ac.uk" list if there is no other domain in $site_db starting with "ic".  Note that the "ic.ac.uk" list may contain both objects, i.e., namely people that have connected from the site "ic.ac.uk", and strings, i.e., subdomains of "ic.ac.uk" like "doc".

<P>&nbsp;&nbsp;:find_exact(string)    =&gt; character/subdomain list or $failed_match
<BR>&nbsp;&nbsp;:find_all_keys(string) =&gt; list of all domains that begin with string
<BR>&nbsp;&nbsp;:find_key     (string) =&gt; unique domain that begins with string, 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ambiguous_match or $failed_match

<P>The other $generic_db functions (:find, :find_all) are also available, though admittedly less useful.

<H2><A NAME="$standard_webviewer">$standard_webviewer</A></H2>

&nbsp;&nbsp;The $standard_webviewer is provided to serve as a major interface
<BR>for people using the web interface to access the MOO's multimedia
<BR>information.  Other such interfaces may be created and used, and even
<BR>set to be the standard webviewer themselves, but the BioGate System
<BR>comes with this viewer that you can use immediately.  Note that users
<BR>can select a different default web viewer application to be used with
<BR>their character the "viewer" @weboption.
<BR>&nbsp;&nbsp;The $standard_webviewer is different from the $anon_webviewer in
<BR>that the latter may be used by people without any telnet connection
<BR>into the MOO, who are essentially browsing anonymously.  The
<BR>$standard_webviewer may only be used by people connected by telnet to
<BR>a MOO character.  The reason is that the MOO is a self-contained
<BR>world, and people using it expect changes in the world to be due to
<BR>people or automatec processes within that world.  Therefore,
<BR>unattributed transactions like those from the web without a matching
<BR>telnet connection, are restricted.  People without registered
<BR>characters can use the $standard_webviewer by connecting to a guest
<BR>character, thereby giving themselves a "presence" within the VR
<BR>world.  The $standard_webviewer extends the simple browsing with the
<BR>ability to move the user's MOO character, communicate with others,
<BR>and manipulate MOO objects, all through the web interface.

<P>&nbsp;&nbsp;The $standard_webviewer is called by $http_handler:process through
<BR>the usual indentification of the ".code" property, which is "viewer"
<BR>by default.  The :method_get (or :method_post) verb is called with
<BR>args {who, what OBJ, rest STR, search STR, form STR}, where "what" is
<BR>the object to be viewed.  If no object is specified, the user's
<BR>location (player.location) is assumed.  Note that authentication is
<BR>performed earlier by the $http_handler, which sets the "player" value
<BR>before the call.  The :method_get verb builds the various portions of
<BR>the final web page, then combines them and returns the text and a
<BR>title for the web window ({title STR, text LIST}).
<BR>&nbsp;&nbsp;The :method_post verb is only called when the user selects an item
<BR>on the optional "command form" that may be included in the basic web
<BR>page by the "commandform" web option, if the user chooses.

<P>&nbsp;&nbsp;The components of the web page are assembled as follows:
<BR>1. If there are option toggles, indicated by flanking "+" symbols in
<BR>&nbsp;&nbsp;&nbsp;the "rest" portion, these are used to set user display options.
<BR>2. The "focus" object's HTML text is retrieved by a call to
<BR>&nbsp;&nbsp;&nbsp;what:html(rest, search, line).  If the value returned is a list
<BR>&nbsp;&nbsp;&nbsp;of STRings, it is assumed to be an HTML text fragment.  If it is
<BR>&nbsp;&nbsp;&nbsp;in the form {where OBJ, what OBJ} then it is a redirection to a
<BR>&nbsp;&nbsp;&nbsp;new "what" with a new base location (replacing
<BR>&nbsp;&nbsp;&nbsp;"player.location"), and the new what:html() is called without
<BR>&nbsp;&nbsp;&nbsp;additional arguments.  The inability to redirect the
<BR>&nbsp;&nbsp;&nbsp;rest/search/form arguments is for security purposes.  A maximum
<BR>&nbsp;&nbsp;&nbsp;of four redirections is permitted.    If what:html() returns the
<BR>&nbsp;&nbsp;&nbsp;value $nothing, then "what" and "where" are set to
<BR>&nbsp;&nbsp;&nbsp;"player.location" and a fresh call (without args) to what:html()
<BR>&nbsp;&nbsp;&nbsp;is performed.
<BR>3. The attributes to be inserted into the page's &lt;BODY&gt; tag are
<BR>&nbsp;&nbsp;&nbsp;retrieved from web setting named "bodytag_attributes" if one is set
<BR>&nbsp;&nbsp;&nbsp;[what:get_web_setting()].  Also, the "hide_banner" web setting is
<BR>&nbsp;&nbsp;&nbsp;checked for.
<BR>4. The "button bar" is generated by a call to
<BR>&nbsp;&nbsp;&nbsp;player:web_viewer_buttons(viewer.code STR, what OBJ).
<BR>5. A map is inserted if the "map" web option has been set, which is
<BR>&nbsp;&nbsp;&nbsp;generated by $teleporter:html(who, 0, 0).
<BR>6. The "You are at" and "examining...&lt;what&gt;" lines are generated as
<BR>&nbsp;&nbsp;&nbsp;links to the $object_browser view of the given objects.
<BR>7. The list of exits is generated by
<BR>&nbsp;&nbsp;&nbsp;$standard_webviewer:generate_exitlist(where).
<BR>8. A list of carried object is included if the "inv" web option is
<BR>&nbsp;&nbsp;&nbsp;set, generated by $web_utils:list_english_list_with_urls(player OBJ,
<BR>&nbsp;&nbsp;&nbsp;viewer.code STR, objects LIST).
<BR>9. The "command form" is generated if the "commandform" web option is
<BR>&nbsp;&nbsp;&nbsp;set, and generated by $standard_webviewer:command_form().
<BR>10. An &lt;EMBED&gt; portion for the VRML view is included if the
<BR>&nbsp;&nbsp;&nbsp;"embedVRML" web option is set, generated by
<BR>&nbsp;&nbsp;&nbsp;$standard_webviewer:embedVRML(what).
<BR>11. Finally, the fragments are assembled in the appropriate order and
<BR>&nbsp;&nbsp;&nbsp;the complete web page body is returned to the $http_handler.

<H2><A NAME="$std_vrml10viewer">$std_vrml10viewer</A></H2>

The $std_vrml10viewer is a webapp that displays a static VRML/1.0
<BR>view of a given room.  Although it will pass VRML/2.0 information, it
<BR>doesn't have any facilities for live VRML display control.  It does
<BR>dynamically create the room view, though, so the returned VRML file
<BR>describes the room at the moment of the request.

<P>It is usually invoked with a URL in the form:

<P>&nbsp;&nbsp;http://moo.site.org:8000/99anon/vrml10/5555/room.wrl

<P>Where "anon" specifies an unauthenticated transaction, "5555" is the
<BR>room or other object whose VRML description will be returned, and
<BR>"room.wrl" is appended for web browsers that use the file extension
<BR>instead of the MIME information in the HTTP header to determine
<BR>processing.  All HTP/1.0 transactions processed by the
<BR>$std_vrml10viewer are of "x-world/x-vrml" MIME type.

<P>The transactions follow the general form:

<P>$http_handler
<BR>&nbsp;&nbsp;&nbsp;A
<BR>&nbsp;&nbsp;&nbsp;|
<BR>&nbsp;&nbsp;&nbsp;V
<BR>$std_vrml10viewer:method_get
<BR>&nbsp;&nbsp;&nbsp;A
<BR>&nbsp;&nbsp;&nbsp;|
<BR>&nbsp;&nbsp;&nbsp;V
<BR>&lt;room&gt;:get_vrml &lt;-&gt; .vrml_interior_desc
<BR>&nbsp;&nbsp;&nbsp;A
<BR>&nbsp;&nbsp;&nbsp;|  The room retrieves the VRML file fragment for each
<BR>&nbsp;&nbsp;&nbsp;|  object inside, and adds cameras for each child
<BR>&nbsp;&nbsp;&nbsp;|  of $player.  It also adds a standard "to web page" link
<BR>&nbsp;&nbsp;&nbsp;|  and a "to outside room" link of the room is "interior."
<BR>&nbsp;&nbsp;&nbsp;|
<BR>&nbsp;&nbsp;&nbsp;V
<BR>&lt;objects&gt;:get_vrml() &lt;-&gt; :get_vrml_desc
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:get_vrml_translation
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:get_vrml_rotation
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:get_vrml_scale

<P>Key data is stored on #1.vrml_desc, #1.vrml_coords, and
<BR>#1.vrml_settings.  The first is a list of strings, comprising the
<BR>VRML file fragment describing the object's structure.  The vrml_settings contains various VRML-related settings that are specific to the room.  See the help text for "@set-vrml" to see which are currently defined for all rooms.

<P>The vrml_coords property has the form:
<BR>&nbsp;&nbsp;&nbsp;&nbsp;{ {NUM, NUM, NUM}, {NUM, NUM, NUM}, {NUM, NUM, NUM} }
<BR>Where the first triplet is the XYZ translations from the room's
<BR>origin in milliunits, the second set is the XYZ rotations from the
<BR>origin in millirads, and the third set is the XYZ scaling in
<BR>milliunits.  This allows a minimum translation of 1 milliunit and a
<BR>maximum of2147483.  In most cases, a VRML unit is perceived as about
<BR>.75 meters, giving a translation range between .75 mm and 1612 km.

<H2><A NAME="$teleporter">$teleporter</A></H2>

The General Teleporter ($teleporter) is a set of utilities for
<BR>teleporting users that consolidates all message display and other
<BR>functions. It is used by the BioGate System for teleporting users who
<BR>jump using the MOO's web system.

<P>The main verbs on the $teleporter are:

<P>$teleporter:teleport_user(who OBJ, where OBJ [, @ optional messages])

<P>This is the non-web utility for moving characters, and performs all
<BR>appropriate testing of if the character was successfully moved and
<BR>presenting appropriate messages to their former and subsequent
<BR>location.  If no optional messages are given, then those on the
<BR>character or the $teleporter are used as needed.  See the help for
<BR>$teleporter:teleport_user for details of the optional messages.

<P>$teleporter:move_user_for_web(who OBJ, where OBJ)

<P>This verb performs user character movement for the web system,
<BR>including the VRML system.  It is not generally used by other
<BR>systems, which should use $teleporter:teleport_user instead.

<P>There are several properties on the $teleporter, some of which are
<BR>important for the web system.

<P>.image_map  -  A STR with the URL of the MOO's default image map,
<BR>presented as part of the Web Viewer page if no room enclosing the
<BR>character has its own image_map property.

<P>.imagemap_regions  -  A LIST in the form used by
<BR>$web_utils:interpret_map that divides the graphic given by the
<BR>image_map property into selectable regions.

<P>.imagemap_rooms  -  A LIST of OBJ's, with each object a room
<BR>corresponding to the indexed region in the imagemap_regions property
<BR>(ie. the first room given is the place to move users who select the
<BR>first region specified in imagemap_regions).

<P>.central_room  -  An OBJ specifying where the "center" of the MOO is.
<BR>This is used by some Web Viewers to present a button that returns
<BR>people to the MOO's center.  Set to #11 by default, and generally
<BR>equal to $player_start.

<P>default_mapsize  -  A LIST in the form {NUM, NUM} cotaining the
<BR>{length, width} in pixels of the image specified by the "image_map"
<BR>property.  Some web viewers will force all image maps to this size,
<BR>which helps keep the display consistant.  Note that if your map does
<BR>not conform to this size, the regions in the imagemap_regions may not
<BR>be correctly selected.

<H2><A NAME="$vspo_registry">$vspo_registry</A></H2>

The VSPO Registry is the main database for information regarding the VSPO system.  It is generally accessed using the $vsfo Feature Object.

<P>Customizable properties:

<P>.recycle_age
<BR>.max_quota
<BR>.expire_email_txt
<BR>.keepowned_expire_email_txt
<BR>.first_warning_time 
<BR>.second_warning_time 
<BR>.student_expire_mail_txt
<BR>.last_warning_txt
<BR>.admin_mail_recipient
<BR>.default_expiration_duration
<BR>.student_expire_confunc_text
<BR>.default_FOs 
<BR>.groupowner_advance_time
<BR>.groupowner_advance_txt 
<BR>.groupowners_visible

<P>Structure of $vspo_registry.groups is:

<P>.groups[group][1]    OBJ group owner
<BR>.groups[group][2]    STR group name
<BR>.groups[group][3]    LIST group VSPO members {OBJ, OBJ, ...}
<BR>.groups[group][4]    INT expiration date in time() format
<BR>.groups[group][5]    LIST group non-owner controllers {OBJ, OBJ, ...}
<BR>.groups[group][6]    LIST group flags {STR, STR, ...}
<BR>.groups[group][7][1] INT creation date in time() format
<BR>.groups[group][7][2] OBJ group creator
<BR>.groups[group][7][3] LIST group description {STR, STR, ...}
<BR>.groups[group][7][4] STR type of class
<BR>.groups[group][7][5] STR group charge type
<BR>.groups[group][7][6] STR group suffix

<H2><A NAME="$webapp">$webapp</A></H2>

Web applications (child objects of $webapp) generate the text that is
<BR>returned as a result of an HTTP transaction.  For instance, the
<BR>webapp that creates the standard web page view of MOO rooms is the
<BR>$standard_webviewer, and the one that generates the VRML description
<BR>of rooms is the $std_vrml10viewer.  Other webapps perform tasks such
<BR>as user character customization, browsing and setting the
<BR>characteristics of objects, or reading the MOO's mail folders.  By
<BR>interposing webapps between the $http_handler and the general MOO
<BR>objects, functions are encapsulated in a way that 1. allows security
<BR>restrictions for broad functional catagories, 2. segregates the web
<BR>system into distinct parts, making debugging and extension of the
<BR>system easier.

<P>The webapp to use in a transaction is specified by the CODE portion
<BR>of the URL, given the general format:
<BR>&nbsp;&nbsp;http://HOSTNAME:PORT/xxWEBPASS/CODE/OBJECT/REST?SEARCH
<BR>The $http_handler:process verb determines which webapp is targeted by
<BR>checking the "code" property of each child of $webapp, and matching
<BR>the values.  Note that if you want to restrict valid webapps to only
<BR>first generation decendents of $webapp, you should modify the
<BR>appropriate lines in $http_handler:process and
<BR>$http_handler:provide_menu so that the list of valid webapps is
<BR>children($webapp) instead of $object_utils:descendents($webapp).

<P>Once the appropriate webapp has been identified, a call is made to
<BR>either its "method_get" or "method_post" verb, depending ont he type
<BR>of the transaction.  Webapps may have a single verb with both names
<BR>as aliases.  The call has the form:

<P>method_get(who, what, rest, search)
<BR>method_post(who, what, rest, search, line)

<P>where:
<BR>&nbsp;&nbsp;who    - originally set to `player' and now no longer used but
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;retained for backward compatability.
<BR>&nbsp;&nbsp;what   - the object specified as OBJECT in the URI, or #0 if the
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object is not valid.
<BR>&nbsp;&nbsp;rest   - The REST portion of the URI.
<BR>&nbsp;&nbsp;search - The SEARCH portion of the URI.
<BR>&nbsp;&nbsp;line   - The unparsed form line of a method POST transaction,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generally processed by the webapp with
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$web_utils:parse_form.

<P>The webapp is expected to use this information to create the text
<BR>that is the result of the HTTP transaction.  By default, the webapp
<BR>is expected to return the &lt;BODY&gt; portion of the text for an HTML
<BR>document, and the $http_handler:process verb adds the &lt;HEAD&gt; and
<BR>other information.  However, webapps listed in
<BR>$http_handler.exempt_from_pads are not treated this way, and the text
<BR>they return is directly sent to the transaction port.

<P>Webapps that return HTML document text should do so in the form:
<BR>&nbsp;&nbsp;{ "&lt;title&gt;", {&lt;lines of text&gt;} }
<BR>Where &lt;lines of text&gt; are the strings composing the HTML text, and
<BR>&lt;title&gt; is the title that will head the web browser's window.  See
<BR>the help for "$web_utils:format_webapp_result_to_html" for details of
<BR>the formats $http_handler:process will accept results in from a
<BR>webapp.

<H2><A NAME="admin-mail-recipts">admin-mail-recipts</A></H2>

The following mail-folders are part of the core.  Most are not
<BR>located in $mail_agent by default, so you must first subscribe to
<BR>them by object number before you can use the "*" prefix shortcut to
<BR>refer to them by name.

<P>*Player-Creation-Log ($new_player_log)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;A low-level record of all created MOO characters.  Not usually
<BR>&nbsp;&nbsp;&nbsp;&nbsp;someone one would subscribe to.
<BR>*New-Prog-Log ($new_prog_log)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Record of who's been given MOO programmer permissions.
<BR>*wizards ($system_mail_recipient)
<BR>&nbsp;&nbsp;For messages to and between MOO Wizard characters.  This mail
<BR>&nbsp;&nbsp;&nbsp;&nbsp;folder can be posted to but not read by the general MOO community.
<BR>*Quota-Log ($quota_log)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Record of whose quota has been changed and why.
<BR>*Site-Locks ($site_log)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Notes on annoying sites and user connection restrictions.
<BR>*tags ($tag_log)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;A database of tags.  Not normally accessed through the mail
<BR>&nbsp;&nbsp;&nbsp;&nbsp;system commands, although it's a child of $mail_recipient.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Administrators will want to subscribe to $witness_logs and not this.
<BR>*Helpful-People (&amp;helpful-people_list)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;A mailing list for issues relating to Helpful People and the
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Helpful Person System.  This is a public mail folder.
<BR>*VSPO-administration ($vspo_admin_list)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;A mailing list that receives administrative messages regrading
<BR>&nbsp;&nbsp;&nbsp;&nbsp;the VSPO system.
<BR>*account-locks ($account_locks)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;This logs various site and user connection restriction changes.
<BR>*undecided ($undecided)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;A temporary place for character applications still under
<BR>&nbsp;&nbsp;&nbsp;&nbsp;consideration.
<BR>*Character-Request-Pool ($request_pool)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Requests for MOO characters are sent here.
<BR>*Manager-Log ($manager_log)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;This mail folder records addition and removal of managerial
<BR>&nbsp;&nbsp;&nbsp;&nbsp;responsibilities for people of the $manager character class.
<BR>*created ($created_chars)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;This is a list of character applications that have been accepted.
<BR>*rejected ($rejected_chars)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;This is a list of character applications that have been rejected.
<BR>*witness-logs ($witness_logs)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Logs of guest witnessing are sent here after a guest boot, and
<BR>&nbsp;&nbsp;&nbsp;&nbsp;also registered user @witness'ing.
<BR>*Wiz-Projects (&amp;ProjectsList)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;A platform where updates regarding the progress of projects that
<BR>&nbsp;&nbsp;&nbsp;&nbsp;wizards are working on are pooled.  This system is working, but
<BR>&nbsp;&nbsp;&nbsp;&nbsp;still under development to extend it to Managers also.

<H2><A NAME="biogate-setup">biogate-setup</A></H2>

INITIALIZING AND CUSTOMIZING THE BIOGATE SYSTEM

<P>This text describes what properties need to be initialized after you
<BR>have installed the BioGate System in your MOO.  It provides a list of some
<BR>items you can customize.  A more detailed description of nearly every
<BR>property in the BioGate System can be found in the help texts
<BR>installed in $core_help for each of the BioGate System objects.  The
<BR>properties listed here are only the one's that must be customized for
<BR>the system to function properly, and for which setup instructions are
<BR>not given elsewhere in the installation package instructions.

<P>On $http_handler
<BR>----------------
<BR>lag_meter
<BR>&nbsp;&nbsp;Object number of a lag meter object, with a .samples property
<BR>&nbsp;&nbsp;listing recent lag values.  This object is common in MOOs, but if
<BR>&nbsp;&nbsp;you don't have one, this property can just be set to a #-1 value.

<P>gateway_html
<BR>&nbsp;&nbsp;A text displayed as the MOO's web gateway page if there is no FUP
<BR>&nbsp;&nbsp;system installed or no web/gateway.html file accessible.  See the
<BR>&nbsp;&nbsp;text of the sample gateway.html file for embedded comments
<BR>&nbsp;&nbsp;describing the contents of that page.

<P>webpass_handler
<BR>&nbsp;&nbsp;The object number of the Webpass Handler object installed with the
<BR>&nbsp;&nbsp;BioGate System.

<P>On $web_utils
<BR>-------------
<BR>page_banner
<BR>&nbsp;&nbsp;A fragment of HTML used to insert a "banner" across the top of each
<BR>&nbsp;&nbsp;web page the MOO generates.  This is NOT just a URL, but is a
<BR>&nbsp;&nbsp;compelte &lt;IMG&gt; tag.  The reason is that instead of just an image,
<BR>&nbsp;&nbsp;you may want to use an imagemap or something more complex as the
<BR>&nbsp;&nbsp;banner.  The entire value for this property is inserted into the
<BR>&nbsp;&nbsp;web page whole.

<P>interior_rooms
<BR>&nbsp;&nbsp;A list of object numbers for rooms that are "interior" or
<BR>&nbsp;&nbsp;"portable" (in the usual MOO lingo).  These are rooms with a verb
<BR>&nbsp;&nbsp;having the name or alias "exit" for which that command can be used
<BR>&nbsp;&nbsp;to exit the room into the enclosing room.  By knowing which rooms
<BR>&nbsp;&nbsp;have this feature, the Biogate System knows to add an "exit" link
<BR>&nbsp;&nbsp;to the list of exists displayed, even though the exit named "exit"
<BR>&nbsp;&nbsp;isn't generally displayed by the usual MOO $room exits listing.

<P>web_helppage
<BR>&nbsp;&nbsp;The URL for a "help page" for this MOO, which usually should have
<BR>&nbsp;&nbsp;instructions for new MOO users.

<P>MOO_home_page
<BR>&nbsp;&nbsp;The URL of the MOO's "home page," which can be different from its
<BR>&nbsp;&nbsp;web gateway page or identical.

<P>uparrow_icon
<BR>&nbsp;&nbsp;The URL for an icon embedded on web pages to indicate "go to the
<BR>&nbsp;&nbsp;top of the page."  Available to help promote a common look among
<BR>&nbsp;&nbsp;MOO-generated web pages, but ignored if this value is set to an
<BR>&nbsp;&nbsp;empty string.

<P>std_bgcolor
<BR>std_textcolor
<BR>std_linkcolor
<BR>std_vlinkcolor
<BR>std_alinkcolor
<BR>std_bkgnd
<BR>&nbsp;&nbsp;These are strings giving various default web page display values,
<BR>&nbsp;&nbsp;that can help you establish a basaic "look" for web pages the MOO
<BR>&nbsp;&nbsp;generates.  However, they can be overridden by various means, and
<BR>&nbsp;&nbsp;really just serve to promote a basic appearance.  The only one most
<BR>&nbsp;&nbsp;people will want to set is the .std._bkgnd property, which should
<BR>&nbsp;&nbsp;be the URL for an image to be used as the standard background for
<BR>&nbsp;&nbsp;all MOO-generated web pages that don't override the default.

<P>wizards_choice
<BR>&nbsp;&nbsp;Object number of a "Wizard's Choice" object, whose :html verb
<BR>&nbsp;&nbsp;generates a page pointing out some of the more interesting sites to
<BR>&nbsp;&nbsp;visit in the MOO.  Used by the $anon_webviewer and
<BR>&nbsp;&nbsp;$standard_webviewer to generate their button bar.  If set to #-1,
<BR>&nbsp;&nbsp;then no "Wizard's Choice" link is included in the button bar.

<P>On $teleporter
<BR>--------------
<BR>image_map
<BR>&nbsp;&nbsp;The URL for an image to be used as a map of the MOO, and added to
<BR>&nbsp;&nbsp;the bottom of pages generated by the $standard_webviewer and
<BR>&nbsp;&nbsp;$anon_webviewer.  Other properties on $teleporter give further
<BR>&nbsp;&nbsp;information concerning this imagemap.

<P>central_room
<BR>&nbsp;&nbsp;The "center" of the MOO.  May be $player_start or some other room.
<BR>&nbsp;&nbsp;Used by the $teleporter with certain web objects that send the user
<BR>&nbsp;&nbsp;to the "central room" if one has been designated.

<P>default_mapsize
<BR>&nbsp;&nbsp;The size to display the MOO imagemap at.

<P>imagemap_regions
<BR>&nbsp;&nbsp;An ordered list of imagemap regions in $web_utils:interpret_map
<BR>&nbsp;&nbsp;format.  Indexed to the .imagemap_rooms property, so that each
<BR>&nbsp;&nbsp;region corresponds to a room.

<P>imagemap_rooms
<BR>&nbsp;&nbsp;A list of rooms to teleport the user to when they select different
<BR>&nbsp;&nbsp;regions of the imagemap.  Those regions, indexed to this list of
<BR>&nbsp;&nbsp;rooms, are specified in the .imagemap_regions property.

<P>On $anon_webviewer
<BR>------------------
<BR>ghost_home
<BR>&nbsp;&nbsp;The object number of the room where people using the WebGhost
<BR>&nbsp;&nbsp;Viewer start.  By default, it's the same as $player_start.

<H2><A NAME="biogate-system">biogate-system</A></H2>

&nbsp;&nbsp;This MOO has installed the Biogate System, a set of MOO objects and
<BR>associated code that allow a MOO to function and a web server, and to
<BR>dynamically create HTML and VRML descriptions of MOO rooms and other
<BR>objects.
<BR>&nbsp;The version installed is: 1.3b

<P>The general flow during a web transaction is:

<P>&nbsp;&nbsp;&nbsp;&nbsp;port-handler -&gt; $http_handler &lt;-&gt; web-application

<P>The $http_handler sends out the retrieved information and then breaks
<BR>the connection.

<P>In addition, the web-application commonly will call individual
<BR>objects.  For instance, the $standard_webviewer calls &lt;object&gt;:html()
<BR>and the $std_vrml10viewer calls &lt;object:get_vrml() to retrieve
<BR>appropriate information about the object's current state.  Objects
<BR>usually supply fragments of the final text that is compiled by the
<BR>web-application and sent back to the $http_handler.

<P>The following components of the web system have their own core help
<BR>texts:

<P><A HREF="core_help.html#$http_port">$http_port</A>     -- listens on a MOO port for HTTP transactions
<BR><A HREF="core_help.html#$http_handler">$http_handler</A>  -- determines what type of resource is being requested
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(eg. HTML or VRML), retrieves the relevent data
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(possibly using a $webapp), sends out the info and
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closes the connection
<BR><A HREF="core_help.html#$webapp">$webapp</A>        -- The "web applications" that generate the text
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returned for a web transaction.
<BR><A HREF="core_help.html#$frame_manager">$frame_manager</A> -- Performs various functions related to building
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frames on the user's web page and placing the proper
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;information in each.
<BR><A HREF="core_help.html#$jclient_handler">$jclient_handler</A> -- Carries the verbs and data used to allow telnet
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clients written in Java to connect to the MOO,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and interact appropriately.  Each telnet client
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uses a different child of the $jclient_handler.
<BR><A HREF="core_help.html#$std_vrml10viewer">$std_vrml10viewer</A> -- This webapp displays a static VRML/1.0 view of a
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;given room.  Although it will pass VRML/2.0
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;information, it doesn't have any facilities for
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;live VRML display control.  It does dynamically
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;create the room view, though, so
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the returned VRML file describes the room at the
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moment of the request.
<BR><A HREF="core_help.html#$html_editor">$html_editor</A>   -- A child of the generic editor that specifically
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writes to object's associated URL/HTML data
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(#1.url).
<BR><A HREF="user_help.html#$web_options">$web_options</A>   -- Options package for setting various
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user-customizable aspects of the web system.
<BR><A HREF="user_help.html#$web_utils">$web_utils</A>     -- A collection of utility verbs used by the web
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system and web system programmers
<BR>Webpass Handler - The object that stores temporary web passwords for
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;users interacting with the MOO's web system (no
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;further help text is available for this object).
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Referenced as $http_handler.webpass_handler
<BR><A HREF="core_help.html#$teleporter">$teleporter</A>    -- The General Teleporter object is used by the web
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system to move characters when they teleport.  It
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is a general purpose tool for this, though, and
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can be used by non-BioGate systems.
<BR><A HREF="core_help.html#$anon_webviewer">$anon_webviewer</A> -- A Web Viewer that allows anonymous web
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transactions to be used to browse the MOO.  This
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;web viewer presents the MOO's rooms much like the
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$standard_webviewer, but doesn't require the
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transactions be authenticated.  It does not allow
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;users to manipulate objects, only to examine them
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in ways that don't change any of their
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;characteristics.
<BR><A HREF="core_help.html#$standard_webviewer">$standard_webviewer</A> -- The default web viewer for browsing the MOO
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with authenticated transactions.  It dynamically
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;creates web pages displaying the rooms and other
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;objects found in the MOO.
<BR><A HREF="core_help.html#integrated-web-telnet">integrated-web-telnet</A> -- Describes the innards of the integrated
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;web/telnet system, using the Cup-O MUD Java
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;telnet client as an example.

<P>Additional topics:

<P><A HREF="prog_help.html#web">web</A>             -- introduction to the MOO's web system
<BR><A HREF="user_help.html#@web-options">@web-options</A>    -- user options for cutomizing web system actions
<BR><A HREF="prog_help.html#web-programming">web-programming</A> -- how to program objects to be "web aware"
<BR><A HREF="core_help.html#web-security">web-security</A>    -- how the web system's authentication system works

<H2><A NAME="core-extraction">core-extraction</A></H2>

Documentation of the DU Core extraction and maintenance system

<P>OVERVIEW

<P>The purpose of the core extracting system is to create a "DU Core"
<BR>which contains the core objects and utilities which can be used by
<BR>other MOOs, without containing DU specific objects.  Utilities are
<BR>included to assure that the core functions satisfactorily after being
<BR>extracted, without having to be extensively modified after creation.
<BR>Thus, the underlying DU database contains all the information needed
<BR>to create and appropriately initialize a new core DB.

<P>The core database is created by running a minimal DB on a remote MOO,
<BR>opening a network connection to it, and then transferring all the
<BR>core objects to it.  All property and verb changes needed to
<BR>initialize the object for the new core are made by the verbs doing
<BR>the transfer, and all absolute number references in properties are
<BR>checked and changed where appropriate.  The object itself on the
<BR>source MOO is not modified, the information about any needed property
<BR>or verb initialization is taken from the object's "initcore_data"
<BR>property.  After all objects are transferred to the remote MOO, the
<BR>init_for_core verbs on all objects there is run do whatever
<BR>initialization is required beyond simple property or verb changes
<BR>(such as moving things, etc.)  This is quite different from the
<BR>standard LamdbaCore method, where the new core is created by deleting
<BR>all non-core objects from the MOO, renumbering the remaining core
<BR>objects, updating the object number references on #0, running
<BR>init_for_core verbs to initialize the objects, and then dumping the
<BR>database.

<P>The DU core system also uses the object's "unique_id" property to
<BR>determine if it is in the core.  Non-core objects have their
<BR>unique_id set to 0 when they are created (or they should).  All core
<BR>objects have a unique_id set to a list of three elements:  (1) the
<BR>unique name for the object (or the $name for objects named on #0);
<BR>(2) the core set identifier which is used to indicate whether this is
<BR>part of the basic core or a "core option" which can be optionally
<BR>included or not; and (3) date this object was transferred from a core
<BR>extraction, or 0 if it is on the source MOO.  This differs from the
<BR>LamdbaCore system, which uses all objects defined as a property on #0
<BR>(i.e, as $&lt;name&gt;), or their parents, as the set included on the core.
<BR>In the DU system, objects which are not on #0 can be included in the
<BR>core even if they are not parents of such objects, and objects on #0
<BR>need not be included.  However, in the latter case, care should be
<BR>taken that references to the corresponding $&lt;name&gt;'s not be in the
<BR>core objects,

<P>The DU core system, and its associated utilities, are designed so
<BR>that if the core objects have their initcore_data property and (where
<BR>applicable) init_for_core verbs set properly, they should function
<BR>without need for further modification after being transferred to the
<BR>new core MOO.  Several utility verbs are available to test the
<BR>property initialization in the initcore_data for an object, which
<BR>give warnings if there are object numbers which would be undefined on
<BR>the new core, or if there are properties with an excessive amount of
<BR>data that perhaps shouldn't be part of the core.  Utilities are also
<BR>available to check the verbs for absolute object number references,
<BR>or references to $names which will not be on the new core.

<P>The system also allows "core options", i.e., sets of objects that you
<BR>can optionally include in the core or not, depending on its intended
<BR>use.  For example, teaching tools and generics could be included in a
<BR>core intended for educational use, but not included in a core
<BR>extracted for other purposes.  The second string in the initcore_data
<BR>list identifies the core option that the object is associated with.
<BR>If that string matches the base core option id ("DUcore" at DU), then
<BR>the object is included on all cores regardless of which options are
<BR>selected.

<P>Most of the verbs, properties, and utilities for the core preparation
<BR>system are on $core_utils, which is a FO which a wizard must add to
<BR>his features to extract a core database. However, verbs to corify an
<BR>object, define an object as part of a core option, or to define a new
<BR>core option set, are on $wiz.  All of the user-callable verbs should
<BR>have a "help" stating what they do.    "Help $core_utils" will give a
<BR>summary of the verbs on that FO.  "@about $core_utils" will output
<BR>this text, and "@mailme $core_utils" will mail it.

<P>MAKING AN OBJECT PART OF THE CORE

<P>SETTING INITCORE_DATA.  As part of making an object part of the core,
<BR>you have to put all the necessary property and verb initializations
<BR>in the object's .initcore_data property.  This property should
<BR>contain text (a list of strings) giving the specifications for
<BR>changes to be made in properties or verbs in objects when they are
<BR>transferred to the new core.  It can be used to specify which verbs
<BR>or properties are not to be included, property initializations, or
<BR>reprogrammed verbs.  For example, a typical line would be '&lt;property
<BR>name&gt; = &lt;initial value&gt;', such as initializing a list to {}, etc.
<BR>For a DB object, it might specify that no properties defined on the
<BR>object are to be transferred except perhaps for a specified few.
<BR>This property thus serves the same function as the init_for_core verb
<BR>did in the LambdaCore system, making separate init_for_core verbs
<BR>unnecessary for most objects.  See 'help initcore-data' for a
<BR>detailed description of how to set up this property.  NO WIZARD
<BR>SHOULD CORIFY AN OBJECT WITHOUT UNDERSTANDING INITCORE_DATA.

<P>TO CORIFY AN OBJECT.  The objects which are included in the core are
<BR>specified using the @corify or @uncorify command.  The player must be
<BR>a wizard but need not have the $core_utils as a feature.  For more
<BR>information on these commands, see 'help $core_utils:&lt;verb&gt;'.

<P>The '@corify &lt;object&gt; as [$]&lt;unique name&gt; [&lt;core option set&gt;]'
<BR>command is used to make an object a part of the core (or a core
<BR>option set) which was not such previously, or to change the core
<BR>option set of an already corified object.  If a core option set is
<BR>not specified, the object is part of the base core, i.e., it is part
<BR>of the core regardless of which core options are selected.  The
<BR>'unique name' must be different for each core object, regardless of
<BR>whether it is in the base core or a core option.  If a '$' precedes
<BR>it, it is added as a property on #0 with that name (i.e., it is
<BR>'corified' in  the Lambdacore sense).

<P>The @corify command sets the unique_id of the property to {&lt;unique
<BR>name&gt;,&lt;core option set&gt;, 0}.  If the object is to be part of the base
<BR>core, the &lt;core option set&gt; string in the unique_id is the string at
<BR>$core_utils.core_id, which is "DUcore" at DU.  The command also puts
<BR>the object number on the DB objects for the main core or the core
<BR>option set (see below), and updates any relevant properties on
<BR>$core_utils, as appropriate.

<P>The '@uncorify &lt;object&gt;' command removes an object from the core, but
<BR>does not recycle it, nor does it remove it from #0 (it's $name), if
<BR>applicable.  The object's core option set identifier in its unique_id
<BR>(the second element) is set to "", and its object number is removed
<BR>from the DB for the core option set it was on.

<P>The @corify command checks the properties as processed by the
<BR>initcore_data on the object and gives warning messages for any object
<BR>numbers in the properties which may not be defined when the object is
<BR>transferred to a new core.  It also checks all verbs in the object
<BR>for absolute object number of $name references which may not be on
<BR>the new core.

<P>The @check-for-core command can be used to re-check the property
<BR>initialization or verbs in an object that is already corified.  This
<BR>is useful if @corify indicated problems which had to be fixed, or to
<BR>periodically check objects which have been modified.

<P>NOTE:  If you get a traceback running @corify or @check-for-core, run
<BR>'@list-core-objects' and try again.  If that fails, try
<BR>@search-core-objects (which takes longer).  These commands are
<BR>necessary to assure that the data bases used by the core checking
<BR>system are up-to-date.  They are described below.

<P>The @core-id command can be used to identify whether a particular
<BR>object is a core object or part of a core option set (see below), and
<BR>to determine if it can be referenced by a $&lt;name&gt;.  It is also useful
<BR>for getting the object number of a core object given its "core id
<BR>name", which is the name in its unique_id[1].

<P>CORE OPTION SETS

<P>A core option set is a group of objects which are not essential to
<BR>the core but can be included as options.  Each core option set
<BR>(including the base core set) has a database object defining the
<BR>object numbers in that in its properties, and also containing text
<BR>describing it.  To use core option sets, one must (1) use
<BR>@create-core-option to create the core option set database and input
<BR>its descriptive text, and then (2) use @corify to identify which
<BR>objects are on that set.  An object can be taken off the set by using
<BR>@uncorify, or using @corify to assign it to another option set or the
<BR>base core.

<P>Note that the processing of the initialization assignments in the
<BR>.initcore_data property can allow for properties to be initialized or
<BR>transferred differently depending on whether a particular core option
<BR>set is selected.  For example, it may be appropriate to remove verbs
<BR>on base core objects which are used only if a particular option is
<BR>selected.  This can be done using the %if &lt;option&gt; ... %endif
<BR>construct in initcore_data.  See 'help initcore'.

<P>The @core-options command can be used to list the currently selected
<BR>and available core option sets.  A 'selected' core option set is one
<BR>whose objects will be included in the next core extraction, as
<BR>discussed later.

<P>CREATING A CORE OPTION SET.  To create a new option set, use the
<BR>command '@create-core-option &lt;name&gt;', where &lt;name&gt; is the name of the
<BR>option set.  Each core option has a unique name, which must be
<BR>different from the unique name in the unique name (unique_id[1]) of
<BR>all the other core objects, as well as from any other core option
<BR>set.  The command will then do the following:

<P>&nbsp;- Create a new database for this option, as a descendent of the
<BR>Generic Core Option Database.  This object is automatically added to
<BR>this new core option set (so is a useful place for putting an
<BR>init_for_core verb that may be needed to initialize the set, such as
<BR>moving members into the appropriate locations).

<P>- Updates the properties on $core_utils which give the lists of all
<BR>available core options.  By default, a newly create core option set
<BR>is not selected for use and its objects will not be included in the
<BR>next core extraction unless it was selected using the
<BR>@select-core-option command (see below).

<P>- Prompts the user to give a short 1-line description of the set
<BR>which is output with the @core-options command which lists the
<BR>selected and available core options (see below).

<P>- Prompts the user to give the full about_text property which
<BR>documents the option set.  This is the text which is output with
<BR>@about &lt;option DB&gt; or @mailme &lt;option DB&gt;.  You should have prepared
<BR>this documentation text before you run @create-core-option so you'll
<BR>be ready to paste it in when prompted.

<P>An @abort at the prompts for the short_description or about_text will
<BR>terminate the command, but the option set will be fully created and
<BR>ready to use.  However, you will need to input these properties
<BR>manually.  The short_description property must be a single string,
<BR>but about_text is a list of strings.  At a minimum, the
<BR>short_description property must be defined.  The about_text can be
<BR>updated later as the set becomes documented.

<P>DELETING A CORE OPTION SET.  The command @delete-core-option is used
<BR>to remove a core option set from the available core options.  The
<BR>user is asked if the DB is to be recycled.  He/she must select 'yes'
<BR>or it won't be removed.  Then the user is asked if the references to
<BR>the object are to be removed from the unique_id[2]'s of all the
<BR>objects in the set.  If "yes" is selected, these are set to ""
<BR>indicating they are no longer on the core.  If "no" is selected, the
<BR>name of this set is still on the objects, but since the option DB
<BR>doesn't exist, the core utilities don't recognize them as part of any
<BR>valid core option, and they can't be included on the core.  If a new
<BR>core option set is created with this same name, these objects would
<BR>become part of that set.  However, they won't be on the DB.  The
<BR>'search-core-objects' command will fix this (see below).

<P>SELECTING A CORE OPTION SET.  The command @select-core-option &lt;name&gt;
<BR>selects an option set to be included in the core.
<BR>@unselect-core-option &lt;name&gt; unselects it.  You need to have the
<BR>$core_utils as a feature to use these commands.  Use of this feature
<BR>should be reserved to the person actually in charge of creating the
<BR>core database.


<P>PREPARING AND CHECKING THE SOURCE DATABASE.

<P>Although the @corify and @check-for-core prepare core objects and
<BR>update the core utilities database on an object-by-object basis,
<BR>before actually extracting a core it is a good idea to be sure the
<BR>core utilities and various core options databases are completely
<BR>up-to-date, and to check all the core objects.  Commands to do this
<BR>are summarized below.

<P>'@search-core-objects' and '@list-core-objects' are the basic
<BR>commands for assuring that the core utilities and core options
<BR>databases are completely consistent with the source MOO and up to
<BR>date.  This must be done before transferring a core database, and
<BR>also may be necessary for the core object checking verbs used by
<BR>@corify and @check-for-core to work.  @search-core-objects searches
<BR>all objects in the database, checks their unique_id's, and updates
<BR>the core databases accordingly.  This takes a long time, but should
<BR>always be run shortly before starting the core DB transfer process.
<BR>'@list-core-objects takes the list of core objects from the core
<BR>option databases, and is sufficient as long as these databases are
<BR>correct.  (@corify and @uncorify should keep them up to date, but if
<BR>the unique_id's of objects were changed manually, or if any core
<BR>objects were recycled, then the databases would be inaccurate, and
<BR>this can only be corrected by '@search-core-objects'.)  A note named
<BR>'core-list' is also produced, giving a listing of core objects and
<BR>other relevant information.

<P>The '@test-initcore' command should also be run (after running one of
<BR>the above) to check for problems in the selected set of core objects.
<BR>If run without any arguments, it is the same is running
<BR>@check-for-core on ALL the selected core objects.  In addition to
<BR>producing output with the warning messages, it also saves the warning
<BR>messages about bad object number references in properties (but not in
<BR>verbs) on the on $core_utils.unreferenced_log which can be viewed
<BR>using the @core-logs command.

<P>The @check-verbs' command can also be used to scan objects for
<BR>undefined object references in verbs.  If an object name or core id
<BR>name is given, then only the verbs in that object are scanned, and
<BR>the results are output to the player.  If no arguments are given,
<BR>then verbs in all selected core objects (objects in base core +
<BR>selected core options) are scanned, and the results go to
<BR>$core_utils.unreferenced_log, where they can be viewed by the
<BR>'@core-logs' command.

<P>Note that the wizard has to have $core_utils as a feature to run
<BR>these commands, and all those discussed below.

<P>CORE DB TRANSFER PROCESS

<P>As indicated above, the core database extraction is carried out by
<BR>transferring, via a network connection, the verbs and (initialized)
<BR>properties of the core objects from the running source MOO to a
<BR>recipient MOO initially running a minimal DB.  Because this is
<BR>essentially a bootstrap process starting with a minimal DB with
<BR>essentially nothing, the recipient MOO is referred to as the BootMOO
<BR>in the subsequent discussion.  Once the core is transferred to the
<BR>BootMOO, it will be referred to as the Core MOO.

<P>To do the transfer process, the wizard must have $core_utils as a
<BR>feature.  If you wish to use your programmer character for the
<BR>transfer process (which is time-consuming), use @add-owner &lt;name&gt; for
<BR>$core_utils, then add $core_utils as a feature of that character.
<BR>Then your character can add this feature, and use do the transfer
<BR>commands.

<P>SETTING UP MINIMAL DB  The starting point in the core transfer
<BR>process is to set up and run a minimal DB MOO at a site which can be
<BR>reached by the source MOO via a network connection.  The server
<BR>should use all the extensions and features as the server running the
<BR>source MOO.  Note that a special minimal DB must be used - where the
<BR>only object is #0, and the only verbs are an empty #0:eval and a
<BR>#0:do_login_command whose verb code consists only of "return #0;".
<BR>Such a minimal DB is on $core_utils.minimal_db, and can be e-mailed
<BR>using '@mailme minimal on $core_utils'.  Once the minimal DB is
<BR>copied to the appropriate site, the BootMOO can be run by using the
<BR>usual commands to start the MOO program with the input file being the
<BR>minimal DB.  One can connect to this MOO to make sure it is working,
<BR>but all you will see is 'I couldn't understand that.' messages; no
<BR>commands work except .program.

<P>The actual work is done by connecting to the BootMOO through a
<BR>network connection running on the source MOO.  Before doing this, THE
<BR>PROPERTY $CORE_UTILS.BOOTMOO_ADDRESS MUST BE SET TO THE ADDRESS OF
<BR>THE BOOTMOO, given as a list containing a string with the address and
<BR>a number containing the port, e.g,  @set $core_utils:bootmoo_address
<BR>to {"computer.site.domain",7777}.

<P>The command 'connect-bootmoo' (in the source MOO) will connect you to
<BR>the BootMOO.  If it isn't running or you gave a bad address or it is
<BR>not accessible over the network, you'll get a traceback.  If
<BR>successful, everything you type will go to the bootmoo, and
<BR>everything it outputs back to you will be preceded with a string like
<BR>'#-12345: ', where object number is the connection object ("player")
<BR>at the source MOO.  (This is like an un-logged-in player - you will
<BR>see it as a "dead" player on the @forked output.)  WHEN IN THIS MODE,
<BR>EVERYTHING YOU TYPE GOES TO THE BOOTMOO EXCEPT COMMANDS WHICH START
<BR>WITH '%'.  However, you will see output to you from the MOO, such as
<BR>pages, etc.  You will need to get out of this mode to respond.

<P>To get out of the BootMOO connection mode without actually closing
<BR>the connection, give a single '%' (+ return) command.  Use
<BR>'connect-bootmoo' to resume the connection where you left off.

<P>Additional BootMOO commands, in the order you'd normally give them,
<BR>are as follows.  (They are shown in caps for emphasis, but case
<BR>doesn't matter.)

<P>&nbsp;&nbsp;%BOOT ... This boots a brand-new minimal DB by programming all the
<BR>verbs on #0 needed to do the transfer.  You must give this command
<BR>first, and then not again.  The commands sent to the minimal DB to
<BR>bootstrap it is on the property $core_utils.bootcode.  No
<BR>'handshaking' is done; you'll know its done when you stop seeing
<BR>output - the last message output is "Ok.  #0 (System
<BR>):boot_inits_for_core programmed.".

<P>&nbsp;&nbsp;%INITIALIZE ... Creates and initializes all the selected core
<BR>objects on the BootMOO, but doesn't transfer any verbs or properties.
<BR>If any objects have been created or transferred before, they are
<BR>deleted.  Use this right after %boot, or if you want to start fresh.
<BR>This may take 2-3 minutes.  The message 'Finished with
<BR>initialization' will indicate it is finished.

<P>&nbsp;&nbsp;%TRANSFER, %TRANSFER_ALL, %TRANSFER &lt;object id&gt; ... Starts
<BR>transferring properties and verbs for either the next untransferred
<BR>core object, all untransferred core objects, or the core object whose
<BR>unique_id[1] is the given &lt;object id&gt;.  Note that this spams the user
<BR>continuously with messages indicate when each property or verb has
<BR>been transferred.  (For this reason, it is best run using a secondary
<BR>character so the wizard can do other work through a different
<BR>connection while this is going on.)  Transferring a large object such
<BR>as $player may take about a half an hour or so.  '%transfer_all may
<BR>take perhaps half a day.  This process can take many hours to
<BR>complete, though it can be aborted.  The 'stop_transfer' command
<BR>given by another $core_utils feature owner will stop a %transfer_all
<BR>after the current object is completed.  (That's why it's useful to
<BR>use a secondary character to run this command.)  NOTE:  do not
<BR>transfer objects out of order.  The parent should be transferred
<BR>before any of its descendants.  Refer to the &lt;object id&gt; only to
<BR>re-transfer an object that was transferred before, but somehow failed
<BR>or needs to be done again.

<P>&nbsp;&nbsp;%UPDATE, %UPDATE_ALL ... Transfers all properties and verbs on the
<BR>next (or all) core object which either hasn't been transferred, or
<BR>whose last_modified property has changed on the source MOO since it
<BR>was transferred.  Essentially operates the same as %transfer or
<BR>%transfer_all except that the latter doesn't transfer objects which
<BR>have been transferred before but may have changed.
<BR>&nbsp;
<BR>&nbsp;&nbsp;%GET_NEW_NUMBER ...  Gets from the BootMOO the number of objects
<BR>which have been transferred and need to be transferred.  This
<BR>information is displayed using the @core-logs command.  Useful if the
<BR>logs were cleared using @clear-core-logs.  This is not normally
<BR>needed, since this is updated automatically anytime %transfer or
<BR>%update is run.

<P>&nbsp;&nbsp;%FINISH_UP ... Completes the MOO initialization process and runs
<BR>the init_for_core verbs on all objects.  First checks to be sure
<BR>everything has been transferred, and gives an error message if not.
<BR>This should usually be run again if any objects have been updated
<BR>(using %update), unless you know that the transferred objects don't
<BR>have an init_for_core verb, or aren't modified by any other object's
<BR>init_for_core.  After this is run, the MOO is ready for normal
<BR>logins.

<P>&nbsp;&nbsp;% ... As indicated above, allows the user to suspend the network
<BR>connection so he can interact with the source MOO normally.
<BR>'Connect-bootmoo' will resume the connection mode to the existing
<BR>connection.

<P>&nbsp;&nbsp;%QUIT ... Closes the network connection ends the connection mode.
<BR>The BootMOO or core MOO is still running.   'Connect-bootmoo' will
<BR>start a new connection, and the user will have to either do the
<BR>minimal DB login (if %boot but not %finish_up has been run) or the
<BR>system core login (if %finish_up has run) to resume the transfer or
<BR>shut down the MOO - see below.

<P>&nbsp;&nbsp;%CLOSE ... Shuts down the BootMOO or Core MOO and closes the
<BR>network connection.  The partially or completely transferred database
<BR>is saved in the output DB.

<P>After the verbs on #0 have been transferred, you may get the message
<BR>'property not found' after each command.  This is due to the
<BR>#0:do_command verb, and does no harm in this process, and can be
<BR>ignored.

<P>If someone connects to the BootMOO in the state it is in between
<BR>running %boot and %finish_up, the 'welcome screen' will be something
<BR>like:
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Not logged in.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Your ID = #-3
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Max Object = #184
<BR>To log in, give the command 'minimal DB login'.  Anything else will
<BR>just result in this output being repeated.  Note that when you log in
<BR>this way, the player is the system object (#0), and you do not have
<BR>access to the normal player commands even if $player may have been
<BR>transferred.

<P>If you have run %finish_up, normally you would be finished with the
<BR>core creation process.  However, if you need to update some objects
<BR>(such as may have initialization problems) AND NOTHING HAS BEEN DONE
<BR>TO THE SOURCE MOO THAT YOU DON'T MIND OVER-WRITING with fresh core
<BR>objects and re-initialization, you can connect again as the system
<BR>object by giving the command 'system &lt;core id&gt; login', where &lt;core
<BR>id&gt; is the name on $core_utils.core_id, which is also the
<BR>unique_id[2] of all the base (non-optional) core objects.  For
<BR>example, for the DUcore the command would be 'system DUcore login'.
<BR>(Alternately, if the property $login.system_password is nonblank,
<BR>then the login should be system &lt;password&gt;', where &lt;password&gt; is the
<BR>password stored (in crypted form) on that property.  Normally, that
<BR>property should be set as blank in $login.initcore_data to simplify
<BR>system logins for a new core, but it should be set to "impossible
<BR>password to type" once the MOO is customized.)  Note that this will
<BR>fail if #0 is not a player (see below).  Once you have done that, you
<BR>can run %update, %finish_up and even %initialize and %transfer_all
<BR>again.

<P>INVALID OBJECTS.  If a transferred property has an object number
<BR>which does not exist on the new core MOO, a message will be output
<BR>during the transfer (and in the logs) saying so.  A 'placeholder'
<BR>object is created at the new Core MOO for this unreferenced object,
<BR>and the object number in the property becomes the object number of
<BR>the placeholder.  The placeholders are all descendants of a 'Generic
<BR>Undefined Object Number Reference' object,
<BR>(unique_id[1]="undefined"), and thus can be located in this way.  The
<BR>placeholder's name contains the name of the object it represents and
<BR>its description contains its object number at the source MOO, but
<BR>none of its properties or verbs are transferred.  Any objects with
<BR>properties referencing such invalid objects should have their
<BR>initcore_data edited ON THE SOURCE MOO to eliminate them, and be
<BR>re-transferred.

<P>CHECKING STATUS.  The '@core-logs' command can be used to check the
<BR>status of a transfer and determine if any invalid object number
<BR>references were encountered, or if any transfer attempts failed, and
<BR>how much is left to transfer.  (It is also useful for checking core
<BR>objects, as discussed above.)  the '@clear-core-logs command resets
<BR>it.  The number of objects transferred or needing to be transferred
<BR>is updated during the next %transfer or %update command.

<P>A wizard other than the one running the transfer can check on the
<BR>status of the transfer process using the @check-transfer' command.
<BR>This indicates which object, property, or verb  was the last
<BR>processed.

<P>DEALING WITH PROBLEMS.   The transfer process has an elementary form
<BR>of handshaking' where the transfer verbs wait for output from the
<BR>BootMOO starting with "Ok" or "Error" to indicate the status of data
<BR>sent to it.  If no such output is received, the process hangs up.
<BR>The @abort-bootmoo' command can then be used to simulate receipt of
<BR>an Error" record from the BootMOO, and end the hang-up.

<P>The @stop-transfer' command can be used if you want to stop a long
<BR>multi-object transfer.  The transfer of the object currently being
<BR>processed is completed, but the next object is not transferred.

<P>You must exit from the connect-bootmoo mode (using %") before giving
<BR>these commands, or (if the transfer is being done by a secondary
<BR>character), the separate wizard character may give them.

<P>COMPLETING THE CORE MOO

<P>Once the transfer is complete and %finish_up has been successfully
<BR>run, you can log in as #2 and complete the core preparation as a
<BR>normal wizard.  In the core MOO, #2 is 'Owner', and its password is
<BR>blank (""), so to log in as #2 give the command 'connect owner' at
<BR>the login screen.

<P>Check the new MOO for problems.  If there is a problem with an object
<BR>FIX IT ON THE SOURCE MOO AND TRANSFER IT AGAIN; DON'T FIX IT ON THE
<BR>CORE MOO.  For example, if properties are not being initialized
<BR>property and have object numbers of non-core objects, fix the
<BR>initcore_data on the source MOO, check it with @check-for-core, and
<BR>(if it checks ok) transfer it again.

<P>Once the core MOO is transferred and verified, the final task is to
<BR>remove the bootstrap verbs from #0, and remove the its wizard and
<BR>player status.  This is done by logging in as a wizard and doing the
<BR>@disable-system-login' command.  Make sure the transfer is completed
<BR>OK and all errors have been corrected before doing this, because the
<BR>system login is necessary to do the core transfer, and it is
<BR>difficult to re-enable this.  Messages output after
<BR>@disable-system-login is complete give the steps involved.

<P>UPDATING THE CORE MOO AFTER IT HAS BEEN CUSTOMIZED

<P>The core objects in the new MOO can be updated after it has been
<BR>customized, provided that changes have not been made to them that are
<BR>necessary for the desired customizations.  LOGINS AS THE SYSTEM
<BR>OBJECT SHOULD NOT BE USED FOR THIS PURPOSE, since this process may
<BR>cause loss of custom information.  Instead, a separate process, using
<BR>logins as a special player object designated system-updater (and
<BR>corified as $system_updater), is used.  Other than this separate
<BR>login, the update process is very similar to the core transfer
<BR>process, except that some of the commands used for core transfer are
<BR>not available to the system-updater.  Since the MOO which will
<BR>receive the updates may no longer be a core MOO, it is referred to as
<BR>the "destination" MOO in the subsequent discussion.

<P>PREPARING FOR SYSTEM UPDATES.  Only persons who have wizard
<BR>characters on both the source and destination MOO can do the updates.
<BR>To do the transfer, you must be able to log in as system-updater on
<BR>the destination MOO.  To do this, you must first log on the
<BR>destination MOO as your wizard character, then give the command
<BR>@system-updater'.  It will tell you if some other wizard is using its
<BR>password.  If so, check and make sure you're not working at
<BR>cross-purposes.  Then give the command @system-updater me'.  This
<BR>copies your password to that of system-updater, so you can log in as
<BR>this character using your own password.  Once this is done, your
<BR>wizard character is no longer needed at the destination MOO, though
<BR>you will find it useful for testing and making any adjustments
<BR>needed.

<P>To start the update process, log into the source MOO as either a
<BR>wizard character or a second character which is an additional owner
<BR>of $core_utils.  In either case, this character must have $core_utils
<BR>as a feature.

<P>Use @core-options' to select the core options to be transferred to
<BR>the destination MOO.  The options chosen should be the same or a
<BR>supersede of those used when the core for the destination MOO was
<BR>created, and must be compatible.  NOTE: If adding new core option,
<BR>make sure the existing core does not have objects whose
<BR>.initcore_data have conditional input which depends on whether that
<BR>is an option.  If it does, any core object with such input must be
<BR>re-transferred.  However, the system doesn't know when that is
<BR>necessary, so you will have to %transfer (not %update) them by name.
<BR>All custom properties on those objects would be lost.  It is not
<BR>recommended that core options involving conditionals on base core
<BR>objects be added to an existing MOO.

<P>Note also that system-updater does not run init_for_core verbs, even
<BR>for newly transferred objects.  If it is absolutely essential that
<BR>init_for_core be run for a new object, or re-run for a modified one,
<BR>then the wizard character (not system-updater) must do it manually.
<BR>However, the %finish_up' command used by system-updater does run
<BR>init_after_transfer' verbs on the core objects, so if initialization
<BR>is required (which does not involve loss of custom information), such
<BR>a verb can be created on the object for this purpose.  (For example,
<BR>normally core objects are owned by either $owner or $hacker, so for
<BR>$system_updater to be owned by itself, a
<BR>$system_updater:init_after_transfer verb was created has the
<BR>necessary call to $wiz_utils:grant.)

<P>Once the desired core options are chosen, run@search-core-objects' to
<BR>make sure the core-database in $core_utils are up-to-date.

<P>UPDATING PROCESS.  At the source MOO, give the connect-bootmoo'
<BR>command to log in, just as in a core transfer.  But at the welcome
<BR>screen, do connect system-updater &lt;password&gt;', where &lt;password&gt; is
<BR>your own wizard password at the destination MOO.  System-updater's
<BR>confunc causes @search-core-objects' to be automatically run, and no
<BR>commands can be given until this is finished.  This is necessary so
<BR>the updater can be confident that the properties in $core_utils which
<BR>list the core objects at the destination MOO are up-to-date and
<BR>complete.  Thus, if the destination MOO is large, the confunc may
<BR>take a while to complete.  Once it is complete, system-updater is
<BR>connected to $player_start, and can give the update commands,
<BR>described below.  Unlike the system object logins, system-updater can
<BR>also give all the player and room commands available to any
<BR>programmer.  Although the system-updater is not a wizard as such, it
<BR>has access to verbs which can change any object.  Because of this,
<BR>only wizards should use this character, and all connected wizards are
<BR>notified when system-updater logs on and off.

<P>It is best but not essential that the destination MOO not be occupied
<BR>by too many other players when the update is being done.  BUT SEE
<BR>WARNINGS BELOW.  To avoid other players (or the system) sending
<BR>output to system-updater which may be mixed with data being sent to
<BR>the source MOO, system-updater's notify() verb gags all players but
<BR>itself.  This can be changed by giving the command @set me.gagall to
<BR>0', but this is not recommended.  Gagging is turned back on again
<BR>when system-updater logs on.

<P>Once system-updater is logged into the destination MOO through
<BR>running connect-bootmoo at the source MOO, much of the same commands
<BR>as given in the core transfer process can be given.  However, in some
<BR>cases, the commands operate slightly differently.  These are as
<BR>follows:

<P>&nbsp;&nbsp;&nbsp;&nbsp;%UPDATE, %UPDATE_ALL.  If given without an argument, one or
<BR>&nbsp;&nbsp;&nbsp;&nbsp;all of the core objects which have changed (as indicated by their
<BR>&nbsp;&nbsp;&nbsp;&nbsp;.last_Modified property), or which have been newly created, are
<BR>&nbsp;&nbsp;&nbsp;&nbsp;updated.  This involves transferring all their verbs and
<BR>&nbsp;&nbsp;&nbsp;&nbsp;non-initialized properties.  Unlike %UPDATE when logged in as
<BR>&nbsp;&nbsp;&nbsp;&nbsp;system, properties which are initialized in the object's
<BR>&nbsp;&nbsp;&nbsp;&nbsp;.initcore_data property (except for "name" and "alias") are not
<BR>&nbsp;&nbsp;&nbsp;&nbsp;transferred.  These properties are assumed to be customized on
<BR>&nbsp;&nbsp;&nbsp;&nbsp;the destination MOO, so updating them would not be desired.  If
<BR>&nbsp;&nbsp;&nbsp;&nbsp;%UPDATE is given with an object id (it's unique_id[1]), that
<BR>&nbsp;&nbsp;&nbsp;&nbsp;object is updated regardless of it's last_modified property.

<P>&nbsp;&nbsp;&nbsp;%TRANSFER, %TRANSFER_ALL.  If given without an argument, one
<BR>&nbsp;&nbsp;&nbsp;&nbsp;or all of the core objects which have been newly created are
<BR>&nbsp;&nbsp;&nbsp;&nbsp;updated.  If given with an object id, the object is updated
<BR>&nbsp;&nbsp;&nbsp;&nbsp;regardless.  In this case, properties which are initialized in
<BR>&nbsp;&nbsp;&nbsp;&nbsp;the object's .initcore_data are also transferred.  THEREFORE, DO
<BR>&nbsp;&nbsp;&nbsp;&nbsp;NOT USE THIS NAMING EXISTING OBJECTS ON THE DESTINATION MOO WHICH
<BR>&nbsp;&nbsp;&nbsp;&nbsp;HAVE CUSTOM PROPERTIES you want to preserve.  However, this must
<BR>&nbsp;&nbsp;&nbsp;&nbsp;be used (with the object named) to re-transfer any core-object
<BR>&nbsp;&nbsp;&nbsp;&nbsp;whose .initcore_data have conditional statements involving core
<BR>&nbsp;&nbsp;&nbsp;&nbsp;options which have been added since the core was created.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Specifying %transfer' without a name is safe, since this would
<BR>&nbsp;&nbsp;&nbsp;&nbsp;affect only objects which are newly created, i.e., core objects
<BR>&nbsp;&nbsp;&nbsp;&nbsp;which did not exist when the core was originally created.

<P>&nbsp;&nbsp;&nbsp;%FINISH_UP.  This should be done after all objects are
<BR>&nbsp;&nbsp;&nbsp;&nbsp;updated.  The system will check to make sure all newly created
<BR>&nbsp;&nbsp;&nbsp;&nbsp;objects have been transferred, but not whether all updates have
<BR>&nbsp;&nbsp;&nbsp;&nbsp;been completed.  (To make sure all updates are completed, give
<BR>&nbsp;&nbsp;&nbsp;&nbsp;either %update_all or %update without an object id.  If nothing
<BR>&nbsp;&nbsp;&nbsp;&nbsp;is transferred, then everything should be updated.)  This runs
<BR>&nbsp;&nbsp;&nbsp;&nbsp;init_after_transfer verbs on all core objects, and makes sure #0
<BR>&nbsp;&nbsp;&nbsp;&nbsp;is set up OK for normal logins.  Note this is different from when
<BR>&nbsp;&nbsp;&nbsp;&nbsp;%finish_up is run during a core transfer, where init_for_core is
<BR>&nbsp;&nbsp;&nbsp;&nbsp;run for all objects.  Since running init_for_core verbs can
<BR>&nbsp;&nbsp;&nbsp;&nbsp;result in loss of custom information, they should not be run in
<BR>&nbsp;&nbsp;&nbsp;&nbsp;MOOs which have already been customized.

<P>&nbsp;&nbsp;&nbsp;%QUIT, %, %GET_NEW_NUMBERS.  These operate exactly the same
<BR>&nbsp;&nbsp;&nbsp;&nbsp;way as for core transfers.  The first closes the connection, the
<BR>&nbsp;&nbsp;&nbsp;&nbsp;second temporarily suspends connect-bootmoo without closing the
<BR>&nbsp;&nbsp;&nbsp;&nbsp;connection, and the third updates the database on the source MOO
<BR>&nbsp;&nbsp;&nbsp;&nbsp;concerning objects on the destination without transferring
<BR>&nbsp;&nbsp;&nbsp;&nbsp;anything.  See above for details.

<P>&nbsp;&nbsp;&nbsp;&nbsp;%CLOSE.  This operates like %QUIT.  System-updater cannot
<BR>&nbsp;&nbsp;&nbsp;&nbsp;shut down the destination MOO.

<P>&nbsp;&nbsp;&nbsp;&nbsp;%BOOT, %INITIALIZE.  These commands, which are available
<BR>&nbsp;&nbsp;&nbsp;&nbsp;during the core transfer using the system login, SHOULD NEVER BE
<BR>&nbsp;&nbsp;&nbsp;&nbsp;USED WHEN DOING A TRANSFER AS SYSTEM-UPDATER.  To protect the
<BR>&nbsp;&nbsp;&nbsp;&nbsp;database against the effects of these destructive commands,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;system-updater is immediately booted if they are given.

<P>The normal process after connection is to do "%transfer_all" to
<BR>assure that all new objects are transferred, then "%update_all" to
<BR>assure that everything else is updated.  If any objects need to be
<BR>specifically transferred and re-initialized, then %transfer &lt;object
<BR>id&gt; should be used.  Finally run "%finish_up" to do any
<BR>re-initializations that may be required, and then %quit to log out.

<P>Although the updates can be done when both the destination as well as
<BR>the source MOO are running normally, IT IS STRONGLY RECOMMENDED THAT
<BR>THE DESTINATION MOO DATABASE BE SAVED IMMEDIATELY BEFORE THE UPDATES,
<BR>AND THAT ORDINARY USERS EITHER NOT BE ALLOWED TO LOG IN, OR TOLD THAT
<BR>THEIR WORK MAY BE LOST.  After the update, the destination MOO should
<BR>be thoroughly tested, and if it looks like it was seriously damaged,
<BR>the saved database should be restored.  It may be that certain
<BR>objects should not be updated, or may have to be appropriately
<BR>changed on the source MOO before re-transfer. Only after thorough
<BR>testing should the destination MOO be put back into normal operation.

<P>_______________
<BR>Additional Help

<P><A HREF="user_help.html#$core_utils">$core_utils</A>   -- specific documentation of $core_utils feature object commands
<BR><A HREF="core_help.html#initcore-data">initcore-data</A> -- description of the .initcore_data property
<BR><A HREF="core_help.html#core-options">core-options</A>  -- controlling which segments of the MOO are included in a core
<BR><A HREF="core_help.html#unique-id">unique-id</A>     -- description of the .unique_id property

<H2><A NAME="core-index">core-index</A></H2>

<TABLE BORDER=0 CELLSPACING=6>
<TR><TD VALIGN="TOP"><A HREF="#$anon_webviewer">$anon_webviewer</A></TD><TD VALIGN="TOP"><A HREF="#$http_port">$http_port</A></TD><TD VALIGN="TOP"><A HREF="#$section_editor">$section_editor</A></TD><TD VALIGN="TOP"><A HREF="#mail-format">mail-format</A></TD></TR>
<TR><TD VALIGN="TOP"><A HREF="#$biglist">$biglist</A></TD><TD VALIGN="TOP"><A HREF="#$jclient_handler">$jclient_handler</A></TD><TD VALIGN="TOP"><A HREF="#$site_db">$site_db</A></TD><TD VALIGN="TOP"><A HREF="#mail-receiving">mail-receiving</A></TD></TR>
<TR><TD VALIGN="TOP"><A HREF="#$byte_quota_utils">$byte_quota_utils</A></TD><TD VALIGN="TOP"><A HREF="#$local">$local</A></TD><TD VALIGN="TOP"><A HREF="#$standard_webviewer">$standard_webviewer</A></TD><TD VALIGN="TOP"><A HREF="#mail-resolve">mail-resolve</A></TD></TR>
<TR><TD VALIGN="TOP"><A HREF="#$container">$container</A></TD><TD VALIGN="TOP"><A HREF="#$login">$login</A></TD><TD VALIGN="TOP"><A HREF="#$std_vrml10viewer">$std_vrml10viewer</A></TD><TD VALIGN="TOP"><A HREF="#mail-sending">mail-sending</A></TD></TR>
<TR><TD VALIGN="TOP"><A HREF="#$error">$error</A></TD><TD VALIGN="TOP"><A HREF="#$mail_agent">$mail_agent</A></TD><TD VALIGN="TOP"><A HREF="#$teleporter">$teleporter</A></TD><TD VALIGN="TOP"><A HREF="#mail-system">mail-system</A></TD></TR>
<TR><TD VALIGN="TOP"><A HREF="#$exit">$exit</A></TD><TD VALIGN="TOP"><A HREF="#$mail_browser">$mail_browser</A></TD><TD VALIGN="TOP"><A HREF="#$vspo_registry">$vspo_registry</A></TD><TD VALIGN="TOP"><A HREF="#maintenance">maintenance</A></TD></TR>
<TR><TD VALIGN="TOP"><A HREF="#$feature">$feature</A></TD><TD VALIGN="TOP"><A HREF="#$mail_recipient">$mail_recipient</A></TD><TD VALIGN="TOP"><A HREF="#$webapp">$webapp</A></TD><TD VALIGN="TOP"><A HREF="#MR-access">MR-access</A></TD></TR>
<TR><TD VALIGN="TOP"><A HREF="#$frame_manager">$frame_manager</A></TD><TD VALIGN="TOP"><A HREF="#$manager">$manager</A></TD><TD VALIGN="TOP"><A HREF="#admin-mail-recipts">admin-mail-recipts</A></TD><TD VALIGN="TOP"><A HREF="#MR-naming">MR-naming</A></TD></TR>
<TR><TD VALIGN="TOP"><A HREF="#$generic_db">$generic_db</A></TD><TD VALIGN="TOP"><A HREF="#$map">$map</A></TD><TD VALIGN="TOP"><A HREF="#biogate-setup">biogate-setup</A></TD><TD VALIGN="TOP"><A HREF="#MR-reading">MR-reading</A></TD></TR>
<TR><TD VALIGN="TOP"><A HREF="#$generic_editor">$generic_editor</A></TD><TD VALIGN="TOP"><A HREF="#$new_player_log">$new_player_log</A></TD><TD VALIGN="TOP"><A HREF="#biogate-system">biogate-system</A></TD><TD VALIGN="TOP"><A HREF="#MR-searching">MR-searching</A></TD></TR>
<TR><TD VALIGN="TOP"><A HREF="#$generic_help">$generic_help</A></TD><TD VALIGN="TOP"><A HREF="#$new_prog_log">$new_prog_log</A></TD><TD VALIGN="TOP"><A HREF="#core-extraction">core-extraction</A></TD><TD VALIGN="TOP"><A HREF="#MR-sequences">MR-sequences</A></TD></TR>
<TR><TD VALIGN="TOP"><A HREF="#$generic_option">$generic_option</A></TD><TD VALIGN="TOP"><A HREF="#$news">$news</A></TD><TD VALIGN="TOP"><A HREF="#core-index">core-index</A></TD><TD VALIGN="TOP"><A HREF="#MR-setup">MR-setup</A></TD></TR>
<TR><TD VALIGN="TOP"><A HREF="#$generic_options">$generic_options</A></TD><TD VALIGN="TOP"><A HREF="#$no_one">$no_one</A></TD><TD VALIGN="TOP"><A HREF="#core-options">core-options</A></TD><TD VALIGN="TOP"><A HREF="#MR-subscribing">MR-subscribing</A></TD></TR>
<TR><TD VALIGN="TOP"><A HREF="#$gopher">$gopher</A></TD><TD VALIGN="TOP"><A HREF="#$object_quota_utils">$object_quota_utils</A></TD><TD VALIGN="TOP"><A HREF="#creation_enabled">creation_enabled</A></TD><TD VALIGN="TOP"><A HREF="#MR-writing">MR-writing</A></TD></TR>
<TR><TD VALIGN="TOP"><A HREF="#$help">$help</A></TD><TD VALIGN="TOP"><A HREF="#$player_db">$player_db</A></TD><TD VALIGN="TOP"><A HREF="#diskmail">diskmail</A></TD><TD VALIGN="TOP"><A HREF="#object-matching">object-matching</A></TD></TR>
<TR><TD VALIGN="TOP"><A HREF="#$help_webviewer">$help_webviewer</A></TD><TD VALIGN="TOP"><A HREF="#$recycler">$recycler</A></TD><TD VALIGN="TOP"><A HREF="#email-permeability">email-permeability</A></TD><TD VALIGN="TOP"><A HREF="#unique-id">unique-id</A></TD></TR>
<TR><TD VALIGN="TOP"><A HREF="#$housekeeper">$housekeeper</A></TD><TD VALIGN="TOP"><A HREF="#$registration_db">$registration_db</A></TD><TD VALIGN="TOP"><A HREF="#guest-access">guest-access</A></TD><TD VALIGN="TOP"><A HREF="#web-security">web-security</A></TD></TR>
<TR><TD VALIGN="TOP"><A HREF="#$html_editor">$html_editor</A></TD><TD VALIGN="TOP"><A HREF="#$request_booth">$request_booth</A></TD><TD VALIGN="TOP"><A HREF="#initcore-data">initcore-data</A></TD><TD VALIGN="TOP"><A HREF="#web-system">web-system</A></TD></TR>
<TR><TD VALIGN="TOP"><A HREF="#$http_handler">$http_handler</A></TD><TD VALIGN="TOP"><A HREF="#$room">$room</A></TD><TD VALIGN="TOP"><A HREF="#integrated-web-telnet">integrated-web-telnet</A></TD><TD></TD></TR>
</TABLE>

<H2><A NAME="core-options">core-options</A></H2>

A core option set is a group of objects which are not essential to the core database but can be included as options for specific core database extractions.  Each such set is identified by a unique name, and each object in the set has this name in its unique_id[2] property.  See 'help unique-id', '@about $core_utils' or '@mailme $core'_utils for details.

<P>The following commands are used to display, create, or delete core options:

<P>&nbsp;&nbsp;@core-options

<P>Lists the available core options, and the ones that have been selected for inclusion in the next core extraction.

<P>&nbsp;&nbsp;@create-core-option &lt;name&gt;

<P>Creates and names a new core option set, and creates the database object used to keep track of which objects are on it.  Each core option has a unique name to identify it.  This name cannot be the same as the core id name of any other core objects.  (See 'help unique-id'.)  The user is prompted to give a short 1-line description of the set which is output with the @core-options command, and the more extensive '@about' text to document it.  You should have prepared this documentation text before you run @create-core-option so you'll be ready to paste it in when prompted. 

<P>&nbsp;&nbsp;@delete-core-option &lt;name&gt;

<P>Removes a core option set and deletes its database object.  The user is asked if the references to the object are to be removed from the unique_id[2]'s of all the objects in the set.  If so, these are set to "" indicating they are no longer on the core.  Otherwise, the name of this set is still on the objects, but since the option DB doesn't exist, the core utilities don't recognize them as part of any valid core option.

<P>The @corify command is used to identify objects as part of particular core options, or to change the option they are a part of.  See 'help @corify'.  The @uncorify command can be used to remove an object from any core option.

<H2><A NAME="creation_enabled">creation_enabled</A></H2>

If the MOO has "new user creation enabled" then people can create a
<BR>character for themselves right from the welcome screen.  Most MOO
<BR>admnistrators will want to leave this disabled, and have people
<BR>connect as guests and use the @request command to submit an
<BR>application.

<P>However, the system may be enabled by entering:
<BR>&nbsp;&nbsp;@set $login.create_enabled to 1
<BR>The system can be disabled with: @set $login.create_enabled to 0

<P>If the creation system is disabled, then people using the `create'
<BR>command at the welcome screen will see the message set with:
<BR>&nbsp;&nbsp;@set $login.registration_string "Put your message here."

<H2><A NAME="diskmail">diskmail</A></H2>

&nbsp;&nbsp;The default eduCore used an in-DB MOOmail system, such that mail
<BR>folders and characters' mail is stored on the MOO objects as
<BR>properties.  The eduCore can optionally use a "disk-mail" system,
<BR>which stores the actual messages as files outside the MOO database
<BR>itself.  The disk-mail system uses the BioMOO File Utilities Package
<BR>(FUP), which has to have been installed when the MOO server was
<BR>compiled.
<BR>&nbsp;&nbsp;To set up the MOO to use disk-mail, you should first prepare the
<BR>file structure on the system where the MOO is running.  There must be
<BR>a directory called "files" in the directory from which the MOO is
<BR>run.  Inside the "files" directory should be another named "mail"
<BR>that will hold the disk-mail.  Both the "files" and the "mail"
<BR>directory must be readable and writable by the user under whose
<BR>permissions the server is running.  To summarize the file structure:
<BR>&nbsp;&nbsp;moo/moo.db
<BR>&nbsp;&nbsp;moo/files/
<BR>&nbsp;&nbsp;moo/files/mail/
<BR>Once the file structure is set up, you can test the FUP system with:
<BR>&nbsp;&nbsp;;filelist("")
<BR>and you should see something like:
<BR>&nbsp;&nbsp;=&gt; {{}, {"mail"}}
<BR>where the first bracket (here empty) lists the files in the "files"
<BR>directory, and the second lists the subdirectories.  If instead you
<BR>see "Line 1:  Unknown built-in function: filelist" then FUP is either
<BR>not installed or not functioning.    Once you've confirmed that FUP
<BR>is installed and functioning, you can direct the MOO to use disk-mail
<BR>as follows:
<BR>&nbsp;&nbsp;1. Change the default mail-folder agent with:
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@set $mail_recipient.mail_agent to $disk_mail_agent
<BR>&nbsp;&nbsp;2. Change the default user character agent with:
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@set $player.mail_agent to $disk_mail_agent
<BR>If all the the user characters and mail-folders have clear
<BR>.mail_agent properties, then you are all done.  If some have
<BR>.mail_agent explicitly set to $mail_agent, you'll have to either
<BR>change that value or just clear it.  To clear all the mail-folder and
<BR>character agents, you can use (all one line):
<BR>&nbsp;&nbsp;;for o in ({@$object_utils:descendents($player),@$object_utils:descendents($mail_recipient)}) clear_property(o,"mail_agent") endfor

<P>WHAT TO DO WHEN THERE ARE TOO MANY FILES TO RESYNC

<P>When there are a *lot* of messages, and therefore a lot of files, the MOO can sometimes run out of seconds just trying to get a list of them.  This typically happens when the mail folder resynchronizes itself to generate a file listing, or is expunging deleted messages.  When this happens, you should either, 1. archive the mail folder and start a new one, or 2. tell the person with all those messages to @netforward and delete some.  

<P>However, if you need to just get the synchronization done, or if it is a long-term archive to which new messages are no longer being posted, you can create a "hard" directory list that the disk-mail system will use if it's there.  This listing won't be updated if new messages are posted or messages are deleted, so it is only good as a temporary measure or for an archive.  

<P>To create a "hard" directory listing:

<P>1. Log onto the server on which the MOO is running, and "cd" to the "files" subdirectory of the directory in which the MOO database is run from (e.g. cd "~du/moo/files/mail").
<BR>2. Change to the directory for the problematic mail recipient.  For instance, if the problem was *general (#1017), you would "cd #1017" to do this.
<BR>3. Type "ls &gt; .file.list" to make a "hard" directory list
<BR>4. Force the MOO's mail folder to resynchronize.  For instance, you could type "@mail on *general" for resync *general.  If you are creating a permanent "hard" directory for an archive, you're done.  Otherwise, go on.
<BR>5. Wait for the resynchronization is compelte. In the example here, that would be demonstrated when the MOO showed you the list of messages on *general.
<BR>6. Remove the temporary file by typing "rm .file.list" on the server.
<BR>7. Back up to the mail subdirectory ("cd ..") and repeat the process with all mail recipients that are unable to resynchronize or expunge themselves without running out of time.

<P>When someone gets a chance, they should write a "help $disk_mail_agent" text, to explain in detail how the system works.

<H2><A NAME="email-permeability">email-permeability</A></H2>

The Internet Email Permeability System for MOO was developed by
<BR>Diversity University for SRI International.  It consists of a set of
<BR>new MOO objects, modifications of existing MOO objects, and server
<BR>sendmail.conf changes.  The system allows MOO users and mail folders
<BR>to receive email from and send email to the Internet, with the MOO
<BR>serving as the user interface.  It provides these functions by
<BR>allowing the use of Internet email addresses where ever MOO character
<BR>names are typically used within the MOOmail system.

<P>All MOOmail commands that accept a MOO character name or mail folder
<BR>as the recipient may be given an Internet email address instead.  For
<BR>instance, just as users can "@send Jane" to send a internal MOOmail
<BR>message to the character named Jane, they can "@send
<BR>johnd@outside.net" to send an Internet email message to the person at
<BR>the "johnd@outside.net" address.

<P>Similarly, people outside the MOO can send email to specific
<BR>characters within the MOO, and that mail will be accepted by the
<BR>Email Permeability System and presented to that character as MOOmail.
<BR>The outside person would typically send to "jane@moomail.oursite.edu"
<BR>in order to send a message to the character named "Jane" at the MOO
<BR>running at the "oursite.edu" site.  The specific format of the
<BR>address depends on how the sendmail.conf file has been modified on
<BR>the UNIX system where the MOO's mail is received.  The
<BR>$network.inet_mail_host property carries the correct site to use for
<BR>addressing Internet email to MOO characters and mail folders.

<P>Finally, MOO mail folders may also receive email from the Internet,
<BR>typically with something like "announcements-list@moomail.oursite.edu"
<BR>being the format to send Internet email to the *announcements mail
<BR>folder (the "-list" appended to the name indicates a mail folder).
<BR>This function, together with the ability of mail folders to send
<BR>Internet email directly, allows mail folders to serve as the in-MOO
<BR>proxy for an outside email list.  For instance, a mail folder that
<BR>was subscribed to an outside email list, and also forwarded messages
<BR>to that list, would function in that way.  Any users who subscribed
<BR>to the in-MOO mail folder would essentially be subscribing to that
<BR>external email list, and mail sent to the MOO mail folder would be
<BR>forwarded to that external list.

<P>For Administrators:

<P>Note that #0.mail_agent ($mail_agent) must be set to the
<BR>$inet_mail_agent for the Email Permeability system to function.  Any
<BR>$mail_recipients in the old $mail_agent should be moved to the new
<BR>one.

<P>Access to email permeability functions may be restricted or provided
<BR>to all MOO users and mail folders.  This is controlled by an
<BR>"inet_mail" property found on $player and on $mail_recipient.  It is
<BR>a LIST, which may contain any or none of "can_receive" indicating the
<BR>object may receive incoming Internet email, and "can_send" indicating
<BR>it can send mail to Internet addresses.

<P>The @email-access command on $wizard is provided to set this
<BR>property, which can be set directly on $player or $mail_folder for
<BR>broadly enabling the email permeability functions.

<P>The $network.inet_mail_host property (a STR) must be set in order to
<BR>enable outgoing email to have a proper "reply-to" address.  This
<BR>property should be the Internet site where mail to a MOO character or
<BR>mail folder is to be sent (i.e. the MOO's outside maildrop).  There
<BR>must, of course, be a $popmail_MOOagent that will retrieve the mail
<BR>from that site, and the specified site should have its sendmail.conf
<BR>modified to accept mail for the MOO.  This property is also used to
<BR>create the "postmaster@site" address for email the MOO bounces for
<BR>some reason.

<P>See `help $popmail_MOOagent' and `help  $pop3_utils' for information
<BR>about properties on those objects that must be set to enable the MOO
<BR>to retrieve its mail from the outside mail drop site.

<P>For Programmers:

<P>Additional detailed information about each part of the system is
<BR>available on the appropriate MOO objects.  The specific objects,
<BR>properties, and verbs that are unique to the Internet Email
<BR>Permeability System are:

<P>$core_help.email-permeability
<BR>POP3 email utilities ($pop3_utils)
<BR>Internet Forwarding Mail Recipient ($inet_mail_recipient)
<BR>POP3 email to MOO agent ($popmail_MOOagent)
<BR>Internet Email Mail Agent ($inet_mail_agent)
<BR>Core Help ($core_help)
<BR>&nbsp;&nbsp;.email-permeability
<BR>Wizard Help ($wiz_help)
<BR>&nbsp;&nbsp;.@email-access
<BR>generic player ($player)
<BR>&nbsp;&nbsp;.inet_mail
<BR>Generic Mail Recipient ($mail_recipient)
<BR>&nbsp;&nbsp;.inet_mail
<BR>Network Utilities ($network)
<BR>&nbsp;&nbsp;.inet_mail_host

<P>Outside the MOO, the sendmail.conf of the MOO's mail-drop must be modified.

<P>In addition, the following existing verbs and properties were
<BR>modified to support email permeability:

<P>System Object ($sys)
<BR>&nbsp;&nbsp;.mail_agent

<P>generic player ($player)
<BR>&nbsp;&nbsp;:notify_mail
<BR>&nbsp;&nbsp;:@nn

<P>Generic Mail Recipient ($mail_recipient)
<BR>&nbsp;&nbsp;:is_usable_by

<P>Mail Room ($mail_editor)
<BR>&nbsp;&nbsp;:parse_invoke
<BR>&nbsp;&nbsp;:parse_recipients
<BR>&nbsp;&nbsp;:parse_msg_headers

<P>Network Utilities ($network)
<BR>&nbsp;&nbsp;.initcore_data
<BR>&nbsp;&nbsp;:return_address_for
<BR>&nbsp;&nbsp;:invalid_email_address

<P>General Help Database ($help)
<BR>&nbsp;&nbsp;.mail
<BR>&nbsp;&nbsp;.@send

<H2><A NAME="guest-access">guest-access</A></H2>

Guest access and abilities can be regulated in many ways.

<P>Commands:

<P><A HREF="user_help.html#@banish">@banish</A> --  boot a guest off and save the collected @witness log
<BR><A HREF="manager_help.html#@guests">@guests</A> --  lists all connected @guests and their origin site
<BR><A HREF="manager_help.html#@request">@request</A> --  what guests use to request characters (moves them to the $request_booth)
<BR><A HREF="manager_help.html#@make-guest">@make-guest</A> --  make a new guest character, adding to the available set
<BR><A HREF="manager_help.html#@blacklist">@blacklist</A> -- restrict guest access from an internet site

<P>Significant properties:

<P>$guest.domain_login_threshold
<BR>&nbsp;&nbsp;&nbsp;&nbsp;The maximum number of guests that can connect from a single
<BR>&nbsp;&nbsp;&nbsp;&nbsp;domain. Useful for preventing "mobbing" of the MOO by guests from
<BR>&nbsp;&nbsp;&nbsp;&nbsp;one site. (NUM)
<BR>$guest.default_gender
<BR>&nbsp;&nbsp;&nbsp;&nbsp;The default gender for guests. (STR)
<BR>$guest.default_description
<BR>&nbsp;&nbsp;&nbsp;&nbsp;The default description for guests. (LIST)
<BR>guest.extra_confunc_msg
<BR>&nbsp;&nbsp;&nbsp;&nbsp;A message displayed to all guests when they connect. (STR)
<BR>$guest.toomany_message
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Displayed when all the guests characters are taken and someone
<BR>&nbsp;&nbsp;&nbsp;&nbsp;tries to connect as a guest. (STR)
<BR>$guest.default_drawing_mode
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Are guests shown ASCII art drawings by default. (BOOL)
<BR>$guest.default_user_options
<BR>&nbsp;&nbsp;&nbsp;&nbsp;The default value for $guest.user_options. (LIST)
<BR>$guest.huh_help
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If 1, give guests some hints if they type in something the MOO
<BR>&nbsp;&nbsp;&nbsp;&nbsp;doesn't understand. (BOOL)

<P>Additional topics:

<P><A HREF="user_help.html#guest-banishing">guest-banishing</A>     --  about using the @banish command
<BR><A HREF="core_help.html#$request_booth">$request_booth</A>      --  the place people who @request are moved, and
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the object that presents an application for
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;them to fill out.  It has many settings that
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;should be customized for the MOO.
<BR><A HREF="core_help.html#creation_enabled">creation_enabled</A>    --  for allowing people to make characters for
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;themselves right from the welcome screen
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rarely useful).
<BR><A HREF="manager_help.html#access-restrictions">access-restrictions</A> --  a summary of access restriction commands
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;relevent for all character types

<H2><A NAME="initcore-data">initcore-data</A></H2>

Initcore_data: Property initialization for core db extractions.

<P>The DU core extraction system uses the .initcore_data property on each object to give property and verb initialization information necessary for the object to operate properly in a newly extracted core.  This property should contain text (a list of strings) giving the specifications for changes to be made in properties or verbs in objects when they are transferred to the new core.  It can be used to specify which verbs or properties are not to be included, property initializations, or reprogrammed verbs.  For example, a typical line would be '&lt;property name&gt; = &lt;initial value&gt;', such as initializing a list to {}, etc.  For a DB object, it might specify that no properties defined on the object are to be transferred except perhaps for a specified few.  This property thus serves the same function as the init_for_core verb did in the LambdaCore system, making separate init_for_core verbs unnecessary for most objects.

<P>The following are valid inputs in an .initcore_data property:

<P>&lt;name&gt; = &lt;value&gt;  ............... Initializes a property.  &lt;value&gt; must be a
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string which is decodable as a value in an
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval.  It should NOT contain absolute
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object numbers.
<BR>% &lt;comments&gt;  ................... to add comments which are ignored.
<BR>%delprop &lt;property to delete&gt;  .. to delete or clear a property.
<BR>%delverb &lt;verb to delete&gt;  ...... to delete a verb.  The verb must be
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;identified by its name + all aliases as
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;given in verbs().
<BR>%verbcode &lt;verb to re-program&gt; .. to change verb code. The verb must be 
<BR>&lt;verb code&gt;                       identified by its name + all aliases
<BR>%end                              as given in verbs().
<BR>%noverbs  ....................... to delete all verbs defined on the object.
<BR>%clearprops  .................... to clear or delete all properties except
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;those listed, builtin properties,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unique_id, last_modified, creation_date,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and initcore_data.
<BR>%noprops  ....................... Delete all properties defined on the
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object except those whose values are given
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;explicitly.  (Inherited properties are not
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleared.)
<BR>%saveprop &lt;property to save&gt;  ... (used in conjunction with %noprops) Do not
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete this property.
<BR>%saveverb &lt;verb to save&gt;  ....... (Used in conjunction with %noverbs) Do not
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete this verb.
<BR>%nocopydb  ...................... Don't copy any properties whose name start
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with a blank.
<BR>%if [!|-]&lt;option&gt; ............... following code to '%endif' is to be used
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if the indicated core option is (or isn't)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;selected.
<BR>%endif .......................... ends '%if' block.

<P>The command '@check-for-core &lt;object&gt;' can be used to determine if the object has problems with property initialization, and if there are errors in the object's .initcore_data property.  If there is output saying **new** or that something is set to a different object number, it means that there are absolute object number references in the object.  This almost always means that the property involved needs to be initialized in the .initcore_data text.

<H2><A NAME="integrated-web-telnet">integrated-web-telnet</A></H2>

The integrated web/telnet system uses frames to divide the user's web
<BR>browser window into sections, and has the browser load different
<BR>functional units of the system into different frames.  At a minimum,
<BR>frames are used for displaying an HTML document (in the web frame)
<BR>and a Java-based Telnet applet (in the live interaction frame, aka
<BR>telnet frame).

<P>This text describes the system that builds and manages the integrated
<BR>interface display.  See the BioGate System installation instructions
<BR>for instructions on setup.

<P>The trajectory of the web transaction that creates the user display
<BR>is as follows:

<P>&lt;http_port&gt;:do_login_command -&gt; $http_handler:handle_http10
<BR>&nbsp;:handle_http10 checks if the transaction is an authentication
<BR>request (empty URI with a form submitted), and if it is then looks,
<BR>using a call to $http_handler:preprocess_URL, to see if there is an
<BR>"integrated_web_interface" form entry (the value is ignored.  This
<BR>may be present because the name of the SUBMIT button for the
<BR>integrated interface on the web Gateway page is
<BR>"integrated_web_interface" so if the user selects that button then a
<BR>form entry with that name will be included.  If they select the
<BR>button for an independent web window (usually named
<BR>"independent_web_window") then that would be the form entry included
<BR>instead).

<P>&nbsp;&nbsp;If the integrated web interface has been selected, the
<BR>authentication is set to $no_one (anonymous), the URI is set to
<BR>"/frame_mgr/0/frameset" and the transaction continues based on the
<BR>new value.

<P>&nbsp;-&gt; $http_handler:process -&gt; $frame_manager:method_post
<BR>&nbsp;&nbsp;&nbsp;-&gt; $frame_manager:make_frameset
<BR>The :make_frameset verb builds the HTML page including the &lt;FRAMESET&gt;
<BR>tags, defining the frames layout.  It checks the submitted form for
<BR>an entry named "client" and uses the value (a number) to determine
<BR>the object number of the $jclient_handler to use.  It also identifies
<BR>an "interaction_frame_height" that is the percentage of the browser
<BR>window taken up by the interaction frame, and any @weboption settings
<BR>to be initialized after the user connects.

<P>&nbsp;&nbsp;&nbsp;The :make_frameset verb then calls the
<BR>&lt;jclient_handler&gt;:preload_page to retrieve the URL for the HTML doc
<BR>displayed in the web frame until the telnet client connects and sends
<BR>its first "display url" command.    The :preload_page verb checks the
<BR>&lt;jclient_handler&gt;.default_preload_page property.  If it's a STR then
<BR>it is assumed to be a URL for the preload page, else if it is a LIST
<BR>it is assumed to be the text of

<P>&nbsp;&nbsp;The :make_frameset verb specifies a URL for the interaction frame
<BR>that includes the form data as a "method GET"-encoded form (appended
<BR>to the URL after a "?").  This URL will cause the browser to retrieve
<BR>a web page generated by $frame_manager:get_jclient_html the HTML page
<BR>itself, in a separate transaction initiated automatically by the web
<BR>browser when it seeks to fill the frames..
<BR>&nbsp;&nbsp;The :get_jclient_html verb calls &lt;jclient_handler&gt;:make_applet_html
<BR>to retrieve the HTML text to be loaded into the "interaction frame"
<BR>that contains the Java Telnet applet itself.  This text typically
<BR>contains the &lt;APPLET&gt; section that loads the applet.  The
<BR>:make_applet_html verb extracts various applet settings from the
<BR>submitted form, which are specific to the applet it handles. If the
<BR>applet is capable of issuing a command upon connection tot he MOO,
<BR>the :make_applet_html verb can use the user_name and password fields
<BR>to  issue a "preapproved &lt;username&gt; &lt;password&gt;" line that will
<BR>automatically connect to the correct user.  The password is a
<BR>temporary password valid for only a few minutes after its generation,
<BR>and issued specifically to allow the applet to automatically connect
<BR>without giving away the user's true connect password.

<P>&nbsp;&nbsp;To summarize, the presence of field named "integrated_web_system"
<BR>in the submitted Gateway form leads to a &lt;FRAMESET&gt; page being
<BR>issued.  The web frame contents are determined by
<BR>&lt;jclient_handler&gt;:preload_page and the interaction frame's contents
<BR>are determined by &lt;jclient_handler&gt;make_applet_html.  Once the telnet
<BR>applet connects, it is expected to issue an MCP "display-url"
<BR>directive that replaces the top frame's contents with a view of the
<BR>room the newly connected character is in.

<H2><A NAME="mail-format">mail-format</A></H2>

Mail Transmission Format
<BR>------------------------
<BR>There is a standard message format used for transmitting messages.  This is the format that $mail_editor:make_message produces, and that :receive_message verbs on characters and $mail_recipients expect to see.  The (currently experimental) @refile and @copym commands also use this format to transfer messages.

<P>This *transmission* format is distinct from the *storage* format, though, for convenience this same format is often used as well for storing messages in users' collections and ordinary $mail_recipient children though, in general, there is no requirement that this be the case.

<P>A transmitted message is a list in the following form

<P>&nbsp;&nbsp;&nbsp;date (number),
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the time() value at the time the message was sent.
<BR>&nbsp;&nbsp;&nbsp;from (string),
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the sending object (address list form)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if this is not a character, an additional header will indicate the 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current ownership of the object.
<BR>&nbsp;&nbsp;&nbsp;to  (string),
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recipients (address list form) which can either be characters 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or $mail_recipient descendents.
<BR>&nbsp;&nbsp;&nbsp;subject (string),
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subject of the message, or " " if there is no subject,
<BR>&nbsp;&nbsp;@additional optional headers (list of strings),
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;each header has the form "&lt;header-name&gt;: text" where &lt;header-name&gt;: 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is padded out to a width of 10 columns for the convenience of 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:display_message.  Currently "Reply-to: &lt;address list&gt;" is the only 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;additional header in use,
<BR>&nbsp;&nbsp;&nbsp;"",
<BR>&nbsp;&nbsp;@body of message (list of strings)

<P>Note that the from, to and subject lines do *not* include a header name like "From:", "To:", or "Subject:".  The @'s indicate that the lists in question get spliced in (as usual), thus the entire message is a list whose first element is a number and the rest are strings.

<P>The address lists that appear in the from and to lines is a string in the form a sequence of object ids, each enclosed in parentheses and preceded by optional text, e.g.,

<P>&nbsp;&nbsp;"*Core-DB-Issues (#8175), Rog (#4292), and Haakon (#2)"

<P>The text is intended to give the current name of each object for the benefit of human readers, but is actually ignored by all header parsing routines.  The convention is that the text is either a character name or a * followed by a mailing list name.

<H2><A NAME="mail-receiving">mail-receiving</A></H2>

Receiving Mail
<BR>--------------
<BR>By definition a recipient "receives" a mail message when its :receive_message verb is called with that message as an argument.

<P>:new_message_num()
<BR>=&gt; number that will be assigned to the next incoming message.
<BR>By default this returns the maximum of the message numbers appearing in 
<BR>messages or .messages_going, incremented by 1.  If the recipient is a character
<BR>then the value returned will be 1 higher if it conflicts with the person's
<BR>current message number for him/herself.

<P>:receive_message(msg,sender)
<BR>By default this first calls this:new_message_num to obtain a message number to assign to the incoming message and then appends {num,msg} to this.messages.  
<BR>`sender', the original sender, is supplied in case one wants different 
<BR>action depending on who is sending the message (e.g., mail-gagging).
<BR>The return value should be an error or string if :receive_message is considered to have failed in some way.  Otherwise, a number should be returned - this number is given to any :notify_mail routines that are called and is expected to either be 0 or the number assigned to the incoming message.

<P>Note that :receive_message can do arbitrary things, including resending the same message to a new destination.  Hacking :receive_message to resend messages is different from using .mail_forward in the following respects
<BR>&nbsp;&nbsp;(1) the resent message is considered to be a distinct message having this 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object as its "author" - i.e., the From: line will necessarily be 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;different.
<BR>&nbsp;&nbsp;(2) since this "forwarding" is invisible to the mailsystem, 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;there is no protection against loops and multiple copies.


<H2><A NAME="mail-resolve">mail-resolve</A></H2>

Resolving Mail Forwarding &amp; Notification
<BR>----------------------------------------
<BR>For each recipient of a given mail message, the following two verbs are called to determine where the message should actually go and who should be notified about it:

<P>:mail_forward([from])
<BR>&nbsp;&nbsp;&nbsp;&nbsp;should return either
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;. a list of objects (either characters or $mail_recipients)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to which mail for this recipient will be redirected.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;. a string error message to be printed to the person sending the message.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If this recipient is one of the original destinations (i.e., not the
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result of a previous forwarding), no mail is actually sent.

<P>&nbsp;&nbsp;&nbsp;&nbsp;If :mail_forward returns a nonempty list, the recipient itself will *not*
<BR>&nbsp;&nbsp;&nbsp;&nbsp;actually receive the mail message unless it is included in the list.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;#-1 is allowed to be on the list; it is ignored but does make the list 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;nonempty.  Thus, having :mail_forward() return {#-1} is the canonical way
<BR>&nbsp;&nbsp;&nbsp;&nbsp;to have arriving mail disappear without being kept or forwarded.

<P>:mail_notify([from]) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;should return a list of objects that are to be told about any mail sent 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;to this recipient (whether or not the recipient actually receives it).
<BR>&nbsp;&nbsp;&nbsp;&nbsp;Said objects must have a :notify_mail verb, but other from that, there 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;is no restriction on what these can be.

<P>&nbsp;&nbsp;&nbsp;&nbsp;object:notify_mail is called with the arguments 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;(sender,recipients,msgnumbers) where 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recipients  == list of recipients including object in .mail_notify
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msgsnumbers == corresponding list of :receive_message return values
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(or 0 if :receive_message is not actually called, which
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;will be the case if the recipient forwards without keeping)

<P>When called as part of a mail send, the `from' argument is the immediate predecessor on the forwarding chain.  The default versions of these verbs return the values of .mail_forward and .mail_notify respectively (pronoun_subbing if the value is a string), unless this is a moderated mailing list and `from' is an unapproved sender (see `help MR-access') in which case the following verbs are called instead:

<P>:moderator_forward(from) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;what :mail_forward should return for mail coming from unapproved senders
<BR>&nbsp;&nbsp;&nbsp;&nbsp;This returns .moderator_forward (pronoun_subbed if a string) by default.

<P>:moderator_notify(from)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;what :mail_notify should return for mail coming from unapproved senders
<BR>&nbsp;&nbsp;&nbsp;&nbsp;This returns .moderator_notify (pronoun_subbed if a string) by default.

<P>Since the :mail_forward verbs only see the previous sender in the forwarding chain, if, e.g, B is moderated but A can send to B (i.e., B:mail_forward(A) returns an actual list), then any mail sent to A goes to B even if the original sender isn't normally allowed to send to B directly.

<P>These verbs should all allow `from' to be omitted in which case they should return as if `from' were a generic approved sender (e.g., wizard).

<P>It should rarely be necessary to actually modify any of :*_forward/*_notify verbs, since one has a fair amount of control over their behavior via the following properties

<P>&nbsp;&nbsp;.mail_forward
<BR>&nbsp;&nbsp;.mail_notify
<BR>&nbsp;&nbsp;.moderated          (see `help MR-access')
<BR>&nbsp;&nbsp;.moderator_forward
<BR>&nbsp;&nbsp;.moderator_notify

<H2><A NAME="mail-sending">mail-sending</A></H2>

Sending Mail
<BR>------------
<BR>$mail_agent:send_message(from,recipients,headers,body)
<BR>&nbsp;&nbsp;from:        sender of the message 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(this must be you or something you own; otherwise =&gt; E_PERM)
<BR>&nbsp;&nbsp;recipients:  object or list of objects (must all be characters or 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mail_recipient descendants)
<BR>&nbsp;&nbsp;headers:     either a string (contents of the Subject: line) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or a list {subject,replytos} replytos is a list 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of objects designated to receive replies.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Use {"",replytos} to have a Reply-to: without a Subject:

<P>This is the canonical way to send a mail message from a program.
<BR>This calls $mail_agent:make_message to format the arguments into an actual message (see `help mail-format') and then $mail_agent:raw_send to do the actual sending which goes as follows:

<P>&nbsp;&nbsp;(1) Call :mail_forward on all recipients add any new recipients thus obtained to final recipient list, keep calling mail:forward on the new recipients until we obtain no additional recipients.  If one of the initial recipients is invalid, is not a user character or $mail_recipient, or has its mail_forward return a string error, then we print the error message and abort at this point with no mail being sent.  If one of the later recipients bombs similarly, error messages are printed, but in this case mail still goes out to the other recipients.

<P>&nbsp;&nbsp;(2) Call :mail_notify on all recipients encountered in stage (1) to get a list of objects to notify.

<P>&nbsp;&nbsp;(3) All final recipients receive the message (see `help receive-mail')
<BR>&nbsp;&nbsp;(4) All notifications are delivered (using :notify_mail())

<P>We return {0, @failed_recipients} if we bombed out at step 1.
<BR>Otherwise return {1, @actual_rcpts} indicating what mail was sent.

<H2><A NAME="mail-system">mail-system</A></H2>

Mail System
<BR>-----------
<BR>The following topics describe the guts of the LambdaCore mail system

<P><A HREF="core_help.html#mail-sending">mail-sending</A>     -- how to send mail from a program; what happens.
<BR><A HREF="user_help.html#mail-forwarding">mail-forwarding</A>  -- how to do mail forwarding/notification (the simple version)
<BR><A HREF="core_help.html#mail-resolve">mail-resolve</A>  -- how mail forwarding/notification works, in gory detail
<BR><A HREF="core_help.html#mail-receiving">mail-receiving</A>   -- what :receive_message should do
<BR><A HREF="core_help.html#mail-format">mail-format</A>      -- format of transmitted messages

<P><A HREF="core_help.html#$mail_recipient">$mail_recipient</A>  -- generic non-user character mail recipient
<BR><A HREF="core_help.html#$mail_agent">$mail_agent</A>      -- mail utility object
<BR><A HREF="user_help.html#$disk_mail_agent">$disk_mail_agent</A> -- a $mail_agent for FUP-based external mail

<H2><A NAME="maintenance">maintenance</A></H2>

&nbsp;&nbsp;There are several wizardly tasks that should be performed periodically to insure the MOO continues working efficiently.

<P>DAILY

<P>@forked
<BR>&nbsp;&nbsp;Check the @forked list and become familiar with what tasks are
<BR>usually there.  Sometimes tasks will hang in endless loops and the
<BR>@forked list is the only place they will appear.  The task's code can
<BR>be checked, and the programmer can be contacted to insure tasks that
<BR>don't get cleared are supposed to be continuously running.  Use the
<BR>@tasks command if the @forked list is long.
<BR>@memory
<BR>&nbsp;&nbsp;Check @memory and note if the RAM or disk usage has changed
<BR>dramatically from previous values.  RAM usage may not be enabled on
<BR>your server, but disk DB size should be. Large increases in size
<BR>usually indicates that either someone has created a huge object, or
<BR>that there is a running task storing some huge value.
<BR>@big-objects
<BR>&nbsp;&nbsp;Use @big-objects to see what the largest objects in the DB are.  If
<BR>you do not have byte-based quota, users may occasionally create
<BR>(accidentally or on purpose) a large object that you may wish to have
<BR>them recycle.
<BR>Checkpointing
<BR>&nbsp;&nbsp;Use `look #0' to check the system object for the time of last
<BR>backup and to verify it succeeded.  If checkpoints fail, a message is
<BR>also generally sent to *wizards.  Note the amount of time the
<BR>checkpoint took to run.  When checkpoints start taking unusually
<BR>long, it's typically curable by restarting the MOO (presumably there
<BR>is a memory leak responsible).
<BR>&nbsp;&nbsp;Use `@trend-db' to note the size on disk of recent checkpoint
<BR>files.  Rapid size increases (more than 5%) are an indication that
<BR>either someone has created something that uses a lot of data (in
<BR>which case it may show with `@big-objects' on the next daily
<BR>measurement) or there is a memory leak.  If nothing shows with
<BR>`@big-objects' look again at the @forked list for new tasks.  You may
<BR>need to check the code for any new ones to see if they are building
<BR>some variable, usually a LIST, that is growing out of control.  If
<BR>none of these are the case, you may want to restart the MOO since
<BR>this typically cures server-based memory leaks.

<P>WEEKLY

<P>Database Backups
<BR>&nbsp;&nbsp;Once a week, at least, someone should check the MOO's backups on
<BR>the server, to see if they are getting archived properly.

<P>MONTHLY

<P>Once every month or two, the MOO server should generally be shut down
<BR>and restarted, to clear out memory leaks.  You should find that the
<BR>in-memory size of the MOO and the checkpoint time decrease (sometimes
<BR>up to 15%) after such a restart.  If the the restart results in an
<BR>in-memory size decrease of more than 20%, there is probably a serious
<BR>memory leak and you may want to consult with people experienced in
<BR>MOO server internals.

<P>QUARTERLY

<P>Checking the Character Registry Database
<BR>&nbsp;&nbsp;It's usually worthwhile to update the Character Registry Database
<BR>quarterly or so, and clear out names and addresses for recycled
<BR>characters.  This is faster than the yearly @reload activity. Use
<BR>`@verify $player-db' to check the Character Registry Database for
<BR>recycled characters.
<BR>Verify Rooms without Domains
<BR>&nbsp;&nbsp;If the MOO is using the domain system (see "help domain-system"),
<BR>has a $domain.domainless set, and uses "out" aliased exits to assign
<BR>domains, you should verify the domainless rooms periodically and
<BR>assign them to domains as appropriate.  Determine the object number
<BR>for the "Domainless Rooms Domain" (@d $domain.domainless), and then
<BR>use "@verify &lt;domain&gt;" to have each room automaticaly evaluated.

<P>YEARLY

<P>Mail Folder Archiving
<BR>&nbsp;&nbsp;When the mail folders get extremely large, they are very time
<BR>consuming to search.  An effective method for keeping popular mail
<BR>folders small is to annually rename them with "-archive#" at the end,
<BR>and start a new mail folder with the original name.  If you do this
<BR>for one of the mail folders that new users are automatically
<BR>subscribed to, you will want to update the $local.autosubscribe_lists
<BR>list.
<BR>Reloading the Character, Site, and Registration Databases
<BR>&nbsp;&nbsp;The databases that store all character names ($player_db), places
<BR>they've connected from ($site_db), and all registered email addresses
<BR>($registration_db) continue to grow unless they are reloaded
<BR>periodically.  Reloading them generally needs to be done every one or
<BR>two years.  Since they serve an important security function, keeping
<BR>records of recent changes to critical data, they probably shouldn't
<BR>be cleared more often than annually.  Use the "@reload" command on
<BR>each to reload each database (e.g. @reload $player_db).
<BR>&nbsp;&nbsp;You should reload these databases when few or no people are
<BR>connected.  Various functions, including new character creation and
<BR>connecting to characters, may be disrupted while they are reloading.
<BR>&nbsp;&nbsp;Note that if you start running out of ticks when new characters are
<BR>created, it might be that one of these databases has grown too large
<BR>and needs to be reloaded.
<BR>Flushing the Editors
<BR>&nbsp;&nbsp;Use "@peepeditor in &lt;editor&gt;" to check each of the $note_editor,
<BR>$mail_editor, $list_editor, $html_editor, and $verb_editor for
<BR>sessions that are invalid (the session belongs to a non-$player
<BR>object) or ancient (sessions older than 6-12 months, depending on
<BR>your policy).  Use "@flush &lt;editor&gt; for &lt;object&gt;" to delete a stored
<BR>editing session that are invalid or ancient.

<P>ON STARTUP
<BR>&nbsp;&nbsp;The following tasks should initiate automatically upon startup,
<BR>and appear in the @forked list:

<P>$byte_quota_utils:measurement_task
<BR>&nbsp;&nbsp;Performs periodic measurement of objects' size, adjusting people's
<BR>&nbsp;&nbsp;`size_quota' to reflect the update.  Use `start $byte_quota_utils'
<BR>&nbsp;&nbsp;if this task dies.

<P>$wiz_utils:idle_check
<BR>&nbsp;&nbsp;This checks if people are idle longer than the specified limits,
<BR>gives them a warning, and then disconnects them.  If the task doesn't
<BR>initiate properly, you can use `@start-idlechecking on $local' to
<BR>start it.

<P>$player_start:keep_clean
<BR>&nbsp;&nbsp;This verb keeps the player start room clean of all but connected
<BR>players and resident objects.

<P>$net_ncp:netwho_poll
<BR>$eDUnet:network_pollmaster
<BR>&nbsp;&nbsp;These may be active if your MOO is part of an EduNet system.

<P>$lag_meter:lag_cycle
<BR>&nbsp;&nbsp;This is the $lag_meter task that measures how long after being
<BR>scheduled forked or suspended tasks are actually being run.  When lag
<BR>iz zero, they run at exactly the scheduled time.  If the lag_cycle
<BR>task has died or not started, you can use `@startup $lag_meter' to
<BR>initiate lag measurement.

<H2><A NAME="MR-access">MR-access</A></H2>

Controlling Access to Mail Recipients
<BR>-------------------------------------
<BR>:is_writable_by(one) - one may alter/add/remove saved messages
<BR>:is_readable_by(one) - one may read messages.
<BR>:is_usable_by(one)   - one may send to this list

<P>By default, these verbs refer to the following properties:

<P>writers    - list of people other from the owner who can do anything
<BR>readers    - if == 1, indicates a public mailing list.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list of additional readers (by default anyone who receives mail 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sent to the list can read the saved messages).
<BR>moderated  - if false, indicates a normal mail recipient everyone can send to.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherwise this should be a list of approved senders (or
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 if noone but the owner and wizards can send).
<BR>restricted - list of people who specifically may not send to the list

<P>Terminology:
<BR>&nbsp;&nbsp;A mailing list is "public" if everyone can read it.
<BR>&nbsp;&nbsp;A mailing list is "moderated" if not everyone can send to it.

<P>Note that while being able to write to a recipient implies being able to read from it or send to it, neither of read-ability or send-ability implies the other.

<P>It is highly recommended that if you are creating custom mail recipients with variable reader/sender lists, i.e., you find you need to write your own :is_readable/usable/writabe_by verbs, you are best off if such verbs are of the form

<P>&nbsp;&nbsp;return pass(@args) || &lt;&lt; your_test(args[1]) &gt;&gt;

<P>and have .writers == .readers == {} and .moderated == 1.  This will ensure
<BR>&nbsp;(1) wizards having write access
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- necessary in order for :receive_message to work
<BR>&nbsp;(2) writers being able to read and send (the converse being a ludicrous 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;situation), 
<BR>&nbsp;(3) persons on the mail_forward list of someone with reader access will also
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;have read access (convenient).

<P>The $mail_recipient was extended to allow Manager class access,
<BR>though the .manager_readers, .manager_writers, .manager_unsealed_for,
<BR>and .manager_moderators properties.  These are LISTs with each
<BR>element a STR naming a property on $manager that indicates a
<BR>managerial area of responsibility.  Any $manager in a listed area of
<BR>responsibility has access corresponding to the readers, writers, or
<BR>moderators abilities.  The .unsealed_for indicates those managers can
<BR>read sealed msgs.

<H2><A NAME="MR-naming">MR-naming</A></H2>

One may always refer to a list by its object number.  In order to refer to it by name, it must be contained in $mail_agent, which holds all mailing lists, i.e., those that you want others to be able to refer to by name.

<P>The .aliases field holds the names by which one may refer to the list, but only those names not containing spaces actually count for anything.  As with certain other types of objects (e.g., character objects), set_aliases() needs to be called in order to change the .aliases field.

<P>$mail_agent:match(name) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;is the canonical way to obtain the objectid of a mailing list 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;given the name ("*" is assumed; an initial "*" will be dropped).

<P>$mail_agent:match_recipient(name) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;is the canonical way to obtain the object id of a list or person
<BR>&nbsp;&nbsp;&nbsp;&nbsp;matching the given name.  An initial "*" indicates that this is 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;supposed to be a list.

<P>$mail_agent:match_failed(objid,name) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;is the mail_recipient counterpart to $command_utils:object_match_failed

<H2><A NAME="MR-reading">MR-reading</A></H2>

Read verbs
<BR>----------
<BR>The following verbs may be used to extract headers/messages from readable mail recipients/characters;

<P>:display_seq_headers (message sequence, current message number, last_read_date)
<BR>&nbsp;&nbsp;Does a @mail listing of the given message sequence.  If current message
<BR>&nbsp;&nbsp;number is given and the sequence includes it, we mark it with a `&gt;'.
<BR>&nbsp;&nbsp;Likewise if the sequence includes any new messages (i.e., dated after 
<BR>&nbsp;&nbsp;last_read_date), these are also indicated as such.

<P>display_seq_full (message sequence, preamble)
<BR>&nbsp;&nbsp;Does a @read listing of the given message sequence.  Each message is preceded
<BR>&nbsp;&nbsp;by preamble.
<BR>&nbsp;&nbsp;=&gt; {new current message number, new last_read_date}

<P>:messages_in_seq (index)
<BR>&nbsp;&nbsp;=&gt; {n, msg}
<BR>:messages_in_seq (message sequence)
<BR>&nbsp;&nbsp;=&gt; {{n_1,msg_1},{n_2,msg_2},...}
<BR>&nbsp;&nbsp;where the n_i are message numbers and the msg_i are messages in transmission
<BR>&nbsp;&nbsp;format (see `help mail-format')

<P>:list_rmm ()
<BR>&nbsp;&nbsp;Does an `@unrmm list' listing of messages in .messages_going

<H2><A NAME="MR-searching">MR-searching</A></H2>

Search verbs
<BR>------------
<BR>The following verbs can be used on a readable mail-recipient/character to search for messages with fields matching a given pattern.

<P>from_msg_seq (objectid or list [,mask])
<BR>&nbsp;&nbsp;=&gt; message sequence: messages from (one of) the given objectid(s)

<P>%from_msg_seq (string or list [,mask])
<BR>&nbsp;&nbsp;=&gt; message sequence: messages with (one of) the given string(s)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in the From: line

<P>to_msg_seq (objectid or list [,mask])
<BR>&nbsp;&nbsp;=&gt; message sequence: messages to (one of) the given objectid(s)

<P>%to_msg_seq (string or list [,mask])
<BR>&nbsp;&nbsp;=&gt; message sequence: messages with (one of) the given string(s)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in the To: line

<P>subject_msg_seq (string [,mask])
<BR>&nbsp;&nbsp;=&gt; message sequence: messages with given string occurring in Subject:

<P>body_msg_seq (string [,mask])
<BR>&nbsp;&nbsp;=&gt; message sequence: messages with given string occurring in body of message

<P>In all cases `mask' is a message sequence which one may supply to limit the range of the search.  One way of looking at it is that the message sequence to be returned is first intersected with mask.

<H2><A NAME="MR-sequences">MR-sequences</A></H2>

Message Sequences
<BR>-----------------
<BR>A "message sequence" is a handle by which one may refer to a particular subset of a mail recipient's (character or $mail_recipient-descendant) saved messages.  Routines like rcpt:display_seq_headers or rcpt:display_seq_full need to be supplied with message-sequence arguments to deterimine which headers or full-messages to display.

<P>Message sequences can in turn be obtained from routines like rcpt:parse_message_seq, which takes a command-line description of a message sequence on that particular recipient and returns the corresponding message sequence handle.

<P>The actual form of a message sequence (though you shouldn't actually need to make use of this) is that of a set of integers in the format used by $seq_utils (see `help $seq_utils').  It should however be noted that these integers are *not* themselves message numbers, but rather indices into the list of saved messages.  For example, if a particular recipient holds 5 messages numbered 1,3,5,7,9.  Then the message sequence handle representing messages 3,5,7 collectively, would be {2,5} which is $seq_utils-ese for the range 2..4, namely the second, third and fourth messages saved on that recipient.

<P>The following verbs are available for obtaining indices to use in message sequences

<P>&nbsp;&nbsp;:length_all_msgs()    =&gt; total number of messages, or equivalently,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; index of last message
<BR>&nbsp;&nbsp;:length_num_le(n)     =&gt; number of messages numbered &lt;= n, or equivalently,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; index of highest numbered message &lt;= n
<BR>&nbsp;&nbsp;:exists_num_eq(n)     =&gt; 0 unless there exists a message numbered n in which
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case we return the index of that message.
<BR>&nbsp;&nbsp;:length_date_le(date) =&gt; number of messages dated &lt;= date, or equivalently,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; index of most recent message dated &lt;= date

<P>&nbsp;&nbsp;:length_date_gt(date) =&gt; number of messages dated &gt; date

<P>Note that r:length_date_gt(date) == r:length_all_msgs()-r:length_date_le(date).
<BR>The only reason :length_date_gt is provided as a separate routine is in order 
<BR>to do quick checks for the existence of new mail (as @rn needs to do).

<H2><A NAME="MR-setup">MR-setup</A></H2>

<P>See: <A HREF="builder_help.html#mail-recipients">mail-recipients</A> in Builder Help

<H2><A NAME="MR-subscribing">MR-subscribing</A></H2>

Subscribing to Mail Recipients
<BR>------------------------------
<BR>There are two notions of being "subscribed" to a mailing list/recipient.

<P>(1) Hard subscribed == being on the recipient's .mail_forward list so that mail sent to this list is forwarded to one's own .messages as well (see `help mail-forwarding').

<P>(2) Soft subscribed == keeping track of a current message for this recipient and (optionally) being on the recipient's .mail_notify list.


<P>Each character has a .current_message property that contains, for each recipient the person cares to keep track of, a current message number and a last read date.

<P>player:current_message(rcpt)                 (somewhat obsolete)
<BR>&nbsp;=&gt; person's current message number for rcpt 

<P>player:get_current_message(rcpt) 
<BR>&nbsp;=&gt; person's {current message number for rcpt, last-read-date for rcpt}

<P>player:make_current_message(rcpt)
<BR>&nbsp;=&gt; adds a current_message entry for rcpt  (NOOP if rcpt == player)

<P>player:set_current_message(rcpt,n|E_NONE,[,date])
<BR>&nbsp;=&gt; sets person's current message number for rcpt to n iff n!=E_NONE
<BR>&nbsp;&nbsp;&nbsp;&nbsp;updates the last-read-date for rcpt to date iff date &gt; last-read-date

<P>player:kill_current_message(rcpt)
<BR>&nbsp;=&gt; removes current-message info for rcpt  (NOOP if rcpt == player)


<P>On $mail_recipient, .mail_forward and .mail_notify are -c so one needs to use the following verbs to actually modify them.

<P>&nbsp;&nbsp;&nbsp;&nbsp;:add_forward(@new_recipients)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;:delete_forward(@recpients)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;:add_notify(@new_notifiees)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;:delete_notify(@notifiees)

<P>A recipient's owner is, of course, allowed to make arbitrary changes to .mail_forward and .mail_notify.  However, the default versions of these verbs also allow anyone to add him/herself to a recipient's .mail_forward or .mail_notify if the recipient is readable (see `help MR-access') by him/her.

<P>Likewise anyone may use the :delete* verbs to delete him/herself from any .mail_forward/.mail_notify list, regardless of his actual access to the list.

<P>Note for wizards:
<BR>You can set the list of mail folders to which new characters are
<BR>automatically subscribed by changing the
<BR>$wiz_utils.autosubscribe_lists value (set to {} by default).

<H2><A NAME="MR-writing">MR-writing</A></H2>

Write verbs
<BR>-----------
<BR>The following verbs can be used to manipulate writable mail recipients/characters:

<P>:rm_message_seq (message sequence)
<BR>&nbsp;&nbsp;Does an @rmmail.  Messages in message sequence are removed from this 
<BR>&nbsp;&nbsp;recipient's saved .messages and written to .messages_going.

<P>:undo_rmm ()
<BR>&nbsp;&nbsp;Does an @unrmm.  Messages in .messages_going are copied back to .messages.

<P>:expunge_rmm ()
<BR>&nbsp;&nbsp;Does an @unrmm expunge.  Blows away .messages_going.

<P>:renumber ()
<BR>&nbsp;&nbsp;Does a @renumber.


<H2><A NAME="object-matching">object-matching</A></H2>

Which :match...() Verb Do I Call?
<BR>---------------------------------
<BR>There are many situations where one wishes to obtain an object from a room or a character's .contents whose name/aliases matches a particular string.  There are four main verbs available for this and it is important to understand the distinctions between them and how they are supposed to be used.

<P>(*)  LOC:match("X")
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- what you get looking for something that is inside LOC and named "X".
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By default, this looks through LOC.contents to find a unique object 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;having a name or alias that has "X" as a prefix.

<P>Essentially, you can think of :match as a contents-matching verb, though, e.g., for rooms you also get matches on exits as well.

<P>(*)  LOC:match_object("X", YOU)           [YOU defaults to `player']
<BR>(*)  YOU:my_match_object("X", LOC)        [LOC defaults to player.location]
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- what YOU get being located at LOC and looking for something named "X".
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By default these both return $string_utils:match_object("X",LOC,YOU)

<P>(*)  $string_utils:match_object("X", LOC, YOU) 
<BR>&nbsp;&nbsp;&nbsp;- what you *would* get *if* YOU were a typical user, YOU were inside LOC,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YOU were looking for something named "X", *and* LOC were a typical place.

<P>In other words, $string_utils:match_object describes the :match_object() algorithm for "typical places" and the :my_match_object for "typical user characters":

<P>&nbsp;&nbsp;&nbsp;&nbsp;(1)  check for "X" being one of "", "me", "here", "$something", or "#n"
<BR>&nbsp;&nbsp;&nbsp;&nbsp;(2)  try YOU:match("X") i.e., something in your inventory (maybe)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;(3)  try LOC:match("X") i.e., some object in the room (maybe)

<P>The distinction between these location:match_object and player:my_match_object has to do with whether the user character object or the location should determine what the matching algorithm is.  Which one you should use depends on the command that you are writing.  If you are writing a command with a virtual-reality flavor, then you should be respecting the room owner's idea of which objects you can "see" and thus the command should be calling the location's :match_object verb.  If you are writing a building/programming command where it is appropriate for the character object to determine the matching algorithm  - whether because the current location is irrelevant, not to be trusted, or both - then the character's :my_match_object verb should be called.

<P><B>Examples:</B>

<P>&nbsp;&nbsp;`look diamond in box'
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;calls box:match("diamond").  This is a match on the contents of box.

<P>&nbsp;&nbsp;`take ball', 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;calls player.location:match_object("ball")
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to determine which "ball" to take.  Note that if the room is dark, 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we might not be able to find any "ball".

<P>&nbsp;&nbsp;`@program widget:foo', 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;calls player:my_match_object("widget") to get the character's own idea
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of what "widget" should be.  Note that if I were carrying something 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;named "widget" and expecting to be programming a :foo() verb on it,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it would be potentially disastrous should the room where I am decide
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for me to be programming something else (not even necessarily 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;called "widget").

<P>Object Matching Failures
<BR>------------------------
<BR>As with other matching routines, one gets back 

<P>&nbsp;&nbsp;$failed_match in the case of no matching object
<BR>&nbsp;&nbsp;$ambiguous_match in the case of more than one matching object
<BR>&nbsp;&nbsp;$nothing in the case of a blank string argument

<P>or an object-id.  In these first 3 cases, one usually wants to translate these nonresults to the user character; this is what $command_utils:object_match_failed.  The standard idiom to mimic what the builtin parser does, say, with the direct object is

<P>&nbsp;&nbsp;dobj = foo:match_???(dobjstr);
<BR>&nbsp;&nbsp;if($command_utils:object_match_failed(dobj, dobjstr))
<BR>&nbsp;&nbsp;&nbsp;&nbsp;"...give up.  nothing to do.   error message has already printed...";
<BR>&nbsp;&nbsp;else
<BR>&nbsp;&nbsp;&nbsp;&nbsp;"...dobj is something useful.  Continue...";
<BR>&nbsp;&nbsp;&nbsp;&nbsp;...
<BR>&nbsp;&nbsp;endif

<H2><A NAME="unique-id">unique-id</A></H2>

The unique_id property uniquely identifies any object which is, or might be, part of a core MOO database.  Normally, objects are created with this property set to 0.  If the object is to be part of a core database (or a core option set - see 'help @core-options'), it is a list of at least three elements, as follows:

<P>Unique_id[1]:  A string giving a unique name for the object.  This is also refered to as the object's 'core name'.  It must be different for each object.

<P>Uniuqe_id[2]:  A string identifying whether this is part of the basic core which must be in any core database, or whether the object is part of a "core option" set, which can be optionally included or not.  If the string is the same as $core_utils.core_id, the object is part of the base core.  If it is a blank string, it is not a core object.  If it is anything else,  it is part of a core option set of that name.  (See 'help @core-options')

<P>Unique_id[3]:  The date this object was transferred from a core extraction, or 0 if it is on the source MOO.

<P>This differs from the LamdbaCore system, which uses all objects defined as a property on #0 (i.e, as $&lt;name&gt;), or their parents, as the set included on the core.  In the this system, objects which are not on #0 can be included in the core even if they are not parents of such objects, and objects on #0 need not be included.  However, in the latter case, care should be taken that references to the corresponding $&lt;name&gt;'s not be in the core objects,

<P>See @about $core_utils or @mailme $core_utils for more details.

<H2><A NAME="web-security">web-security</A></H2>

There are three alternative mechanisms for authentication that the
<BR>web system can use.  The method used depends on the setting of the
<BR>"authentication_method" property on the $http_port that is handling
<BR>the transaction  Transactions through $login are assumed to be cookie
<BR>authenticated unless $http_handler.login_is_http09 is true, in which
<BR>case they are webpass authenticated.  Note that for HTTP/0.9
<BR>transactions, only webpass authentication is available, and that
<BR>$login can't perform web-authentication.  Alternative settings are:
<BR>webpass, cookies, and web-authentication.  The "cookies" setting is
<BR>strongly recommended.  Information on web cookie authentication may
<BR>be found at "http://home.netscape.com/newsref/std/cookie_spec.html"
<BR>and on web authentication in the IETF draft for HTTTP/1.0
<BR>specification 3 (draft-ietf-http-v10-spec-03.html).

<P>1. URL-embedded "webpass" system

<P>In this system, a password is embedded into the URL for the
<BR>transaction.  A webpass of "anon" or "anonymous" always gives the
<BR>transaction the permissions of $noone.  The webpass is a temporary
<BR>value associated with the user for the duration of the session.  It
<BR>is erased from the $http_handler.webpass_handler database when the
<BR>user disconnects from their character.  Since the temporary webpass
<BR>appears within the URL, visible to whoever is looking over the user's
<BR>shoulder, it is not as secure as the web cookie system.

<P>2. web cookie system

<P>In this system, a temporary webpass is generated but appears as a web
<BR>cookie within the header lines of the transaction, and not in the
<BR>URL.  If an $http_port is set to use web cookies and the user's
<BR>browser doesn't recognize them, then the system automatically uses
<BR>URL-embeded webpasses instead.  Detection of the browser's web cookie
<BR>function is performed by sending a cookie (named "cookies_ok") with
<BR>the gateway page, and then checking for it on the subsequent
<BR>authentication form submission.  If the browser can't handle web
<BR>cookies, then the system automatically switched to URL-embedding of
<BR>the webpass.  The web cookie system is considered the most secure and
<BR>recommended for general use.
<BR>&nbsp;&nbsp;Note that users can "clear" their authentication in two ways under
<BR>the web cookie system.  One is to chose the "List of Application"
<BR>where there is a button that performs this task.  The other is to
<BR>return the the MOO's gateway page.  A "clear" cookie is always sent
<BR>to the user's browser when that page is sent by the MOO, insuring
<BR>that the user can reauthenticate without any lingering cookies to
<BR>complicate the process.

<P>3. "web authentication" system

<P>This uses the authentication method given in the HTTP/1.0
<BR>specification.  As stated there, it is not intended for highly secure
<BR>activity since the password is essentially sent in the clear, even
<BR>though it is hidden from the casual user by its incorporation into
<BR>the HTTP header lines.  In this system, the user is presented by the
<BR>browser with a request for their character's name and password.  This
<BR>information is thereafter included in every transaction to the MOO
<BR>until the browser is reinitialized, generally by quitting and
<BR>restarting.  For this reason, this "web authentication" method is not
<BR>recommended, although it is a capability of the BioGate System.

<H2><A NAME="web-system">web-system</A></H2>

<P>See: <A HREF="#biogate-system">biogate-system</A>

</BODY></HTML>
